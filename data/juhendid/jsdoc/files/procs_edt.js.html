<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>procs_edt.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.7.0&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.7.0&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/dxf.html">dxf</a></li>
            
                <li><a href="..&#x2F;classes/komponendid.html">komponendid</a></li>
            
                <li><a href="..&#x2F;classes/kontrollid.html">kontrollid</a></li>
            
                <li><a href="..&#x2F;classes/lisad.html">lisad</a></li>
            
                <li><a href="..&#x2F;classes/procs_app.html">procs_app</a></li>
            
                <li><a href="..&#x2F;classes/procs_edt.html">procs_edt</a></li>
            
                <li><a href="..&#x2F;classes/procs_TextContMenu.html">procs_TextContMenu</a></li>
            
                <li><a href="..&#x2F;classes/tools.html">tools</a></li>
            
                <li><a href="..&#x2F;classes/tools_dx.html">tools_dx</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: procs_edt.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
﻿&#x2F;**
* procs_edt.js
* 
*
* @class procs_edt
*&#x2F;

&#x2F;&#x2F;-------------------------------uuemad ------------------------------------------
&#x2F;**
* Uuem.
*
* @method getMajors
* @param {Object} editDomNode
* @param {Object} editDomNode
*&#x2F;
function getMajors(yldStruNode, editDomNode) {
    var useRequiredStr = yldStruNode.getAttribute(&quot;pr_sd:useRequired&quot;);
    if (useRequiredStr) {
        useRequiredStr = useRequiredStr.substr(1, useRequiredStr.length - 2); &#x2F;&#x2F; semikoolonid alguses ja lõpus
        var useRequired = useRequiredStr.split(&quot;;&quot;);
        for (var ix2 in useRequired) {
            var requiredAttr = yldStruNode.attributes.getNamedItem(useRequired[ix2]);
            var newAttr = editDomNode.attributes.setNamedItem(oEditDOM.importNode(requiredAttr, true));
            getReqValue(newAttr, requiredAttr);
        }
    }
    if (yldStruNode.getAttribute(&quot;pr_sd:ct&quot;) != 2) { &#x2F;&#x2F; 1, 3, &#x27;&#x27;
        getReqValue(editDomNode, yldStruNode);
    }
    var majorElements = yldStruNode.selectNodes(&quot;*[@pr_sd:major = &#x27;1&#x27;]&quot;);
    for (var ix = 0; ix &lt; majorElements.length; ix++) {
        var majorElement = majorElements[ix];
        var frDocNode = editDomNode.appendChild(oEditDOM.createNode(NODE_ELEMENT, majorElement.nodeName, DICURI));
        getMajors(majorElement, frDocNode);
    }
} &#x2F;&#x2F; getMajors


&#x2F;&#x2F;-------------------------------   edit värk ---------------------------------------
&#x2F;&#x2F;-----------------------------------------------------------------------------------
&#x2F;&#x2F;-------------------------------   vanad   -----------------------------------------
&#x2F;&#x2F;-----------------------------------------------------------------------------------
&#x2F;**
* Vana. 
*
* @method HandleEditClick
*&#x2F;
function HandleEditClick() {
    var tnode, gspq, tarr;
    var frdoc, refnode;
    var lisanimed, t2, lisanode;
    var i, chkNode, chkNodes, osel;

    var xh, oRespDom, sta, elXml, aenode

    var oSrc = window.event.srcElement;

    &#x2F;&#x2F;parandamisel vaate stiilis:
    &#x2F;&#x2F;entiteedid pannakase kaldkirjas, alakaareke mingi teise (MS Mincho) fondiga;
    &#x2F;&#x2F;hiirega saab pihta ainult &quot;I&quot; - le, &quot;B&quot; - le või &quot;FONT&quot; - ile; osa spane on em teisendustest
    if ((oSrc.tagName == &quot;FONT&quot; || oSrc.tagName == &quot;B&quot; || oSrc.tagName == &quot;I&quot;)) {
        oSrc = oSrc.parentElement;
    }

    &#x2F;&#x2F;siinne &#x27;LI&#x27; saab olla ainult toimetamisala &#x27;LI&#x27;
    &#x2F;&#x2F;xsl1 - s ei ole LI-del id-sid, SP uuel toimetamisel (17juun11) on ja vaates tehakse halliks terve vastav &#x27;LI&#x27;
    if (oSrc.tagName == &quot;SPAN&quot; || oSrc.tagName == &quot;LI&quot;) {
        oClicked = oSrc;
        if (oClicked.className == &quot;delatt&quot;) {
            var attElement = oClicked.nextSibling;
            var attId = attElement.id;
            if (attId) {
                var attXmlNode = oEditDOMRoot.selectSingleNode(attId);
                if (attXmlNode) {
                    var attrOwner = attXmlNode.selectSingleNode(&quot;..&quot;);
                    attrOwner.removeAttributeNode(attXmlNode);
                    setATTAPlokid(attrOwner);
                    vaatedRefresh(2);
                    return;
                }
            }
        }
        if (trueIfrDocClick &amp;&amp; jsTrim(oClicked.id).length &gt; 0) {
            SetIfrViewElement();
        }
        SetVars();
        if (clEditable) {
            SetEdits();
        }
    } else if (oSrc.tagName == &quot;UL&quot;) {
        &#x2F;&#x2F;SP, 17juun11

    } else if (oSrc.tagName == &quot;IMG&quot;) {
        &#x2F;&#x2F;0 - creategrupp&#x2F;addgrupp&#x2F;addlisad&#x2F;dellisad ... kinniLahti ...;
        &#x2F;&#x2F;1 - MIDA luua&#x2F;lisada (QN);
        &#x2F;&#x2F;2 - rajaID;
        tarr = oSrc.id.split(&quot;|&quot;);

        var frDocRoot, yldStruNode, lisatavad, lisatav;

        if (tarr[0] == &quot;creategrupp&quot; || tarr[0] == &quot;addgrupp&quot; || tarr[0] == &quot;addlisad&quot; || tarr[0] == &quot;dellisad&quot; || tarr[0] == &quot;delgrupp&quot; || tarr[0] == &quot;addAllLisad&quot; || tarr[0] == &quot;kinniLahti&quot;) {

            tnode = oEditDOMRoot.selectSingleNode(tarr[2])

            var tooEtte = &#x27;&#x27;, plNr, oEditObj;

            if (tarr[0] == &quot;kinniLahti&quot;) {
                &#x2F;&#x2F;SP, 24. juuni 2011;
                var edO, avatud, edOAttr;
                edO = tnode.getAttribute(DICPR + &quot;:edO&quot;);
                if ((edO == &quot;1&quot;)) {
                    avatud = &quot;0&quot;;
                } else {
                    avatud = &quot;1&quot;;
                }
                edOAttr = oEditDOM.createNode(NODE_ATTRIBUTE, DICPR + &quot;:edO&quot;, DICURI);
                edOAttr.text = avatud;
                tnode.attributes.setNamedItem(edOAttr);
                setATTAPlokid(tnode);
                vaatedRefresh(2);
            } else if (tarr[0] == &quot;creategrupp&quot;) {
                &#x2F;&#x2F;GetSchemaPosQuery: following-sibling nimed
                gspq = GetSchemaPosQuery(tnode, tarr[1]);
                if (gspq != &quot;Ei saa&quot;) {
                    if (gspq == &quot;Suvaline&quot; || gspq == &quot;&#x2F;..&quot;) {
                        refnode = null;
                    } else {
                        refnode = tnode.selectSingleNode(gspq);
                    }
                    if (yldStruDom.documentElement.getAttribute(&quot;pr_sd:ver&quot;) == &quot;2.0&quot;) {
                        frdoc = oEditDOM.createDocumentFragment();
                        frDocRoot = frdoc.appendChild(oEditDOM.createNode(NODE_ELEMENT, tarr[1], DICURI));
                        yldStruNode = yldStruDom.selectSingleNode(&quot;.&#x2F;&#x2F;&quot; + tarr[1]);
                        getMajors(yldStruNode, frDocRoot);
                        lisatav = frDocRoot;
                    }
                    else {
                        lisatav = GetAddElementFromFile(tarr[1], DICURI);
                    }
                    tnode.insertBefore(lisatav, refnode);
                    AddGruppChecks(lisatav);  &#x2F;&#x2F;@nrl, tähendusnumbrite ümberarvutused;
                    setATTAPlokid(lisatav);
                    vaatedRefresh(2);
                }
            } else if (tarr[0] == &quot;addgrupp&quot;) {
                refnode = tnode.nextSibling;
                if (yldStruDom.documentElement.getAttribute(&quot;pr_sd:ver&quot;) == &quot;2.0&quot;) {
                    frdoc = oEditDOM.createDocumentFragment();
                    frDocRoot = frdoc.appendChild(oEditDOM.createNode(NODE_ELEMENT, tnode.nodeName, DICURI));
                    yldStruNode = yldStruDom.selectSingleNode(&quot;.&#x2F;&#x2F;&quot; + tnode.nodeName);
                    getMajors(yldStruNode, frDocRoot);
                    lisatav = frDocRoot;
                }
                else {
                    lisatav = GetAddElementFromFile(tnode.nodeName, DICURI);
                }
                tnode.parentNode.insertBefore(lisatav, refnode);
                AddGruppChecks(lisatav);  &#x2F;&#x2F;@nrl, tähendusnumbrite ümberarvutused;
                tooEtte = tarr[2];
                tooEtte = tooEtte.sub(0, tooEtte.length - 1);  &#x2F;&#x2F;lõpu ] maha;
                plNr = tooEtte.substr(tooEtte.lastIndexOf(&quot;[&quot;) + 1);
                tooEtte = tooEtte.substr(0, tooEtte.lastIndexOf(&quot;[&quot;)) + &quot;[&quot; + parseInt(plNr + 1) + &quot;]&quot;;
                setATTAPlokid(lisatav);
                vaatedRefresh(2);
            } else if (tarr[0] == &quot;addlisad&quot;) {
                lisanimed = &quot;;&quot;;
                chkNodes = tnode.selectNodes(&quot;*&quot;);
                for (i = 0; i &lt; chkNodes.length; i++) {
                    chkNode = chkNodes[i];
                    lisanimed += chkNode.nodeName + &quot;;&quot;;
                }
                if (yldStruDom.documentElement.getAttribute(&quot;pr_sd:ver&quot;) == &quot;2.0&quot;) {
                    yldStruNode = yldStruDom.selectSingleNode(&quot;.&#x2F;&#x2F;&quot; + tnode.nodeName);
                    &#x2F;&#x2F; [not(@pr_sd:ct = &#x27;2&#x27;)]
                    lisatavad = yldStruNode.selectNodes(&quot;*&quot;);
                    for (i = 0; i &lt; lisatavad.length; i++) {
                        lisatav = lisatavad[i];
                        if (lisanimed.indexOf(&#x27;;&#x27; + lisatav.nodeName + &#x27;;&#x27;) &lt; 0) {
                            gspq = GetSchemaPosQuery(tnode, lisatav.nodeName);
                            if (gspq != &quot;Ei saa&quot;) {
                                if (gspq == &quot;Suvaline&quot; || gspq == &quot;&#x2F;..&quot;) {
                                    refnode = null;
                                } else {
                                    refnode = tnode.selectSingleNode(gspq);
                                }
                                aenode = oEditDOM.createNode(NODE_ELEMENT, lisatav.nodeName, DICURI);
                                getMajors(lisatav, aenode);
                                lisanode = tnode.insertBefore(aenode, refnode);
                            }
                        }
                    }
                }
                else {
                    frdoc = IDD(&quot;file&quot;, &quot;xml&#x2F;&quot; + dic_desc + &quot;&#x2F;al_&quot; + unName(tnode.nodeName) + &quot;.xml&quot;, false, false, null);
                    if (frdoc.parseError.errorCode == 0) {
                        lisatavad = frdoc.documentElement.text.split(&#x27;|&#x27;);
                        for (i = 0; i &lt; lisatavad.length; i++) {
                            if (lisanimed.indexOf(&#x27;;&#x27; + lisatavad[i] + &#x27;;&#x27;) &lt; 0) {
                                gspq = GetSchemaPosQuery(tnode, lisatavad[i]);
                                if (gspq != &quot;Ei saa&quot;) {
                                    if (gspq == &quot;Suvaline&quot; || gspq == &quot;&#x2F;..&quot;) {
                                        refnode = null;
                                    } else {
                                        refnode = tnode.selectSingleNode(gspq);
                                    }
                                    aenode = oEditDOM.createNode(NODE_ELEMENT, lisatavad[i], DICURI);
                                    AddEmptyTexts(aenode);
                                    lisanode = tnode.insertBefore(aenode, refnode);
                                }
                            }
                        }
                    } else {
                        alert(frdoc.parseError.reason);
                        return;
                    }
                }
                setATTAPlokid(tnode);
                vaatedRefresh(2);
            } else if (tarr[0] == &quot;addAllLisad&quot;) { &#x2F;&#x2F; ainult sp_ ?
                lisanimed = &quot;;&quot;;
                chkNodes = tnode.selectNodes(&quot;*&quot;);
                for (i = 0; i &lt; chkNodes.length; i++) {
                    chkNode = chkNodes[i];
                    lisanimed = lisanimed + chkNode.nodeName + &quot;;&quot;;
                }
                &#x2F;&#x2F;15. juuli 2011;
                &#x2F;&#x2F;aeglase internetiühenduse okkaline tee...;
                &#x2F;&#x2F; Kõu ühendus:;
                &#x2F;&#x2F; Läbiviimise aeg: 15.07.2011 00:27:45;
                &#x2F;&#x2F; Kliendi IP-aadress: 77.233.84.152;
                &#x2F;&#x2F; Kliendi AS-number (päringu tekitajat ja teenusepakkujat identifitseeriv info): IP-aadress ei kuulu ühegi autonoomse süsteemi (AS) alla;
                &#x2F;&#x2F; Testi tüüp: Java;
                &#x2F;&#x2F; Üleslaadimise kiirus: 121.21 kbit&#x2F;sek;
                &#x2F;&#x2F; Allalaadimise kiirus: 807.99 kbit&#x2F;sek;
                var aalNode, aalAlamNode;
                aalNode = yldStruDom.documentElement.selectSingleNode(&quot;.&#x2F;&#x2F;&quot; + tnode.nodeName);
                var aalAlamNoded = aalNode.selectNodes(&quot;*&quot;);
                for (i = 0; i &lt; aalAlamNoded.length; i++) {
                    aalAlamNode = aalAlamNoded[i];
                    if ((lisanimed.indexOf(&quot;;&quot; + aalAlamNode.nodeName + &quot;;&quot;) &lt; 0)) {
                        aenode = GetAddElementFromFile(aalAlamNode.nodeName, DICURI);
                        gspq = GetSchemaPosQuery(tnode, aenode.nodeName);
                        if (!(gspq == &quot;Ei saa&quot;)) {
                            if ((gspq == &quot;Suvaline&quot;)) {
                                refnode = null;
                            } else {
                                refnode = tnode.selectSingleNode(gspq);
                            }
                            lisanode = tnode.insertBefore(aenode, refnode);
                        }
                    }
                }
                setATTAPlokid(tnode);
                vaatedRefresh(2);
            } else if (tarr[0] == &quot;dellisad&quot;) {
                osel = tnode.selectNodes(&quot;*[normalize-space(.) = &#x27;&#x27;]&quot;);
                osel.removeAll();
                setATTAPlokid(tnode);
                vaatedRefresh(2);
            } else if (tarr[0] == &quot;delgrupp&quot;) {
                tnode.parentNode.removeChild(tnode);
                setATTAPlokid(tnode);
                vaatedRefresh(2);
            }

            &#x2F;&#x2F;        if((Len(tooEtte) &gt; 0)){
            &#x2F;&#x2F;  oEditObj = oEditAll(tooEtte)
            &#x2F;&#x2F;   if(! (oEditObj == null)){
            &#x2F;&#x2F;    oEditObj.scrollIntoView()
            &#x2F;&#x2F;            }
            &#x2F;&#x2F;        }
        } else if (tarr[0] == &quot;addAttr&quot;) {

            tnode = oEditDOMRoot.selectSingleNode(tarr[2])

            var newAttr, newId, newLang, newElem;

            if (yldStruDom.documentElement.getAttribute(&quot;pr_sd:ver&quot;) == &quot;2.0&quot;) {
                yldStruNode = yldStruDom.selectSingleNode(&quot;.&#x2F;&#x2F;&quot; + tnode.nodeName);
                var lisatavAttr = yldStruNode.attributes.getNamedItem(tarr[1]);
                newAttr = tnode.attributes.setNamedItem(oEditDOM.importNode(lisatavAttr, true));
            }
            else {
                newAttr = tnode.attributes.setNamedItem(oEditDOM.createNode(NODE_ATTRIBUTE, tarr[1], DICURI));
            }

            setATTAPlokid(tnode);

            selectedNode = newAttr;
            fatherNode = selectedNode.selectSingleNode(&quot;..&quot;); &#x2F;&#x2F;&#x27;atribuudil ei ole parentNode-t;
            snDecl = oXmlSc.getDeclaration(selectedNode);

            if (newAttr.value == &#x27;&#x27;) {
                if (snDecl.type.enumeration.length == 1) {
                    newAttr.value = snDecl.type.enumeration[0];
                }
            }

            newId = tarr[2] + &quot;&#x2F;@&quot; + tarr[1];

            vaatedRefresh(2);

            newElem = oEditAll(newId);
            newElem.focus();
            newElem.click();

            &#x2F;&#x2F;newId = tarr[2] + &quot;&#x2F;@&quot; + tarr[1];
            &#x2F;&#x2F;newLang = tnode.transformNode(strLangXsl);
            &#x2F;&#x2F;oSrc.outerHTML = &quot;&lt;span id=&#x27;&quot; + newId + &quot;&#x27; class=&#x27;at at_&quot; + unName(tarr[1]) + &quot; edit&#x27; style=&#x27;width:16px;background-color:white;border:black 1px solid;font-family:\&quot;Times New Roman\&quot;;&#x27; lang=&#x27;&quot; + newLang + &quot;&#x27;&gt;&lt;&#x2F;span&gt;&quot;;
            &#x2F;&#x2F;oEditAll(&quot;ifrdiv&quot;).setAttribute(&quot;xmlChanged&quot;, 1);
            &#x2F;&#x2F;newElem = document.all(newId);
            &#x2F;&#x2F;newElem.focus();
            &#x2F;&#x2F;newElem.click();

        } else if ((tarr[0] == &quot;sndListen&quot;)) {
            var nX, nY;
            nX = event.clientX;
            nY = event.clientY - (div_ArtJWPlayerImage.style.pixelWidth &#x2F; 2); &#x2F;&#x2F; ico on ruudukujuline, height asemel width
            div_ArtJWPlayerImage.style.pixelLeft = nX;
            div_ArtJWPlayerImage.style.pixelTop = nY;
            tnode = oEditDOMRoot.selectSingleNode(tarr[2]);
            var flvFile = &quot;__sr&#x2F;&quot; + dic_desc + &quot;&#x2F;__heli&#x2F;&quot; + tnode.text;
            var opts = {
                autostart: true,
                flashplayer: &quot;html&#x2F;jwplayer&#x2F;player.swf&quot;,
                file: flvFile,
                controlbar: &quot;none&quot;,
                icons: false,
                wmode: &quot;transparent&quot;,
                width: 0,
                height: 0,
                events: { onError: function (event) { sndError(event); }, onPlay: function (event) { sndStarted(event); }, onComplete: function () { sndCompleted(); } }
            };
            jwplayer(&quot;div_ArtJWPlayer&quot;).setup(opts);
        }
    } else if ((oSrc.tagName == &quot;A&quot;)) {
        window.open(oSrc.href, oSrc.target);
        window.event.returnValue = false;
    }
} &#x2F;&#x2F;HandleEditClick


&#x2F;**
* 
*
* @method sndError
* @param {Object} evnt 
*&#x2F;
function sndError(evnt) {
    div_ArtJWPlayerImage.style.display = &quot;none&quot;;
    alert(evnt.message);
}


&#x2F;**
* 
*
* @method sndStarted
* @param {Object} evnt 
*&#x2F;
function sndStarted(evnt) {
    div_ArtJWPlayerImage.style.display = &quot;&quot;;
    &#x2F;&#x2F;    alert(&#x27;started:\n&#x27; + evnt.oldstate);
}


&#x2F;**
* Vana. 
*
* @method sndCompleted
*&#x2F;
function sndCompleted() {
    div_ArtJWPlayerImage.style.display = &quot;none&quot;;
}


&#x2F;**
* 
*
* @method SetIfrViewElement
*&#x2F;
function SetIfrViewElement() {
    if (!(ivde == null)) {
        ivde.style.backgroundColor = ivdebgc;
    }
    ivde = oViewAll(oClicked.id);
    if (!(ivde == null)) {
        ivdebgc = ivde.style.backgroundColor;
        ivde.style.backgroundColor = &quot;silver&quot;;
        ivde.scrollIntoView();
    }
} &#x2F;&#x2F;SetIfrViewElement


&#x2F;**
*  
*
* @method SetVars
*&#x2F;
function SetVars() {

    scv = oClicked.innerText

    elemlang = oClicked.lang

    nodepath = oClicked.id;
    if ((jsMid(nodepath, 0, 5) == &quot;HTML:&quot;)) {
        nodepath = jsMid(nodepath, nodepath.indexOf(&quot;&#x2F;&quot;) + 1);
    }
    spn_NodeInfo.innerText = nodepath

    var tarr;
    tarr = oClicked.className.split(&quot; &quot;);
    &#x2F;&#x2F;&quot;ehitatud&quot; elementidel on struktuur, tühja koha klikkamine ei tohi pahandusi tekitada
    &#x2F;&#x2F;className peab alati koosnema vähemalt 3-st
    if ((tarr.length &gt; 2)) {
        clType = jsLeft(tarr[0], 2) &#x2F;&#x2F;et, etx1, etvw jt;
    } else {
        clType = &quot;&quot;;
        clEditable = false;
        clickedNode = null;
        selectedNode = null
        snDecl = null;
        fatherNode = null;
        pnDecl = null;
        snQName = &quot;&quot;;
        cmHeading = &quot;&quot;;
        snKirjeldavQName = &quot;&quot;;
        spn_NodeInfo.title = &quot;[&quot; + oClicked.tagName + &quot;: &quot; + snKirjeldavQName + &quot;]: lang: &#x27;&quot; + elemlang + &quot;&#x27;; className: &#x27;&quot; + oClicked.className + &quot;&#x27;&quot;;
        return;
    }


    &#x2F;&#x2F;clickedNode mõte on eristada #text erinevaid tükke elementide sees

    &#x2F;&#x2F;väärtuse klikkamisel on:
    &#x2F;&#x2F;elemendi teksti korral on clickedNode-iks #text ning selectedNode-ks element ise
    &#x2F;&#x2F;atribuudi teksti korral on nii clickedNode-iks kui ka selectedNode-ks atribuut ise
    &#x2F;&#x2F;kommentaari teksti korral on clickedNode-iks #comment ning selectedNode-ks element, milles kommentaar paikneb

    &#x2F;&#x2F;nime klikkamisel on:
    &#x2F;&#x2F;nii elemendi kui ka atribuudi (praegu - 20mai 2006 - pole) nime korral on clickedNode-ks ja selectedNode-ks
    &#x2F;&#x2F;element või atribuut ise

    &#x2F;&#x2F;fatherNode on:
    &#x2F;&#x2F;elemendi korral elemendi parentElement
    &#x2F;&#x2F;atribuudi korral element, millele atribuut kuulub

    if (nodepath) { &#x2F;&#x2F;&#x27;nt ec (&quot;element create&quot;) korral = &quot;&quot;
        var xsdPath, xsdNode, sPr;

        &#x2F;&#x2F;viga juhul, kui clickedNode on null, nt ANY sees mitte ettenähtud element ??;
        clickedNode = oEditDOMRoot.selectSingleNode(nodepath);
        if (clickedNode.nodeType == NODE_TEXT || clickedNode.nodeType == NODE_COMMENT || clickedNode.nodeType == NODE_CDATA_SECTION) {
            selectedNode = clickedNode.parentNode;
        } else {
            selectedNode = clickedNode;
        }
        fatherNode = selectedNode.selectSingleNode(&quot;..&quot;); &#x2F;&#x2F;&#x27;atribuudil ei ole parentNode-t

        try {
            &#x2F;&#x2F;viga juhul, kui elementi skeemis pole ...;
            snDecl = oXmlSc.getDeclaration(selectedNode);
            if (!(snDecl.namespaceURI == &quot;&quot;)) {
                sPr = oXmlNsm.getPrefixes(snDecl.namespaceURI).item(0);
                if ((sPr == &quot;&quot;)) {
                    snQName = snDecl.name;
                } else {
                    snQName = sPr + &quot;:&quot; + snDecl.name;
                }
            } else {
                snQName = snDecl.name;
            }
            if (snDecl.itemType == SOMITEM_ELEMENT) {
                xsdPath = &quot;.&#x2F;&#x2F;&quot; + NS_XS_PR + &quot;:element[@name=&#x27;&quot; + snDecl.name + &quot;&#x27;]&#x2F;&quot; + NS_XS_PR + &quot;:annotation&#x2F;&quot; + NS_XS_PR + &quot;:documentation[@xml:lang=&#x27;&quot; + sAppLang + &quot;&#x27;]&quot;;
            } else if ((snDecl.itemType == SOMITEM_ATTRIBUTE)) {
                xsdPath = &quot;.&#x2F;&#x2F;&quot; + NS_XS_PR + &quot;:attribute[@name=&#x27;&quot; + snDecl.name + &quot;&#x27;]&#x2F;&quot; + NS_XS_PR + &quot;:annotation&#x2F;&quot; + NS_XS_PR + &quot;:documentation[@xml:lang=&#x27;&quot; + sAppLang + &quot;&#x27;]&quot;;
            }
            xsdNode = oXsdDOM.documentElement.selectSingleNode(xsdPath);
            if (xsdNode) {
                cmHeading = jsReplace(jsTrim(xsdNode.text), &quot;;&quot;, &quot;&quot;);
            } else {
                cmHeading = snQName;
            }
            snKirjeldavQName = cmHeading + &quot; (&quot;;
            if (snDecl.itemType == SOMITEM_ATTRIBUTE) {
                snKirjeldavQName = snKirjeldavQName + &quot;@&quot;;
            }
            snKirjeldavQName = snKirjeldavQName + snQName + &quot;)&quot;
        }
        catch (e) {
            snDecl = null;
            snQName = clickedNode.nodeName;
            cmHeading = snQName;
            snKirjeldavQName = cmHeading;
        }

        try {
            &#x2F;&#x2F;juhul, kui elementi skeemis pole ...;
            pnDecl = oXmlSc.getDeclaration(fatherNode);
        }
        catch (e) {
            pnDecl = null;
        }

        if ((clType == &quot;en&quot; || clType == &quot;an&quot;)) {
            cmHeading = &quot;&#x27;&quot; + cmHeading + &quot;&#x27;&quot;;
        } else if ((clType == &quot;et&quot; || clType == &quot;ct&quot;)) {
            cmHeading = &quot;&#x27;&quot; + cmHeading + &quot;&#x27; &quot; + jsMid(nodepath, nodepath.lastIndexOf(&quot;&#x2F;&quot;) + 1);
        } else if ((clType == &quot;at&quot;)) {
            cmHeading = &quot;&#x27;@&quot; + cmHeading + &quot;&#x27; &quot; + VALUE_WORD;
        }
        spn_NodeInfo.title = &quot;[&quot; + oClicked.tagName + &quot;: &quot; + snKirjeldavQName + &quot;]: lang: &#x27;&quot; + elemlang + &quot;&#x27;; className: &#x27;&quot; + oClicked.className + &quot;&#x27;; nodeType: &quot; + clickedNode.nodeType + &quot; (&quot; + clickedNode.nodeTypeString + &quot;)&quot;

    } else { &#x2F;&#x2F;nt ec (&quot;element create&quot;) korral = &quot;&quot;;
        clickedNode = null;
        selectedNode = null
        snDecl = null;
        fatherNode = null;
        pnDecl = null;
        snQName = &quot;&quot;;
        cmHeading = &quot;&quot;;
        snKirjeldavQName = &quot;&quot;;
        spn_NodeInfo.title = &quot;[&quot; + oClicked.tagName + &quot;: &quot; + snKirjeldavQName + &quot;]: lang: &#x27;&quot; + elemlang + &quot;&#x27;; className: &#x27;&quot; + oClicked.className + &quot;&#x27;&quot;;
        return;
    }

    var elemNoEditOtsitav, attrNoEditOtsitav;
    if (neElems.indexOf(&quot;&#x2F;&quot;) &gt; -1) {
        elemNoEditOtsitav = fatherNode.nodeName + &quot;&#x2F;&quot; + selectedNode.nodeName;
    } else {
        elemNoEditOtsitav = selectedNode.nodeName;
    }
    if (neAttribs.indexOf(&quot;&#x2F;&quot;) &gt; -1) {
        attrNoEditOtsitav = fatherNode.nodeName + &quot;&#x2F;@&quot; + selectedNode.nodeName;
    } else {
        attrNoEditOtsitav = selectedNode.nodeName;
    }
    clEditable = false;
    if (!(clickedNode == null)) {
        &#x2F;&#x2F;teiste (NODE_ELEMENT, NODE_COMMENT, NODE_CDATA_SECTION, ...) vt eespool;
        if ((clickedNode.nodeType == NODE_TEXT)) {
            if (!(tarr[2] == &quot;noedit&quot;)) {
                clEditable = true;
            }
            if ((neElems.indexOf(&quot;;&quot; + elemNoEditOtsitav + &quot;;&quot;) &gt; -1)) {
                clEditable = false;
            }
        } else if ((clickedNode.nodeType == NODE_ATTRIBUTE)) {
            if (!(tarr[2] == &quot;noedit&quot;)) {
                clEditable = true;
            }
            if ((neAttribs.indexOf(&quot;;&quot; + attrNoEditOtsitav + &quot;;&quot;) &gt; -1)) {
                clEditable = false;
            }
        }
        if ((clickedNode.nodeType == NODE_TEXT || clickedNode.nodeType == NODE_ATTRIBUTE)) {
            if ((zeus.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1)) {
                clEditable = true;
            }
            if ((window.event.ctrlLeft &amp;&amp; eeLexAdmin.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1)) {
                clEditable = true;
            }
        }
    }

} &#x2F;&#x2F;SetVars


&#x2F;**
*  
*
* @method SetEdits
*&#x2F;
function SetEdits() {
    if (snDecl == null) {
        return;
    }

    var cee, optstr, selind, i, oType, xsdPath, xsdNode, optTitle; &#x2F;&#x2F; &lt;julius&gt; lisatud alates &#x27;oType&#x27; kuni &#x27;optTitle&#x27;
    cee = oClicked;

    oClickedBorder = oClicked.style.border;
    if (oClickedBorder == &quot;&quot;) {
        oClickedBorder = jsTrim(oClicked.currentStyle.borderColor + &quot; &quot; + oClicked.currentStyle.borderWidth + &quot; &quot; + oClicked.currentStyle.borderStyle);
    }


    &#x2F;&#x2F;mT - meedia tüüp
    var smdArgs, retVal, mT = &#x27;&#x27;, tyybiFail, importDOM;

    oClicked.style.border = &quot;red 2px solid&quot;;
    optstr = &quot;&quot;;
    selind = -1;

    if (selectedNode.nodeType == NODE_ELEMENT) {
        if (snQName != &quot;x:link&quot;) { &#x2F;&#x2F; its::&lt;link&gt; elemendil on küll @mT, kuid parandada tuleb @href ennast
            mT = selectedNode.getAttribute(DICPR + &quot;:mT&quot;); &#x2F;&#x2F;&#x27;Pärtel Lippus - foneetika terminite sõnastik, pildifail;
            if (!mT) {
                mT = &quot;&quot;;
            }
        }
    } else if (selectedNode.nodeType == NODE_ATTRIBUTE) { &#x2F;&#x2F; &#x27;its&#x27; link&#x2F;@href
        &#x2F;&#x2F;        if (selectedNode.baseName == &#x27;href&#x27;) {
        &#x2F;&#x2F;            mT = fatherNode.getAttribute(DICPR + &quot;:mT&quot;);
        &#x2F;&#x2F;        }
    }

    if (mT == &quot;&quot;) {
        if (snQName == &quot;n:aa&quot;) { &#x2F;&#x2F;&#x27;Eesti kohanimeraamat: kirjandus; teos: autor aasta;
            mT = &quot;pikkLoend&quot;;
        } else if (snQName == &quot;x:stn&quot;) { &#x2F;&#x2F; its: standard
            mT = &quot;pikkLoend&quot;;
        } else if (snQName == &quot;c:vbf&quot;) { &#x2F;&#x2F;&#x27;põhisõnavara sõnastik; viipe fail;
            mT = &quot;flashPlayer&quot;;
        } else if (snQName == &quot;x:pilt&quot;) { &#x2F;&#x2F;&#x27;its pilt &lt;pilt&gt;
            mT = &quot;flashPlayerImage&quot;;
        } else if (snQName == &quot;x:dst&quot;) { &#x2F;&#x2F;&#x27;its: link pildile iref&#x2F;@dst
            mT = &quot;flashPlayerImage&quot;;
        }
    } else {
        if (mT == &quot;img&quot;) { &#x2F;&#x2F;&#x27;pilt;
            mT = &quot;flashPlayerImage&quot;;
        } else if (mT == &quot;f?v&quot;) {
            mT = &quot;flashPlayer&quot;;
        } else if (mT == &quot;snd&quot;) {
            mT = &quot;flashPlayerSound&quot;;
        }
    }

    if (!trueIfrDocClick) {
        if (mT != &quot;&quot;) {
            oClicked.style.border = oClickedBorder
            return;
        }
    }

    &#x2F;&#x2F;oType, tyybiFail, importDOM
    if ((snDecl.type.enumeration.length &gt; 0)) {
        if ((snDecl.type.name == &quot;&quot;)) {
            oType = snDecl.type.baseTypes[0];
        } else {
            oType = snDecl.type;
        }
        if ((oType.namespaceURI != DICURI)) {
            tyybiFail = &quot;xsd&#x2F;&quot; + impSchemaLocations.item(oType.namespaceURI);
            importDOM = IDD(&quot;File&quot;, tyybiFail, false, false, null);
            importDOM.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
            importDOM.setProperty(&quot;SelectionNamespaces&quot;, jsTrim(sXsdNsList));
        } else {
            tyybiFail = &quot;xsd&#x2F;schema_&quot; + dic_desc + &quot;.xsd&quot;;
            importDOM = oXsdDOM;
        }
    }

    if (mT == &quot;pikkLoend&quot;) {
        smdArgs = new Array(dic_desc, tyybiFail, oType.name, scv, sAppLang);
        retVal = window.showModalDialog(&quot;html&#x2F;listingLoend.htm&quot;, smdArgs, &quot;dialogHeight:300px;dialogWidth:1024px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:no;unadorned:no&quot;);
        oClicked.style.border = oClickedBorder;
        if (retVal != scv &amp;&amp; retVal != null) {
            clickedNode.nodeValue = retVal;
            oClicked.innerText = retVal;
            updMuudatused(&quot;S&quot;, retVal);
            ValueChecks(retVal, scv) &#x2F;&#x2F;märksõna, hom.nr, kom;
            vaatedRefresh(1);
        }
        return;
    } else if (mT == &quot;flashPlayer&quot;) {
        smdArgs = new Array(dic_desc, sAppLang, sUsrName, scv, &quot;&#x2F;__video&#x2F;&quot;);
        retVal = window.showModalDialog(&quot;html&#x2F;showVideo.htm&quot;, smdArgs, &quot;dialogHeight:600px;dialogWidth:800px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:no;unadorned:no&quot;);
        oClicked.style.border = oClickedBorder;
        if (retVal) {
            if (retVal != scv) {
                clickedNode.nodeValue = retVal;
                oClicked.innerText = retVal;
                updMuudatused(&quot;S&quot;, retVal);
                vaatedRefresh(1);
            }
        }
        return;
    } else if (mT == &quot;flashPlayerImage&quot;) {
        smdArgs = new Array(dic_desc, sAppLang, sUsrName, scv, &quot;&#x2F;__pildid&#x2F;&quot;);
        retVal = window.showModalDialog(&quot;html&#x2F;showVideo.htm&quot;, smdArgs, &quot;dialogHeight:600px;dialogWidth:800px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:no;unadorned:no&quot;);
        oClicked.style.border = oClickedBorder;
        if (retVal) {
            if (retVal != scv) {
                clickedNode.nodeValue = retVal;
                oClicked.innerText = retVal;
                updMuudatused(&quot;S&quot;, retVal);
                vaatedRefresh(1);
            }
        }
        return;
    } else if ((mT == &quot;flashPlayerSound&quot;)) {
        smdArgs = new Array(dic_desc, sAppLang, sUsrName, scv, &quot;&#x2F;__heli&#x2F;&quot;);
        retVal = window.showModalDialog(&quot;html&#x2F;showVideo.htm&quot;, smdArgs, &quot;dialogHeight:600px;dialogWidth:800px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:no;unadorned:no&quot;);
        oClicked.style.border = oClickedBorder;
        if (retVal) {
            if (retVal != scv) {
                clickedNode.nodeValue = retVal;
                oClicked.innerText = retVal;
                updMuudatused(&quot;S&quot;, retVal);
                vaatedRefresh(1);
            }
        }
        return;
    } else if ((snDecl.type.enumeration.length &gt; 0)) {
        for (i = 0; i &lt; snDecl.type.enumeration.length; i++) {
            xsdPath = NS_XS_PR + &quot;:simpleType[@name = &#x27;&quot; + oType.name + &quot;&#x27;]&#x2F;&#x2F;&quot; + NS_XS_PR + &quot;:enumeration[@value = &#x27;&quot; + snDecl.type.enumeration[i] + &quot;&#x27;]&#x2F;&quot; + NS_XS_PR + &quot;:annotation&#x2F;&quot; + NS_XS_PR + &quot;:documentation[@xml:lang = &#x27;&quot; + sAppLang + &quot;&#x27;]&quot;;
            xsdNode = importDOM.documentElement.selectSingleNode(xsdPath);
            optTitle = snDecl.type.enumeration[i];
            if (xsdNode) {
                optTitle = optTitle + &quot; - &quot; + jsTrim(xsdNode.text);
                if (dest_language) {
                    xsdPath = NS_XS_PR + &quot;:simpleType[@name = &#x27;&quot; + oType.name + &quot;&#x27;]&#x2F;&#x2F;&quot; + NS_XS_PR + &quot;:enumeration[@value=&#x27;&quot; + snDecl.type.enumeration[i] + &quot;&#x27;]&#x2F;&quot; + NS_XS_PR + &quot;:annotation&#x2F;&quot; + NS_XS_PR + &quot;:documentation[@xml:lang=&#x27;&quot; + dest_language + &quot;&#x27;]&quot;;
                    xsdNode = importDOM.documentElement.selectSingleNode(xsdPath);
                    if (xsdNode) {
                        optTitle = optTitle + &quot; &#x2F; &quot; + jsTrim(xsdNode.text);
                    }
                }
            }
            optstr = optstr + &quot;&lt;option id=&#x27;&quot; + snDecl.type.enumeration[i] + &quot;&#x27;&gt;&quot; + optTitle + &quot;&lt;&#x2F;option&gt;&quot;;
            if ((snDecl.type.enumeration[i] == scv)) {
                selind = i + 1; &#x2F;&#x2F;sest ette tuleb veel tühi;
            }
        } &#x2F;&#x2F; for
        oClicked.innerHTML = &quot;&lt;select id=&#x27;oClickedSelect&#x27; style=&#x27;width:10cm;&#x27; name=&#x27;oClickedSelect&#x27; tabIndex=&#x27;0&#x27;&gt;&quot; + &quot;&lt;option id=&#x27;&#x27;&gt;&lt;&#x2F;option&gt;&quot; + optstr + &quot;&lt;&#x2F;select&gt;&quot;;
        cee = oClicked.all(&quot;oClickedSelect&quot;);
        if ((selind &gt; -1)) {
            cee.options(selind).selected = true;
        }
    } else if ((snDecl.name == &quot;lang&quot; &amp;&amp; snDecl.namespaceURI == NS_XML)) {
        optstr = getKeeledOptString(scv);
        oClicked.innerHTML = &quot;&lt;select id=&#x27;oClickedSelect&#x27; name=&#x27;oClickedSelect&#x27; tabIndex=&#x27;0&#x27;&gt;&quot; + &quot;&lt;option id=&#x27;&#x27;&gt;&lt;&#x2F;option&gt;&quot; + optstr + &quot;&lt;&#x2F;select&gt;&quot;;
        cee = oClicked.all(&quot;oClickedSelect&quot;);
    } else if ((snDecl.type.itemType == SOMITEM_DATATYPE_BOOLEAN)) {
        optstr = optstr + &quot;&lt;option id=&#x27;false&#x27;&gt;ei  - false&lt;&#x2F;option&gt;&quot;;
        optstr = optstr + &quot;&lt;option id=&#x27;true&#x27;&gt;jah - true&lt;&#x2F;option&gt;&quot;;
        if ((scv == &quot;false&quot;)) {
            selind = 1; &#x2F;&#x2F;sest ette tuleb veel tühi;
        } else if ((scv == &quot;true&quot;)) {
            selind = 2; &#x2F;&#x2F;sest ette tuleb veel tühi;
        }
        oClicked.innerHTML = &quot;&lt;select id=&#x27;oClickedSelect&#x27; name=&#x27;oClickedSelect&#x27; tabIndex=&#x27;0&#x27;&gt;&quot; + &quot;&lt;option id=&#x27;&#x27;&gt;&lt;&#x2F;option&gt;&quot; + optstr + &quot;&lt;&#x2F;select&gt;&quot;;
        cee = oClicked.all(&quot;oClickedSelect&quot;);
        if ((selind &gt; -1)) {
            cee.options(selind).selected = true;
        }
    } else {
        var pte, textRng, textRects, spWidth, spRows;
        pte = oClicked.parentTextEdit;
        textRng = pte.createTextRange();
        textRng.moveToElementText(oClicked);
        textRects = textRng.getClientRects();

        spRows = textRects.length;

        if (!(oXslEdit === oXsl2)) {
            spWidth = oClicked.offsetWidth;
            if ((spRows == 1)) {
                spWidth = spWidth + 25; &#x2F;&#x2F;textArea scrollbar laius on ca 23;
            }
            &#x2F;&#x2F;tühja välja korral viskab miskipärast kasti paremale ...;
            if ((spWidth &lt; (document.body.clientWidth * 0.5))) {
                spWidth = parseInt(document.body.clientWidth * 0.5);
            }
        } else {
            spWidth = oClicked.parentElement.offsetWidth + 32;
            if ((spWidth &lt; 64)) {
                spWidth = 64;
            }
        }
        spRows = spRows + 1;
        if (spRows &gt; 8) {
            spRows = 8;
        }

        var taStyle = &#x27;width:&#x27; + spWidth + &#x27;px;&#x27;;
        &#x2F;&#x2F;        if (textEditFont) {
        &#x2F;&#x2F;            taStyle += &#x27;font-family:&quot;&#x27; + textEditFont + &#x27;&quot;;&#x27;;
        &#x2F;&#x2F;        }
        oClicked.innerHTML = &quot;&lt;TEXTAREA id=&#x27;oClickedTextArea&#x27; name=&#x27;oClickedTextArea&#x27; &quot; + &quot;style=&#x27;&quot; + taStyle + &quot;&#x27; rows=&#x27;&quot; + spRows + &quot;&#x27; tabIndex=&#x27;0&#x27;&gt;&quot; + scv + &quot;&lt;&#x2F;TEXTAREA&gt;&quot;;
        cee = oClicked.all(&quot;oClickedTextArea&quot;);

        if (scv == &quot;-???-&quot; || scv == &quot;|???|&quot; || scv == &quot;|vaste|&quot; || scv == &quot;|tõlge|&quot;) {
            cee.select();
        }
    }

	&#x2F;&#x2F;ain ats
    ccField = clickedNode.nodeValue;
    cee.onblur = HandleCeeBlur;
    cee.onfocus = ceeOnFocus;
    cee.setActive();
    cee.focus();

} &#x2F;&#x2F;SetEdits


&#x2F;**
*  
*
* @method vbSetKBLang
* @param {String} l
*&#x2F;
function vbSetKBLang(l) {
    &#x2F;&#x2F;siin tulevad nüüd need 3-tähelised keelekoodid, tavaliselt on nad mingi keele alamosa
    if (l == &quot;vro&quot;) { &#x2F;&#x2F;&#x27;võru
        l = &quot;et&quot;;
    } else if (l == &quot;mhr&quot;) { &#x2F;&#x2F;&#x27;mari;
        l = &quot;ru&quot;;
    } else if (l == &quot;x-mhr&quot;) { &#x2F;&#x2F;&#x27;mari;
        l = &quot;ru&quot;;
    } else if (l == &quot;mrj&quot;) { &#x2F;&#x2F;&#x27;mari;
        l = &quot;ru&quot;;
    } else if (l == &quot;ex&quot;) { &#x2F;&#x2F;&#x27;Eesti-X;
        return;
    }
    var sta, msgSisu;
    try {
        sta = eelexSWCtl.setKeyboardLayout(l);
        if (sta &lt; -1) {
            &#x2F;&#x2F;-1: vigased sisendparameetrid;
            &#x2F;&#x2F;-2: ei leitud locale-t (nt Windows XP-s on locale name &#x27;null&#x27;!);
            &#x2F;&#x2F;-3: ei leitud klaviatuuri paigutust;
            msgSisu = &quot;&lt;img src=&#x27;graphics&#x2F;error.ico&#x27; width=&#x27;16&#x27;&gt;&lt;b&gt;setKeyboardLayout:&lt;&#x2F;b&gt; &quot; + sta;
            spn_msg.innerHTML = msgSisu;
        }
    }
    catch (e) {
        &#x2F;&#x2F;        alert(e.name + &quot; 0x&quot; + hex(e.number, true) + &quot;: &#x27;&quot; + e.description + &quot;&#x27;.&quot;);
    }
} &#x2F;&#x2F;vbSetKBLang


&#x2F;**
*  
*
* @method inp_ElemTextOnFocus
*&#x2F;
function inp_ElemTextOnFocus() {
    var kbLang;
    if ((setKeyboard)) {
        if ((mnuElemLang.length &gt; 0)) {
            kbLang = mnuElemLang;
        } else {
            kbLang = orgKBLayoutLang;
        }
        vbSetKBLang(kbLang);
    }
} &#x2F;&#x2F;inp_ElemTextOnFocus


&#x2F;**
*  
*
* @method ceeOnFocus
*&#x2F;
function ceeOnFocus() {
    var oSrc = window.event.srcElement;
    if (oSrc.id == &quot;oClickedTextArea&quot;) {
        if (setKeyboard) {
            vbSetKBLang(elemlang);
        }
    }
} &#x2F;&#x2F;ceeOnFocus


&#x2F;**
*  
*
* @method documentOnFocusOut
*&#x2F;
function documentOnFocusOut() {
    if ((setKeyboard)) {
        if (!document.hasFocus()) {
            vbSetKBLang(orgKBLayoutLang);
        }
    }
} &#x2F;&#x2F;documentOnFocusOut


&#x2F;**
*  
*
* @method HandleCeeBlur
*&#x2F;
function HandleCeeBlur() {
    var nsv; &#x2F;&#x2F;new span value

    var oBlur = window.event.srcElement;

    var checkSta = false, kontrollida = true;

    if (oBlur.tagName == &quot;SELECT&quot;) {
        if (oBlur.selectedIndex &gt; -1) {
            nsv = oBlur.options(oBlur.selectedIndex).id;
        } else {
            nsv = scv; &#x2F;&#x2F;vana väärtus tagasi;
        }
        kontrollida = false;
    } else if (oBlur.id == &quot;oClickedTextArea&quot;) {
        &#x2F;&#x2F;        nsv = jsTrim(oBlur.value);
        nsv = jsTrim(oBlur.innerText);
        if (!(nsv == &quot;&quot; &amp;&amp; scv == &quot;&quot;)) {
            &#x2F;&#x2F;ISchemaElement.type.isvalid(...) ei tööta nt ComplexType-i korral;
            if ((snDecl.type.itemType == SOMITEM_COMPLEXTYPE)) {
                if ((snDecl.type.contentType == SCHEMACONTENTTYPE_MIXED)) {
                    checkSta = CheckCeeValue(nsv, &quot;string&quot;);
                } else if ((snDecl.type.contentType == SCHEMACONTENTTYPE_ELEMENTONLY)) { &#x2F;&#x2F;nt kommentaar elemendi sees;
                    checkSta = CheckCeeValue(nsv, &quot;string&quot;);
                } else if ((snDecl.type.contentType == SCHEMACONTENTTYPE_TEXTONLY)) {
                    if ((snDecl.type.baseTypes.length &gt; 0)) {
                        checkSta = CheckCeeValue(nsv, snDecl.type.baseTypes[0].name);
                    } else {
                        checkSta = CheckCeeValue(nsv, &quot;string&quot;);
                    }
                }
            } else if ((snDecl.type.itemType == SOMITEM_SIMPLETYPE)) { &#x2F;&#x2F;kui element on mittestandardse tüübiga (type = ...);
                checkSta = CheckCeeValue(nsv, snDecl.type.baseTypes[0].name);
            } else if ((snDecl.type.itemType == SOMITEM_DATATYPE_DATETIME)) {
                checkSta = CheckCeeValue(nsv, &quot;dateTime&quot;);
            } else if ((snDecl.type.itemType == SOMITEM_DATATYPE_POSITIVEINTEGER)) {
                checkSta = CheckCeeValue(nsv, &quot;positiveInteger&quot;);
            } else if ((snDecl.type.itemType == SOMITEM_DATATYPE_UNSIGNEDBYTE)) {
                checkSta = CheckCeeValue(nsv, &quot;positiveInteger&quot;);
            } else if ((snDecl.type.itemType == SOMITEM_DATATYPE_DECIMAL)) {
                nsv = jsReplace(nsv, &quot;,&quot;, &quot;.&quot;);
                oBlur.value = nsv;
                checkSta = CheckCeeValue(nsv, &quot;decimal&quot;);
            } else if ((snDecl.type.itemType == SOMITEM_DATATYPE_STRING)) {
                checkSta = CheckCeeValue(nsv, &quot;string&quot;);
            }
            if (!(checkSta)) {
                oBlur.setActive();
                oBlur.focus();
                oBlur.select();
                return;
            }
        }
		    &#x2F;&#x2F; ======================================================================================================
			&#x2F;&#x2F; ats+++  (28.11.2012&#x2F;29.11.2012)
			&#x2F;&#x2F; ======================================================================================================
			if (atsOnViit(selectedNode.nodeName)) {
			  var currTekst = oBlur.value;
			  currTekst = currTekst.replace(&#x2F;\s+$&#x2F;, &#x27;&#x27;);
			  if (ccField != currTekst) {
				&#x2F;&#x2F;alert(ccField + &quot; == &quot; + currTekst);
				ccField = currTekst;
				atsRunQuery(currTekst);
			  }
			}
			&#x2F;&#x2F;ats
    }

    oBlur.onfocus = null;
    oBlur.onblur = null;
    oBlur = null;
    oClicked.style.border = oClickedBorder;

    oClicked.innerText = scv;

    if (nsv != scv) {

        if (kontrollida) {
            nsv = tekstiTeisendused(nsv);
        }

        clickedNode.nodeValue = nsv;
        oClicked.innerText = nsv;

        updMuudatused(&quot;S&quot;, nsv);

        ValueChecks(nsv, scv);  &#x2F;&#x2F;märksõna, hom.nr, kom;

        vaatedRefresh(2);
    }

    oClicked.focus();

} &#x2F;&#x2F;HandleCeeBlur


&#x2F;**
*  
*
* @method vaatedRefresh
* @param {Int} nr eeldan, et on Int, ei kontrollinud
*&#x2F;
function vaatedRefresh(nr) {
    var oclid;
    if (oClicked) {
        oclid = oClicked.id;
    }

    oEditAll(&quot;ifrdiv&quot;).setAttribute(&quot;xmlChanged&quot;, nr);
    if (oclid) {
        oClicked = oEditAll(oclid);
    }
    if (oViewAll(&quot;_copyDiv&quot;) == null) {
        if (dic_desc == &quot;evs&quot;) {
            var domCopy;
            domCopy = oEditDOM.cloneNode(true);
            TeisendaDOM(domCopy);
            oViewAll(&quot;ifrviewdiv&quot;).innerHTML = domCopy.transformNode(oXslView);
        } else {
            oViewAll(&quot;ifrviewdiv&quot;).innerHTML = oEditDOM.transformNode(oXslView);
        }
    }
} &#x2F;&#x2F;vaatedRefresh


&#x2F;**
*  
*
* @method CheckCeeValue
* @param {Int} chkvalue
* @param {} dt
* @returns {Boolean}
*&#x2F;
function CheckCeeValue(chkvalue, dt) {
    var CheckCeeValue;
    var spellValue;
    var rex;
    switch (dt) {
        case &quot;positiveInteger&quot;:
            var posintvalue = true;
            if (isNaN(chkvalue)) {
                posintvalue = false;
            } else {
                if ((parseInt(chkvalue) &lt; 1 || chkvalue.indexOf(&quot;.&quot;) &gt; -1 || chkvalue.indexOf(&quot;,&quot;) &gt; -1)) {
                    posintvalue = false;
                }
            }
            if (!(posintvalue)) {
                alert(REQUIRED_POS_INT, jsvbCritical, snKirjeldavQName);
            }
            CheckCeeValue = posintvalue;
            break;
        case &quot;decimal&quot;:
            CheckCeeValue = !isNaN(chkvalue);
            break;
        case &quot;dateTime&quot;:
            rex = &#x2F;^\d{4}\-\d{2}\-\d{2}T\d{2}:\d{2}:\d{2}$&#x2F;;
            if (chkvalue.match(rex)) {
                CheckCeeValue = true;
            } else {
                alert(REQUIRED_DATE_TIME);
                CheckCeeValue = false;
            }
            break;
        case &quot;string&quot;:
            if ((doSpellCheck)) {
                var sta, nameLocal, msgSisu;
                nameLocal = jsStrRepeat(255, String.fromCharCode(0));
                try {
                    sta = eelexSWCtl.mySpellCheck(chkvalue, elemlang, nameLocal);
                    if ((sta == 0)) {
                        msgSisu = &quot;&lt;img src=&#x27;graphics&#x2F;warning.ico&#x27; width=&#x27;16&#x27;&gt; &quot; + CHECK_SPELLING + &quot;&lt;b&gt;&quot; + chkvalue + &quot;&lt;&#x2F;b&gt;, &quot; + LANGUAGE_WORD + &quot;&#x27;&quot; + elemlang + &quot;&#x27; (&quot; + nameLocal + &quot;)!&quot;;
                        spn_msg.innerHTML = msgSisu;
                    } else if ((sta == 1)) {
                        spn_msg.innerHTML = &#x27;&#x27;;
                    } else {
                        &#x2F;&#x2F;-1: vigased sisendparameetrid;
                        &#x2F;&#x2F;-2: ei leitud locale-t (nt Windows XP-s on locale name &#x27;null&#x27;!);
                        &#x2F;&#x2F;-3: puudub MS Word;
                        &#x2F;&#x2F;-4: pole local-le vastavat Word language-t;
                        &#x2F;&#x2F;-5: puudub antud keelele vastav Wordi õigekirjakontrolli sõnastik (ehk siis speller ei ole installitud);
                        msgSisu = &quot;&lt;img src=&#x27;graphics&#x2F;error.ico&#x27; width=&#x27;16&#x27;&gt;&lt;b&gt;mySpellCheck:&lt;&#x2F;b&gt; &quot; + sta;
                        if ((sta == -3)) {
                            msgSisu = msgSisu + &quot; (puudub MS Office Word).&quot;;
                        } else if ((sta == -5)) {
                            msgSisu = msgSisu + &quot; (ei ole installeeritud keelele vastavat õigekirjakontrolli).&quot;;
                        }
                        spn_msg.innerHTML = msgSisu;
                    }
                }
                catch (e) {
                    alert(e.name + &quot; 0x&quot; + hex(e.number, true) + &quot;: &#x27;&quot; + e.description + &quot;&#x27;.&quot;);
                }
            }
            CheckCeeValue = true;
            break;
        default:
            CheckCeeValue = true;
            break;
    }
    return CheckCeeValue;
} &#x2F;&#x2F;CheckCeeValue


&#x2F;**
*  
*
* @method HandleViewClick
*&#x2F;
function HandleViewClick() {

    if (ivde) {
        ivde.style.backgroundColor = ivdebgc;
    }

    var oSrc = window.event.srcElement;

    &#x2F;&#x2F;entiteedid pannakase kaldkirjas, alakaareke mingi teise (MS Mincho) fondiga;
    &#x2F;&#x2F;hiirega saab pihta ainult &quot;I&quot; - le, &quot;B&quot; - le või &quot;FONT&quot; - ile; osa spane on em teisendustest
    if (oSrc.tagName == &quot;FONT&quot; || oSrc.tagName == &quot;B&quot; || oSrc.tagName == &quot;I&quot; || oSrc.tagName == &quot;U&quot;) {
        oSrc = oSrc.parentElement;
    }

    window.event.returnValue = false;

    var elId, thisElement, msTekst, tNode;
    if (oSrc.tagName == &quot;A&quot;) {
        elId = oSrc.parentElement.id; &#x2F;&#x2F;SPAN id, nt &quot;f:A[1]&#x2F;f:P[1]&#x2F;f:mvt[1]&#x2F;text()[1]&quot;;
    } else {
        elId = oSrc.id; &#x2F;&#x2F;SPAN id, nt &quot;f:A[1]&#x2F;f:P[1]&#x2F;f:mvt[1]&#x2F;text()[1]&quot;;
    }
    &#x2F;&#x2F;HTML:li
    if (jsMid(elId, 0, 5) == &quot;HTML:&quot;) {
        elId = elId.substr(elId.indexOf(&quot;&#x2F;&quot;) + 1);
    }

    &#x2F;&#x2F;tekstist üles elemendile
    &#x2F;&#x2F;kaob elemendi (text()[x])
    if (elId.length &gt; 0) {
        thisElement = oEditDOMRoot.selectSingleNode(elId);
    }
    msTekst = &quot;&quot;;

    if (!thisElement) { &#x2F;&#x2F; nt pildid vaates on ilma ID-ta
        if (oSrc.tagName != &quot;IMG&quot;)
            return;
    }

    if (thisElement) { &#x2F;&#x2F;nt &quot;divFrameView&quot; ei ole
        if (thisElement.nodeType == NODE_TEXT) {
            var tNoded = thisElement.parentNode.selectNodes(&quot;text()&quot;);
            for (i = 0; i &lt; tNoded.length; i++) {
                msTekst = msTekst + tNoded[i].xml;
            }
        } else if (thisElement.nodeType == NODE_ATTRIBUTE) { &#x2F;&#x2F; ÕS 2006 mvt&#x2F;@kuhu
            msTekst = thisElement.value;
        }
        thisElement = thisElement.selectSingleNode(&quot;..&quot;); &#x2F;&#x2F;&#x27;teksti v atribuudi pealt üles elemendile;
    }

    if (oSrc.tagName == &quot;A&quot; || (oSrc.tagName == &quot;SPAN&quot; &amp;&amp; oSrc.className.indexOf(&quot; lingike&quot;) &gt; -1)) {

        if (salvestaJaKatkesta()) {
            return;
        }


        &#x2F;&#x2F; kui aga klõpsamisel on vaja hoopis näidata pilti (its: iref&#x2F;@dst)
        var dstAttr, href, fullHREF;
        dstAttr = thisElement.selectSingleNode(&quot;@&quot; + DICPR + &quot;:dst&quot;);
        if (dstAttr) {
            href = thisElement.getAttribute(DICPR + &quot;:dst&quot;);
            fullHREF = asuKoht + &#x27;__sr&#x2F;&#x27; + dic_desc + &#x27;&#x2F;__pildid&#x2F;&#x27; + href;
            window.open(fullHREF, &#x27;_blank&#x27;);
            return;
        }
        &#x2F;&#x2F; its: stn&#x2F;@href
        dstAttr = thisElement.selectSingleNode(&quot;@&quot; + DICPR + &quot;:href&quot;);
        if (dstAttr) {
            href = thisElement.getAttribute(DICPR + &quot;:href&quot;);
            window.open(href, &#x27;_blank&#x27;);
            return;
        }


        &#x2F;&#x2F; nt har viidatakse artiklis &#x27;performance&#x27; märksõnale &#x27;happening&#x27;, mis on tsitaatsõna (liik=&#x27;z&#x27;)
        &#x2F;&#x2F; teistes aga vsl: &#x27;pentaad&#x27; -&gt; &#x27;pent-&#x27;

        var qM;
        qM = &quot;MySql&quot;;
        &#x2F;&#x2F;Ctrl + click on IE-8 uue saki avamise otsetee (?), nagunii ei töötaks &lt;a&gt; korral;
        &#x2F;&#x2F;&lt;a&gt; tuleks teha &lt;span style=cursor:hand&gt;;
        if (oSrc.tagName == &quot;SPAN&quot; &amp;&amp; window.event.ctrlLeft) {
            qM = &quot;XML&quot;;
        }

        sQryInfo = jsTrim(msTekst);

        var kfAttr, gAttr;
        kfAttr = thisElement.selectSingleNode(&quot;@&quot; + DICPR + &quot;:KF&quot;); &#x2F;&#x2F; # &quot;ief1&quot; jne
        if (kfAttr == null) {
            kfAttr = thisElement.selectSingleNode(&quot;@&quot; + DICPR + &quot;:aKF&quot;);
        }
        gAttr = thisElement.selectSingleNode(&quot;@&quot; + DICPR + &quot;:g&quot;);
        if (gAttr == null) {
            gAttr = thisElement.selectSingleNode(&quot;@&quot; + DICPR + &quot;:aG&quot;);
        }
        &#x2F;&#x2F;combo valikust saadud andmed ...;
        if (!(kfAttr == null || gAttr == null)) {
            var kf, g;
            kf = kfAttr.text; &#x2F;&#x2F;nt &quot;ief1&quot;;
            g = gAttr.text;

            sCmdId = &quot;BrowseRead&quot;

            sPrmDomXml = &quot;&lt;prm&gt;&quot; +
                             &quot;&lt;cmd&gt;&quot; + sCmdId + &quot;&lt;&#x2F;cmd&gt;&quot; +
                             &quot;&lt;vol&gt;&quot; + kf + &quot;&lt;&#x2F;vol&gt;&quot; +
                             &quot;&lt;nfo&gt;&quot; + sQryInfo + &quot;&lt;&#x2F;nfo&gt;&quot; +
                             &quot;&lt;G&gt;&quot; + g + &quot;&lt;&#x2F;G&gt;&quot; +
                             &quot;&lt;qM&gt;&quot; + qM + &quot;&lt;&#x2F;qM&gt;&quot; +
                         &quot;&lt;&#x2F;prm&gt;&quot;;

            oPrmDom = IDD(&quot;String&quot;, sPrmDomXml, false, false, null);
            if ((oPrmDom.parseError.errorCode != 0)) {
                ShowXMLParseError(oPrmDom);
                return;
            }
            StartOperation(oPrmDom)

        } else {

            var i, vahemik;
            &#x2F;&#x2F;vajalik köide paika!;
            &#x2F;&#x2F;(vali &quot;Kõik köited&quot;);
            &#x2F;&#x2F;(sel_Vol.selectedIndex = sel_Vol.options.length - 2);
            if (dic_vols_count &gt; 1) {
                var oConfigDOM, vollid, otsad;
                oConfigDOM = IDD(&quot;File&quot;, &quot;shsconfig_&quot; + dic_desc + &quot;.xml&quot;, false, false, null);
                if (oConfigDOM.parseError.errorCode != 0) {
                    ShowXMLParseError(oConfigDOM);
                    return;
                }
                vollid = oConfigDOM.documentElement.selectNodes(&quot;vols&#x2F;vol&quot;);
                for (i = 0; i &lt; vollid.length; i++) {
                    vahemik = vollid[i].text;
                    &#x2F;&#x2F; PSV teine köide &#x27;AB&#x27; artiklid: &lt;vol nr=&quot;2&quot;&gt;AB: A - Y&lt;&#x2F;vol&gt;
                    if (vahemik.indexOf(&quot;:&quot;) &gt; -1) {
                        vahemik = jsTrim(vahemik.substr(vahemik.indexOf(&quot;:&quot;) + 1));
                    }
                    otsad = vahemik.split(&quot; - &quot;);
                    if (((jsStrComp(jsLeft(RemoveSymbols(msTekst, &quot; &quot;), otsad[0].length), otsad[0], 1) &gt;= 0) &amp;&amp; (jsStrComp(jsLeft(RemoveSymbols(msTekst, &quot; &quot;), otsad[1].length), otsad[1], 1) &lt;= 0))) {
                        sel_Vol.selectedIndex = i;
                        break;
                    }
                }
                oConfigDOM = null;
            }

            var vHomTing, homNrNode, mySqlMsAttCond;
            vHomTing = &quot;&quot;;
            mySqlMsAttCond = &quot;&quot;;
            &#x2F;&#x2F;&lt;mvt&gt;  -viide märksõnale; &lt;lvt&gt; - SP-s viide pereliikmele;
            homNrNode = thisElement.selectSingleNode(&quot;@&quot; + DICPR + &quot;:iv&quot;);
            if (homNrNode == null) {
                homNrNode = thisElement.selectSingleNode(DICPR + &quot;:vhom&quot;);
            }
            if (homNrNode == null) {
                &#x2F;&#x2F;sõnaperedes ja SS1-s &lt;mvt&gt; küljes;
                homNrNode = thisElement.selectSingleNode(&quot;@&quot; + DICPR + &quot;:i&quot;);
            }
            if (homNrNode) {
                vHomTing = &quot;[@&quot; + DICPR + &quot;:i = &#x27;&quot; + homNrNode.text + &quot;&#x27;]&quot;;
            }

            var qn, otsitav = msTekst;
            if (thisElement.baseName == &quot;lvt&quot;) { &#x2F;&#x2F; sp_ viide pereliikmele
                qn = DICPR + &quot;:ml&quot;;
                if (vHomTing.length &gt; 0) {
                    &#x2F;&#x2F;lähtutud SP pereliikmete @i, temale viidatakse &lt;lvt&gt; abil;
                    mySqlMsAttCond = &quot; AND atribuudid_&quot; + dic_desc + &quot;.nimi = &#x27;&quot; + DICPR + &quot;:i&#x27;&quot; + &quot; AND atribuudid_&quot; + dic_desc + &quot;.val = &#x27;&quot; + homNrNode.text + &quot;&#x27;&quot; + &quot; AND atribuudid_&quot; + dic_desc + &quot;.elG = elemendid_&quot; + dic_desc + &quot;.elG&quot;;
                }
            } else if (thisElement.baseName == &quot;mstvt&quot;) { &#x2F;&#x2F; its viide mõistele
                qn = DICPR + &quot;:Gmst&quot;;
                otsitav = thisElement.getAttribute(DICPR + &quot;:Gmst&quot;);
            } else {
                qn = qn_ms;
                if ((vHomTing.length &gt; 0)) {
                    mySqlMsAttCond = &quot; AND msid.ms_att_i = &quot; + homNrNode.text;
                }
            }

            if (!otsitav)
                return;

            &#x2F;&#x2F;tuleb märkidega ja tõstutundlik otsing (Liivi-saksas tõstutundetu);
            var srchPtrn = getSrPn2(otsitav, &quot;XML&quot;)

            var elpred, arttingimus, art_xpath, elm_xpath, evPath, pQrySql;
            var withCase, withSymbols;
            withSymbols = &quot;1&quot;;
            withCase = &quot;1&quot;;
            elpred = &quot;[. = &quot; + GCV(otsitav, &quot;&quot;, 2) + &quot;]&quot;;
            if ((dic_desc == &quot;ldw&quot;)) {
                withCase = &quot;0&quot;;
                elpred = &quot;[al_p:srch(.) &gt; 0]&quot;;
            }

            arttingimus = &quot;.&#x2F;&#x2F;&quot; + qn + vHomTing + elpred;
            art_xpath = jsMid(default_query, 0, default_query.indexOf(&quot;&#x2F;&quot;)) + &quot;[&quot; + arttingimus + &quot;]&quot;;
            elm_xpath = arttingimus;
            evPath = &quot;.&#x2F;&#x2F;&quot; + qn + vHomTing + &quot;&#x2F;text()&quot;;

            pQrySql = getSqlQuery(qn, otsitav, true, withSymbols, withCase, evPath, &quot;&quot;, mySqlMsAttCond);

            sCmdId = &quot;ClientRead&quot;;

            var sPrmDomXml, oPrmDom

            showDbgVar(&quot;elpred&quot;, elpred, &quot;HandleViewClick&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date());
            showDbgVar(&quot;arttingimus&quot;, arttingimus, &quot;HandleViewClick&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date());
            showDbgVar(&quot;art_xpath&quot;, art_xpath, &quot;HandleViewClick&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date());
            showDbgVar(&quot;elm_xpath&quot;, elm_xpath, &quot;HandleViewClick&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date());
            showDbgVar(&quot;srchPtrn&quot;, srchPtrn, &quot;HandleViewClick&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date());
            showDbgVar(&quot;pQrySql&quot;, pQrySql, &quot;HandleViewClick&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date());
            showDbgVar(&quot;evPath&quot;, evPath, &quot;HandleViewClick&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date());
            showDbgVar(&quot;qM&quot;, qM, &quot;HandleViewClick&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date())

            sPrmDomXml = &quot;&lt;prm&gt;&quot; +
                            &quot;&lt;cmd&gt;&quot; + sCmdId + &quot;&lt;&#x2F;cmd&gt;&quot; +
                            &quot;&lt;vol&gt;&quot; + sel_Vol.options(sel_Vol.selectedIndex).id + &quot;&lt;&#x2F;vol&gt;&quot; +
                            &quot;&lt;nfo&gt;&quot; + sQryInfo + &quot;&lt;&#x2F;nfo&gt;&quot; +
                            &quot;&lt;axp&gt;&quot; + art_xpath + &quot;&lt;&#x2F;axp&gt;&quot; +
                            &quot;&lt;exp&gt;&quot; + elm_xpath + &quot;&lt;&#x2F;exp&gt;&quot; +
                            &quot;&lt;wC&gt;&quot; + withCase + &quot;&lt;&#x2F;wC&gt;&quot; +
                            &quot;&lt;wS&gt;&quot; + withSymbols + &quot;&lt;&#x2F;wS&gt;&quot; +
                            &quot;&lt;fSrP&gt;&quot; + srchPtrn + &quot;&lt;&#x2F;fSrP&gt;&quot; +
                            &quot;&lt;qn&gt;&quot; + qn + &quot;&lt;&#x2F;qn&gt;&quot; +
                            &quot;&lt;qM&gt;&quot; + qM + &quot;&lt;&#x2F;qM&gt;&quot; +
                            &quot;&lt;pQrySql&gt;&quot; + pQrySql + &quot;&lt;&#x2F;pQrySql&gt;&quot; +
                         &quot;&lt;&#x2F;prm&gt;&quot;;

            oPrmDom = IDD(&quot;String&quot;, sPrmDomXml, false, false, null);
            if ((oPrmDom.parseError.errorCode != 0)) {
                ShowXMLParseError(oPrmDom);
                return;
            }
            StartOperation(oPrmDom)

        }

    } else if ((oSrc.tagName == &quot;SPAN&quot;)) {
        &#x2F;&#x2F;korraliku ID qn pärast;
        if ((oSrc.id.length &gt; 0)) {
            if ((oSrc.id.indexOf(&quot;:&quot;) &gt; -1)) {

                ivde = oSrc;

                ivdebgc = ivde.style.backgroundColor;
                ivde.style.backgroundColor = &quot;silver&quot;

                var oEditObj, edOAttr, oliKinni;
                oEditObj = oEditAll(ivde.id);
                if (oEditObj) {
                    oEditObj.scrollIntoView();
                    divFrameEdit.doScroll(&quot;up&quot;);
                    oEditObj.setActive();
                    oEditObj.focus();
                    trueIfrDocClick = false;
                    oEditObj.click();
                    trueIfrDocClick = true;
                } else {
                    edOAttr = oEditDOM.createNode(NODE_ATTRIBUTE, DICPR + &quot;:edO&quot;, DICURI);
                    edOAttr.value = &quot;1&quot;;
                    oliKinni = false;
                    tNode = thisElement.selectSingleNode(&quot;ancestor::*[@&quot; + DICPR + &quot;:edO = &#x27;0&#x27;]&quot;);
                    while (tNode != null) {
                        tNode.attributes.setNamedItem(edOAttr.cloneNode(true));
                        oliKinni = true;
                        tNode = tNode.selectSingleNode(&quot;ancestor::*[@&quot; + DICPR + &quot;:edO = &#x27;0&#x27;]&quot;);
                    }
                    if (oliKinni) {
                        vaatedRefresh(2);
                        oEditObj = oEditAll(ivde.id);
                        if (oEditObj) {
                            oEditObj.scrollIntoView();
                            divFrameEdit.doScroll(&quot;up&quot;);
                            oEditObj.setActive();
                            oEditObj.focus();
                            trueIfrDocClick = false;
                            oEditObj.click();
                            trueIfrDocClick = true;
                        }
                    }
                }

            }
        }
    } else if ((oSrc.tagName == &quot;IMG&quot;)) {
        if ((oSrc.id == &quot;exit_copy&quot;)) {
            if ((dic_desc == &quot;evs&quot;)) {
                var domCopy;
                domCopy = oEditDOM.cloneNode(true);
                TeisendaDOM(domCopy);
                oViewAll(&quot;ifrviewdiv&quot;).innerHTML = domCopy.transformNode(oXslView);
            } else {
                oViewAll(&quot;ifrviewdiv&quot;).innerHTML = oEditDOM.transformNode(oXslView);
            }
        }
        else {
            window.open(oSrc.src, &#x27;_blank&#x27;);
        }
    }

} &#x2F;&#x2F;HandleViewClick


&#x2F;**
*  
*
* @method HandleViewContextClick
*&#x2F;
function HandleViewContextClick() {
    if ((window.event.ctrlLeft &amp;&amp; window.event.shiftLeft &amp;&amp; window.event.AltLeft)) {
        return;
    }
    window.event.returnValue = false;
} &#x2F;&#x2F;HandleViewContextClick



&#x2F;**
*  Otsinguteksti kasti kontekstmenüü.
*
* @method HandleWindowContextClick
*&#x2F;
function HandleWindowContextClick() {
    var i, cmhtml, smhtml;
    var srcx, srcy, mdivs, mheight;
    var mvh, mvv &#x2F;&#x2F;menüü horis, vertik vahe;
    mvh = 60;
    mvv = 20;

    contextClicked = window.event.srcElement;
    window.event.returnValue = false

    cmhtml = &quot;&quot;;
    cmhtml = cmhtml + insert_symbols.innerHTML;
    if ((cmhtml != &quot;&quot;)) {
        cmhtml = &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;md&#x27;&gt;#text&lt;&#x2F;div&gt;&quot; + cmhtml;
    }
    tn_cmenu.innerHTML = cmhtml;
    if ((tn_cmenu.innerHTML != &quot;&quot;)) {
        if ((window.event.clientX + tn_cmenu.style.pixelWidth + insert_entities.style.pixelWidth + big_character.style.pixelWidth &#x2F; 2 + mvh &gt; window.document.body.clientWidth)) {
            srcx = window.event.screenX - (tn_cmenu.style.pixelWidth + mvh);
        } else {
            srcx = window.event.screenX + mvh;
        }
        mdivs = tn_cmenu.all.tags(&quot;DIV&quot;).length;
        mheight = (mdivs * 16) + 6;
        if ((window.event.clientY + mheight + mvv &gt; window.document.body.clientHeight)) {
            srcy = window.event.screenY - window.screenTop - (mheight + mvv);
        } else {
            srcy = window.event.screenY - window.screenTop + mvv;
        }
        DisplayTNCMenu(srcx, srcy) &#x2F;&#x2F;läheb pixelLeft-i ja pixelTop-i;
    }
} &#x2F;&#x2F;HandleWindowContextClick


&#x2F;&#x2F;
&#x2F;**
*  teksti (textarea) kontekstmenüü
*
* @method HandleContextClick
*&#x2F;
function HandleContextClick() {
    if (window.event.ctrlLeft &amp;&amp; window.event.shiftLeft &amp;&amp; window.event.AltLeft) {
        return;
    }

    window.event.returnValue = false;

    var i, delimwidth, delimline;
    &#x2F;&#x2F;110px &#x2F; 26 kriipsu (55&#x2F;13)~4
    delimwidth = tn_cmenu.style.pixelWidth &#x2F; 16;
    delimline = &quot;&quot;;
    for (i = 0; i &lt; delimwidth; i++) {
        delimline = delimline + EN_DASH;
    }

    var oSrc, cmhtml, smhtml, elc, assembleAndComplete;
    var subelem, thisinfo, tarr;
    var mvh, mvv &#x2F;&#x2F;menüü horis, vertik vahe;
    mvh = 60;
    mvv = 20

    var srcx, srcy, mdivs, mheight, rng;

    oSrc = window.event.srcElement

    &#x2F;&#x2F;parandamisel vaate stiilis:
    &#x2F;&#x2F;entiteedid pannakase kaldkirjas, alakaareke mingi teise (MS Mincho) fondiga;
    &#x2F;&#x2F;hiirega saab pihta ainult &quot;I&quot; - le, &quot;B&quot; - le või &quot;FONT&quot; - ile; osa spane on em teisendustest
    if ((oSrc.tagName == &quot;FONT&quot; || oSrc.tagName == &quot;B&quot; || oSrc.tagName == &quot;I&quot; || oSrc.tagName == &quot;U&quot;)) {
        oSrc = oSrc.parentElement;
    }

    assembleAndComplete = false;

    if (oSrc.tagName == &quot;SPAN&quot; || oSrc.tagName == &quot;LI&quot;) {
        oClicked = oSrc;
        SetVars();
        cmhtml = &quot;&quot;;
        cmenu.innerHTML = cmhtml;
        if (clType == &quot;en&quot; &amp;&amp; !(oXslEdit === oXsl3)) {
            sm_before.innerHTML = &quot;&quot;;
            sm_insert.innerHTML = &quot;&quot;;
            sm_after.innerHTML = &quot;&quot;;
            if (!(snDecl == null || pnDecl == null)) {
                GetSubMenus();
            }
            if (!(sm_before.innerHTML == &quot;&quot;)) {
                sm_before.innerHTML = &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;md&#x27;&gt;&#x27;&quot; + MNU_ADD_BEFORE + &quot;&#x27;&lt;&#x2F;div&gt;&quot; + sm_before.innerHTML;
                cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;add_before&#x27;&gt;&quot; + MNU_ADD_BEFORE + &quot;&lt;&#x2F;div&gt;&quot;;
            }
            if (!(sm_insert.innerHTML == &quot;&quot; || selectedNode.hasChildNodes())) {
                sm_insert.innerHTML = &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;md&#x27;&gt;&#x27;&quot; + MNU_ADD_CHILD + &quot;&#x27;&lt;&#x2F;div&gt;&quot; + sm_insert.innerHTML;
                cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;add_insert&#x27;&gt;&quot; + MNU_ADD_CHILD + &quot;&lt;&#x2F;div&gt;&quot;;
            }
            if (!(sm_after.innerHTML == &quot;&quot;)) {
                sm_after.innerHTML = &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;md&#x27;&gt;&#x27;&quot; + MNU_ADD_AFTER + &quot;&#x27;&lt;&#x2F;div&gt;&quot; + sm_after.innerHTML;
                cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;add_after&#x27;&gt;&quot; + MNU_ADD_AFTER + &quot;&lt;&#x2F;div&gt;&quot;;
            }
            if (snDecl) {
                if (snDecl.type.itemType == SOMITEM_COMPLEXTYPE) {
                    if (snDecl.type.attributes.length &gt; 0) {
                        elc = snDecl.type.attributes.length;
                        smhtml = &quot;&quot;;
                        for (i = 0; i &lt; elc; i++) {
                            subelem = snDecl.type.attributes[i];
                            thisinfo = GetElSchemaInfo(subelem);
                            &#x2F;&#x2F;thisinfo =;
                            &#x2F;&#x2F;qn(0); item.uri(1); typename(item)(2); typename(item.type)(3);;
                            &#x2F;&#x2F;item.type.contentType(4); item.type.name(5); item.minOcc(6);;
                            &#x2F;&#x2F;item.maxOcc(7); kirjeldav(8); item.name(9);
                            tarr = thisinfo.split(&quot;;&quot;);
                            if (selectedNode.attributes.getNamedItem(tarr[0]) == null) {
                                smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; &quot; + &quot;id=&#x27;&quot; + thisinfo + &quot;&#x27; &quot; + &quot;title=&#x27;&quot; + tarr[0] + &quot;&#x27;&gt;&quot; + tarr[8] + &quot; (&quot; + tarr[0] + &quot;)&lt;&#x2F;div&gt;&quot;;
                            }
                            if (subelem.name == &quot;aK&quot; || subelem.name == &quot;aKL&quot; || subelem.name == &quot;aT&quot; || subelem.name == &quot;aTL&quot;) {
                                assembleAndComplete = true;
                            }
                        }
                        sm_attrs.innerHTML = smhtml;
                        if (sm_attrs.innerHTML != &quot;&quot;) {
                            sm_attrs.innerHTML = &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;md&#x27;&gt;&#x27;&quot; + MNU_ADD_ATTRS + &quot;&#x27;&lt;&#x2F;div&gt;&quot; + sm_attrs.innerHTML;
                            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;add_attrs&#x27;&gt;&quot; + MNU_ADD_ATTRS + &quot;&lt;&#x2F;div&gt;&quot;;
                        }
                    }
                }
            }
            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;ren_elem&#x27;&gt;&quot; + MNU_RENAME + &quot;&lt;&#x2F;div&gt;&quot;;
            if ((dic_desc == &quot;sp_&quot;)) {
                if ((clickedNode.baseName == &quot;t&quot;)) {
                    if (!(clickedNode.selectSingleNode(&quot;preceding-sibling::&quot; + DICPR + &quot;:t&quot;) == null)) {
                        cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;incr_indent&#x27;&gt;&quot; + MNU_INCR_INDENT + &quot;&lt;&#x2F;div&gt;&quot;;
                    }
                    if (!(clickedNode.selectSingleNode(&quot;ancestor::&quot; + DICPR + &quot;:t&quot;) == null)) {
                        cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;decr_indent&#x27;&gt;&quot; + MNU_DECR_INDENT + &quot;&lt;&#x2F;div&gt;&quot;;
                    }
                }
            }
        } &#x2F;&#x2F; if (clType == &quot;en&quot; &amp;&amp; !(oXslEdit === oXsl3)) {

        &#x2F;&#x2F;Copy&#x2F;Cut&#x2F;Paste;
        if (clType == &quot;en&quot; || clType == &quot;et&quot; || clType == &quot;ct&quot;) {
            if (cmhtml != &quot;&quot;) {
                cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;dl&#x27; id=&#x27;delim1&#x27;&gt;&quot; + delimline + &quot;&lt;&#x2F;div&gt;&quot;;
            }
            &#x2F;&#x2F;Cut;
            if ((delNodeAllowed() || window.event.shiftLeft)) {
                if ((clType == &quot;en&quot;)) {
                    if ((window.event.ctrlLeft)) {
                        cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;cut_node_add&#x27;&gt;&quot; + MNU_CUT_ADD + &quot;&lt;&#x2F;div&gt;&quot;;
                    } else {
                        cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;cut_node&#x27;&gt;&quot; + MNU_CUT + &quot;&lt;&#x2F;div&gt;&quot;;
                    }
                } else if ((clType == &quot;et&quot; || clType == &quot;ct&quot;)) {
                    if ((clEditable)) {
                        if ((window.event.ctrlLeft)) {
                            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;cut_node_add&#x27;&gt;&quot; + MNU_CUT_ADD + &quot;&lt;&#x2F;div&gt;&quot;;
                        } else {
                            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;cut_node&#x27;&gt;&quot; + MNU_CUT + &quot;&lt;&#x2F;div&gt;&quot;;
                        }
                    }
                }
            }
            &#x2F;&#x2F;Copy;
            if ((window.event.ctrlLeft)) {
                cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;copy_node_add&#x27;&gt;&quot; + MNU_COPY_ADD + &quot;&lt;&#x2F;div&gt;&quot;;
            } else {
                cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;copy_node&#x27;&gt;&quot; + MNU_COPY + &quot;&lt;&#x2F;div&gt;&quot;;
            }
            &#x2F;&#x2F;Paste;
            if ((cpfragment.hasChildNodes)) {
                smhtml = &quot;&quot;;
                if ((clType == &quot;en&quot;)) {
                    smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;paste_node_before&#x27;&gt;&quot; + MNU_PASTE_BEFORE + &quot;&lt;&#x2F;div&gt;&quot;;
                    smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;paste_node_insert&#x27;&gt;&quot; + MNU_PASTE_CHILD + &quot;&lt;&#x2F;div&gt;&quot;;
                    smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;paste_node_insertContent&#x27;&gt;Lisa sisse ainult sisu&lt;&#x2F;div&gt;&quot;;
                    smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;paste_node_after&#x27;&gt;&quot; + MNU_PASTE_AFTER + &quot;&lt;&#x2F;div&gt;&quot;;
                    smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;paste_node_over&#x27;&gt;&quot; + MNU_PASTE_REPLACE + &quot;&lt;&#x2F;div&gt;&quot;;
                } else if ((clType == &quot;et&quot; || clType == &quot;ct&quot;)) {
                    smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;paste_node_before&#x27;&gt;&quot; + MNU_PASTE_BEFORE + &quot;&lt;&#x2F;div&gt;&quot;;
                    smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;paste_node_after&#x27;&gt;&quot; + MNU_PASTE_AFTER + &quot;&lt;&#x2F;div&gt;&quot;;
                    smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;paste_node_over&#x27;&gt;&quot; + MNU_PASTE_REPLACE + &quot;&lt;&#x2F;div&gt;&quot;;
                }
                if ((smhtml != &quot;&quot;)) {
                    paste_node_options.innerHTML = &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;md&#x27;&gt;&#x27;&quot; + MNU_PASTE + &quot;&#x27;&lt;&#x2F;div&gt;&quot; + smhtml;
                    cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;paste_node&#x27;&gt;&quot; + MNU_PASTE + &quot;&lt;&#x2F;div&gt;&quot;;
                }
            }
        }
        &#x2F;&#x2F;Delete;
        if (clType == &quot;en&quot; || clType == &quot;et&quot; || clType == &quot;ct&quot; || clType == &quot;at&quot;) {
            if (delNodeAllowed() || window.event.shiftLeft) {
                if (cmhtml != &quot;&quot;) {
                    cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;dl&#x27; id=&#x27;delim3&#x27;&gt;&quot; + delimline + &quot;&lt;&#x2F;div&gt;&quot;;
                }
                cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;del_self&#x27;&gt;&quot; + MNU_DELETE + &quot;&lt;&#x2F;div&gt;&quot;;
            }
        }
        &#x2F;&#x2F;ava kopeerimiseks, lisa XML kommentaar, morf analüüs ja süntees, hulgiparandused, morfofon;
        if (clType == &quot;en&quot;) {
            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;dl&#x27; id=&#x27;delim4&#x27;&gt;&quot; + delimline + &quot;&lt;&#x2F;div&gt;&quot;;
            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;open_for_copy&#x27;&gt;&quot; + MNU_OPEN_FORCOPY + &quot;&lt;&#x2F;div&gt;&quot;;
            &#x2F;&#x2F;     cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;comment_this&#x27;&gt;&quot; + MNU_ADD_XMLCOMMENT + &quot;&lt;&#x2F;div&gt;&quot;
            if (useMorfo) {
                cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;morf_ana&#x27;&gt;&quot; + NAME_MORF_ANA + &quot;&lt;&#x2F;div&gt;&quot;;
                if (selectedNode.baseName == &quot;m&quot; || selectedNode.baseName == &quot;mf&quot;) {
                    cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;morf_syn&#x27;&gt;&quot; + NAME_MORF_SYN + &quot;&lt;&#x2F;div&gt;&quot;;
                }
                if (selectedNode.baseName == &quot;mv&quot; || selectedNode.baseName == &quot;vormid&quot;) {
                    cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;morf_syn_asenda&#x27;&gt;&quot; + NAME_MORF_SYN_ASENDA + &quot;&lt;&#x2F;div&gt;&quot;;
                }
            }
            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;openFindReplace&#x27;&gt;&quot; + MNU_OPEN_FIND_REPLACE + &quot;&lt;&#x2F;div&gt;&quot;;
            if (assembleAndComplete) { &#x2F;&#x2F; kui klõpsatul on olemas atribuudid aK, aKL, aT, aTL
                &#x2F;&#x2F;assemble &amp;&amp; complete;
                if (document.body.all(&quot;aacContMenu&quot;) == null) {
                    var aacContMenu = document.body.appendChild(document.createElement(&quot;&lt;DIV id=&#x27;aacContMenu&#x27; style=&#x27;display:none;position:absolute;width:300px;background-color:menu;border:outset 3px gray;onmouseover=\&quot;SwitchCMenu()\&quot; onmouseout=\&quot;SwitchCMenu()\&quot; onclick=\&quot;ClickCMenu()\&quot; oncontextmenu=\&quot;DisableContextMenu()\&quot; onlosecapture=\&quot;HideDivMenu()\&quot;&#x27;&gt;&lt;&#x2F;DIV&gt;&quot;));
                    aacContMenu.innerHTML = &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;md&#x27;&gt;&#x27;Koostamise&#x2F;toimetamise märked&#x27;&lt;&#x2F;div&gt;&quot; + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;addAssembleComplete&#x27;&gt;Lisa grupile koostamise lõpu märge&lt;&#x2F;div&gt;&quot; + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;remAssembleComplete&#x27;&gt;Eemalda grupilt koostamise lõpu märge&lt;&#x2F;div&gt;&quot;;
                }
                cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;assembleAndComplete&#x27;&gt;Koostamise&#x2F;toimetamise märked&lt;&#x2F;div&gt;&quot;;
            }
            &#x2F;&#x2F; morfofonoloogiline info
            if (selectedNode.baseName == &quot;mg&quot;) {
                cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;morfofonInfo&#x27;&gt;Morfofonoloogiline info&lt;&#x2F;div&gt;&quot;;
            }
            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;guuglisse&#x27;&gt;Guuglisse&lt;&#x2F;div&gt;&quot;;
            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;extLinks&#x27;&gt;Välised lingid&lt;&#x2F;div&gt;&quot;;
        }
        &#x2F;&#x2F; pealkiri
		&#x2F;&#x2F; ======================================================================================================
		&#x2F;&#x2F; ats+++  (16.11.2012&#x2F;16.11.2012)
		&#x2F;&#x2F; ======================================================================================================
		if (atsOnViit(selectedNode.nodeName))
		{
		  if (cmhtml != &quot;&quot;) {
			cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;dl&#x27; id=&#x27;delim3&#x27;&gt;&quot; + delimline + &quot;&lt;&#x2F;div&gt;&quot;;
		  }
		  cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;viitcontrol&#x27;&gt;&quot; + &quot;Viite kontroll&quot; + &quot;&lt;&#x2F;div&gt;&quot;;
		}
		&#x2F;&#x2F;ats

        if (cmhtml != &quot;&quot;) {
            cmhtml = &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;md&#x27; title=&#x27;&quot; + snQName + &quot;&#x27;&gt;&quot; + cmHeading + &quot;&lt;&#x2F;div&gt;&quot; + cmhtml;
        }
        cmenu.innerHTML = cmhtml;
        if (cmenu.innerHTML != &quot;&quot;) {
            srcx = tbl_XML.offsetLeft + oEditAll(&quot;ifrdiv&quot;).offsetLeft + window.event.clientX;
            mdivs = cmenu.all.tags(&quot;DIV&quot;).length;
            mheight = (mdivs * 16) + 6;
            if ((window.event.clientY + mheight + mvv &gt; document.body.clientHeight)) {
                srcy = window.event.screenY - window.screenTop - (mheight + mvv);
            } else {
                srcy = window.event.screenY - window.screenTop + mvv;
            }
            DisplayCMenu(srcx, srcy);
        }
    } else if (oSrc.id == &quot;oClickedTextArea&quot;) {
        contextClicked = oSrc;
        cmhtml = &quot;&quot;;
        tn_cmenu.innerHTML = cmhtml

        rng = document.selection.createRange();
        if ((rng.text.length == 0)) {
            if (!(snDecl == null)) {
                if ((snDecl.type.itemType == SOMITEM_COMPLEXTYPE)) {
                    if ((snDecl.type.contentType == SCHEMACONTENTTYPE_MIXED)) {
                        GetTNSubMenus();
                        if ((tn_sm_before.innerHTML != &quot;&quot;)) {
                            tn_sm_before.innerHTML = &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;md&#x27;&gt;&#x27;&quot; + MNU_ADD_BEFORE + &quot;&#x27;&lt;&#x2F;div&gt;&quot; + tn_sm_before.innerHTML;
                            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;tn_add_before&#x27;&gt;&quot; + MNU_ADD_BEFORE + &quot;&lt;&#x2F;div&gt;&quot;;
                        }
                        if ((tn_sm_insert.innerHTML != &quot;&quot;)) {
                            tn_sm_insert.innerHTML = &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;md&#x27;&gt;&#x27;&quot; + MNU_ADD_CHILD + &quot;&#x27;&lt;&#x2F;div&gt;&quot; + tn_sm_insert.innerHTML;
                            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;tn_add_insert&#x27;&gt;&quot; + MNU_ADD_CHILD + &quot;&lt;&#x2F;div&gt;&quot;;
                        }
                        if ((tn_sm_after.innerHTML != &quot;&quot;)) {
                            tn_sm_after.innerHTML = &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;md&#x27;&gt;&#x27;&quot; + MNU_ADD_AFTER + &quot;&#x27;&lt;&#x2F;div&gt;&quot; + tn_sm_after.innerHTML;
                            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;tn_add_after&#x27;&gt;&quot; + MNU_ADD_AFTER + &quot;&lt;&#x2F;div&gt;&quot;;
                        }
                        if ((cmhtml != &quot;&quot;)) {
                            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;dl&#x27; id=&#x27;delim5&#x27;&gt;&quot; + delimline + &quot;&lt;&#x2F;div&gt;&quot;;
                        }
                        cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;del_tn&#x27;&gt;&quot; + MNU_DELETE + &quot;&lt;&#x2F;div&gt;&quot;;
                    }
                }
            }
        }
        if ((cmhtml != &quot;&quot;)) {
            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;dl&#x27; id=&#x27;delim6&#x27;&gt;&quot; + delimline + &quot;&lt;&#x2F;div&gt;&quot;;
        }
        cmhtml = cmhtml + insert_symbols.innerHTML;
        if (!(oViewAll(&quot;_copyDiv&quot;) == null)) {
            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;add_copied&#x27;&gt;&quot; + MNU_ADD + &quot; &#x27;&quot; + sTextToCopy + &quot;&#x27;&lt;&#x2F;div&gt;&quot;;
        }
        if ((rng.text.length &gt; 0)) {
            if ((cmhtml != &quot;&quot;)) {
                cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;dl&#x27; id=&#x27;delim7&#x27;&gt;&quot; + delimline + &quot;&lt;&#x2F;div&gt;&quot;;
            }
            cmhtml = cmhtml + &quot;&lt;div style=&#x27;width:100%&#x27; id=&#x27;editCmds&#x27;&gt;&quot; + &quot;&lt;b&gt;&lt;span class=&#x27;mi_span&#x27; id=&#x27;switch_Bold&#x27; title=&#x27;Poolpaks&#x27; value=&#x27;&amp;ba;&#x27;&gt;B&lt;&#x2F;span&gt;&lt;&#x2F;b&gt;&quot; + &quot;&lt;b&gt;&lt;i&gt;&lt;span class=&#x27;mi_span&#x27; id=&#x27;switch_Emph&#x27; title=&#x27;Esiletõstetud&#x27; value=&#x27;&amp;ema;&#x27;&gt;I&lt;&#x2F;span&gt;&lt;&#x2F;i&gt;&lt;&#x2F;b&gt;&quot; + &quot;&lt;b&gt;&lt;u&gt;&lt;span class=&#x27;mi_span&#x27; id=&#x27;switch_Underl&#x27; title=&#x27;Allajoonitud&#x27; value=&#x27;&amp;la;&#x27;&gt;U&lt;&#x2F;span&gt;&lt;&#x2F;u&gt;&lt;&#x2F;b&gt;&quot; + &quot;&lt;span class=&#x27;mi_span&#x27; id=&#x27;switch_SubScr&#x27; title=&#x27;Alaindeks&#x27; value=&#x27;&amp;suba;&#x27;&gt;X&lt;sub&gt;n&lt;&#x2F;sub&gt;&lt;&#x2F;span&gt;&quot; + &quot;&lt;span class=&#x27;mi_span&#x27; id=&#x27;switch_SupScr&#x27; title=&#x27;Ülaindeks&#x27; value=&#x27;&amp;supa;&#x27;&gt;X&lt;sup&gt;n&lt;&#x2F;sup&gt;&lt;&#x2F;span&gt;&quot; + &quot;&lt;&#x2F;div&gt;&quot;;
        }
        if ((cmhtml != &quot;&quot;)) {
            cmhtml = &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;md&#x27;&gt;#text&lt;&#x2F;div&gt;&quot; + cmhtml;
        }
        tn_cmenu.innerHTML = cmhtml;
        if ((tn_cmenu.innerHTML != &quot;&quot;)) {
            srcx = tbl_XML.offsetLeft + oEditAll(&quot;ifrdiv&quot;).offsetLeft + window.event.clientX;
            mdivs = tn_cmenu.all.tags(&quot;DIV&quot;).length;
            mheight = (mdivs * 16) + 6;
            if ((window.event.screenY - window.screenTop &lt; mheight + mvv)) {
                srcy = window.event.screenY - window.screenTop + mvv;
            } else {
                srcy = window.event.screenY - window.screenTop - (mheight + mvv);
            }
            DisplayTNCMenu(srcx, srcy) &#x2F;&#x2F;läheb pixelLeft-i ja pixelTop-i;
        }
    }
} &#x2F;&#x2F;HandleContextClick


&#x2F;**
* 
*
* @method GetSubMenus
*&#x2F;
function GetSubMenus() {
    var prevqn, nextqn

    prevqn = &quot;&quot;;
    nextqn = &quot;&quot;

    var tnode
    tnode = selectedNode.selectSingleNode(&quot;preceding-sibling::*[1]&quot;);
    if (!(tnode == null)) {
        prevqn = tnode.nodeName;
    }
    tnode = selectedNode.selectSingleNode(&quot;following-sibling::*[1]&quot;);
    if (!(tnode == null)) {
        nextqn = tnode.nodeName;
    }

    var pnqn;
    pnqn = fatherNode.nodeName

    var fparticle
    fparticle = pnDecl.type.contentModel.particles[0]

    var frdoc, anynames, chcount, chmax, smhtml, subelems, subelem, i, tarr

    &#x2F;&#x2F;GetElSchemaInfo =
    &#x2F;&#x2F;qn(0); item.uri(1); typename(item)(2); typename(item.type)(3);
    &#x2F;&#x2F;item.type.contentType(4); item.type.name(5); item.minOcc(6);
    &#x2F;&#x2F;item.maxOcc(7); kirjeldav(8); item.name(9)

    if ((fparticle.itemType == SOMITEM_ANY)) {
        frdoc = IDD(&quot;file&quot;, &quot;xml&#x2F;&quot; + dic_desc + &quot;&#x2F;aa_&quot; + unName(pnqn) + &quot;.xml&quot;, false, false, null);
        if ((frdoc.parseError.errorCode != 0)) {
            return;
        }
        anynames = frdoc.documentElement.text.split(&quot;|&quot;);
        chcount = XMLChildTagsCount(fatherNode, &quot;*&quot;);
        chmax = parseInt(fparticle.maxOccurs);
        smhtml = &quot;&quot;;
        if ((chmax == -1 || chcount &lt; chmax)) {
            subelems = new Array(anynames.length);
            for (i = 0; i &lt; anynames.length; i++) {
                subelem = oSchRootElems.itemByQName(jsMid(anynames[i], anynames[i].indexOf(&quot;:&quot;) + 1), oXmlNsm.getURI(jsMid(anynames[i], 0, anynames[i].indexOf(&quot;:&quot;))));
                subelems[i] = GetElSchemaInfo(subelem);
                tarr = subelems[i].split(&quot;;&quot;);
                smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; &quot; + &quot;id=&#x27;&quot; + subelems[i] + &quot;&#x27; &quot; + &quot;title=&#x27;&quot; + tarr[0] + &quot;&#x27;&gt;&quot; + tarr[8] + &quot; (&quot; + tarr[0] + &quot;)&lt;&#x2F;div&gt;&quot;;
            }
            sm_before.innerHTML = smhtml;
            sm_after.innerHTML = smhtml;
        }
    } else {
        var pncount;
        pncount = pnDecl.type.contentModel.particles.length;
        subelems = new Array(pncount);

        var subqn, elbefind, elselfind, elaftind

        elbefind = 0;
        elselfind = -1;
        elaftind = pncount - 1;
        for (i = 0; i &lt; pncount; i++) {
            subelem = pnDecl.type.contentModel.particles[i];
            subelems[i] = GetElSchemaInfo(subelem);
            subqn = oXmlNsm.getPrefixes(subelem.namespaceURI).item(0) + &quot;:&quot; + subelem.name;
            if ((subqn == prevqn)) {
                elbefind = i;
            }
            if ((subqn == nextqn)) {
                elaftind = i;
            }
            if ((subqn == selectedNode.nodeName)) {
                elselfind = i;
            }
        }
        smhtml = &quot;&quot;;
        for (i = elbefind; i &lt;= elselfind; i++) {
            tarr = subelems[i].split(&quot;;&quot;);
            chcount = XMLChildTagsCount(fatherNode, tarr[0]);
            chmax = parseInt(tarr[7]);
            if ((chmax == -1 || chcount &lt; chmax)) {
                smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; &quot; + &quot;id=&#x27;&quot; + subelems[i] + &quot;&#x27; &quot; + &quot;title=&#x27;&quot; + tarr[0] + &quot;&#x27;&gt;&quot; + tarr[8] + &quot; (&quot; + tarr[0] + &quot;)&lt;&#x2F;div&gt;&quot;;
            }
        }
        sm_before.innerHTML = smhtml;
        smhtml = &quot;&quot;;
        &#x2F;&#x2F;kui element on vales kohas (nt impordi tõttu);
        if ((elselfind &gt; -1)) {
            for (i = elselfind; i &lt;= elaftind; i++) {
                tarr = subelems[i].split(&quot;;&quot;);
                chcount = XMLChildTagsCount(fatherNode, tarr[0]);
                chmax = parseInt(tarr[7]);
                if ((chmax == -1 || chcount &lt; chmax)) {
                    smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; &quot; + &quot;id=&#x27;&quot; + subelems[i] + &quot;&#x27; &quot; + &quot;title=&#x27;&quot; + tarr[0] + &quot;&#x27;&gt;&quot; + tarr[8] + &quot; (&quot; + tarr[0] + &quot;)&lt;&#x2F;div&gt;&quot;;
                }
            }
        }
        sm_after.innerHTML = smhtml;
    }

    prevqn = &quot;&quot;
    tnode = selectedNode.previousSibling;
    if (!(tnode == null)) {
        prevqn = tnode.nodeName;
    }
    nextqn = &quot;&quot;
    tnode = selectedNode.nextSibling;
    if (!(tnode == null)) {
        nextqn = tnode.nodeName;
    }

    var dokpath, doku, kirjeldav

    if ((pnDecl.type.contentType == SCHEMACONTENTTYPE_MIXED)) {
        dokpath = &quot;.&#x2F;&#x2F;&quot; + NS_XS_PR + &quot;:element[@name=&#x27;&quot; + pnDecl.name + &quot;&#x27;]&#x2F;&quot; + NS_XS_PR + &quot;:annotation&#x2F;&quot; + NS_XS_PR + &quot;:documentation[@xml:lang=&#x27;&quot; + sAppLang + &quot;&#x27;]&quot;;
        doku = oXsdDOM.documentElement.selectSingleNode(dokpath);
        if (!(doku == null)) {
            kirjeldav = jsReplace(jsTrim(doku.text), &quot;;&quot;, &quot;&quot;);
        } else {
            kirjeldav = pnqn;
        }
        if (!(prevqn == &quot;#text&quot;)) {
            smhtml = &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; &quot; + &quot;id=&#x27;#text&#x27; &quot; + &quot;title=&#x27;#text&#x27;&gt;&#x27;&quot; + kirjeldav + &quot;&#x27; (&quot; + pnqn + &quot;) #tekst&lt;&#x2F;div&gt;&quot;;
            sm_before.innerHTML = sm_before.innerHTML + smhtml;
        }
        if (!(nextqn == &quot;#text&quot;)) {
            smhtml = &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; &quot; + &quot;id=&#x27;#text&#x27; &quot; + &quot;title=&#x27;#text&#x27;&gt;&#x27;&quot; + kirjeldav + &quot;&#x27; (&quot; + pnqn + &quot;) #tekst&lt;&#x2F;div&gt;&quot;;
            sm_after.innerHTML = sm_after.innerHTML + smhtml;
        }
    }

    var thisinfo;
    if ((snDecl.type.itemType == SOMITEM_COMPLEXTYPE)) {
        if ((snDecl.type.contentModel.particles.length &gt; 0)) {
            smhtml = &quot;&quot;;
            fparticle = snDecl.type.contentModel.particles[0];
            pnqn = snQName;
            if ((fparticle.itemType == SOMITEM_ANY)) {
                frdoc = IDD(&quot;file&quot;, &quot;xml&#x2F;&quot; + dic_desc + &quot;&#x2F;aa_&quot; + unName(pnqn) + &quot;.xml&quot;, false, false, null);
                if ((frdoc.parseError.errorCode != 0)) {
                    return;
                }
                anynames = frdoc.documentElement.text.split(&quot;|&quot;);
                for (i = 0; i &lt; anynames.length; i++) {
                    subelem = oSchRootElems.itemByQName(jsMid(anynames[i], anynames[i].indexOf(&quot;:&quot;) + 1), oXmlNsm.getURI(jsMid(anynames[i], 0, anynames[i].indexOf(&quot;:&quot;))));
                    thisinfo = GetElSchemaInfo(subelem);
                    tarr = thisinfo.split(&quot;;&quot;);
                    smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; &quot; + &quot;id=&#x27;&quot; + thisinfo + &quot;&#x27; &quot; + &quot;title=&#x27;&quot; + tarr[0] + &quot;&#x27;&gt;&quot; + tarr[8] + &quot; (&quot; + tarr[0] + &quot;)&lt;&#x2F;div&gt;&quot;;
                }
            } else {
                pncount = snDecl.type.contentModel.particles.length;
                for (i = 0; i &lt; pncount; i++) {
                    subelem = snDecl.type.contentModel.particles[i];
                    thisinfo = GetElSchemaInfo(subelem);
                    tarr = thisinfo.split(&quot;;&quot;);
                    smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; &quot; + &quot;id=&#x27;&quot; + thisinfo + &quot;&#x27; &quot; + &quot;title=&#x27;&quot; + tarr[0] + &quot;&#x27;&gt;&quot; + tarr[8] + &quot; (&quot; + tarr[0] + &quot;)&lt;&#x2F;div&gt;&quot;;
                }
            }
            if ((snDecl.type.contentType == SCHEMACONTENTTYPE_MIXED)) {
                smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; &quot; + &quot;id=&#x27;#text&#x27; &quot; + &quot;title=&#x27;#text&#x27;&gt;&#x27;&quot; + snKirjeldavQName + &quot;&#x27; #tekst&lt;&#x2F;div&gt;&quot;;
            }
            sm_insert.innerHTML = smhtml;
        }
    }
} &#x2F;&#x2F;GetSubMenus


&#x2F;**
* 
*
* @method GetElSchemaInfo
* @param {Object} thisitem
* @returns {String}
*&#x2F;
function GetElSchemaInfo(thisitem) {
    var thisinfo, qn, dokpath, doku, kirjeldav;

    thisinfo = &quot;&quot;;
    dokpath = &quot;&quot;;

    if ((thisitem.itemType == SOMITEM_ELEMENT)) {
        qn = oXmlNsm.getPrefixes(thisitem.namespaceURI).item(0) + &quot;:&quot; + thisitem.name;
        if ((thisitem.type.itemType == SOMITEM_COMPLEXTYPE)) {
            thisinfo = qn + &quot;;&quot; + thisitem.namespaceURI + &quot;;&quot; + thisitem.itemType + &quot;;&quot; + thisitem.type.itemType + &quot;;&quot; + thisitem.type.contentType + &quot;;&quot; + thisitem.type.name + &quot;;&quot; + thisitem.minOccurs + &quot;;&quot; + thisitem.maxOccurs;
        } else {
            &#x2F;&#x2F; if ((thisitem.type.itemType == SOMITEM_SIMPLETYPE))
            thisinfo = qn + &quot;;&quot; + thisitem.namespaceURI + &quot;;&quot; + thisitem.itemType + &quot;;&quot; + thisitem.type.itemType + &quot;;&quot; + &quot;;&quot; + thisitem.type.name + &quot;;&quot; + thisitem.minOccurs + &quot;;&quot; + thisitem.maxOccurs;
        }
        dokpath = &quot;.&#x2F;&#x2F;&quot; + NS_XS_PR + &quot;:element[@name=&#x27;&quot; + thisitem.name + &quot;&#x27;]&#x2F;&quot; + NS_XS_PR + &quot;:annotation&#x2F;&quot; + NS_XS_PR + &quot;:documentation[@xml:lang=&#x27;&quot; + sAppLang + &quot;&#x27;]&quot;;
    } else if ((thisitem.itemType == SOMITEM_ATTRIBUTE)) {
        qn = oXmlNsm.getPrefixes(thisitem.namespaceURI).item(0) + &quot;:&quot; + thisitem.name;
        thisinfo = qn + &quot;;&quot; + thisitem.namespaceURI + &quot;;&quot; + thisitem.itemType + &quot;;&quot; + thisitem.type.itemType + &quot;;&quot; + thisitem.type.derivedBy + &quot;;&quot; + thisitem.type.baseTypes.length + &quot;;&quot; + thisitem.type.enumeration.length + &quot;;&quot; + thisitem.use;
        dokpath = &quot;.&#x2F;&#x2F;&quot; + NS_XS_PR + &quot;:attribute[@name=&#x27;&quot; + thisitem.name + &quot;&#x27;]&#x2F;&quot; + NS_XS_PR + &quot;:annotation&#x2F;&quot; + NS_XS_PR + &quot;:documentation[@xml:lang=&#x27;&quot; + sAppLang + &quot;&#x27;]&quot;;
    }
    doku = oXsdDOM.documentElement.selectSingleNode(dokpath);
    if (!(doku == null)) {
        kirjeldav = jsReplace(jsTrim(doku.firstChild.nodeValue), &quot;;&quot;, &quot;&quot;);
    } else {
        kirjeldav = qn;
    }
    thisinfo = thisinfo + &quot;;&quot; + kirjeldav + &quot;;&quot; + thisitem.name;
    return thisinfo;
} &#x2F;&#x2F;GetElSchemaInfo


&#x2F;**
* 
*
* @method delNodeAllowed
* @returns {Boolean}
*&#x2F;
function delNodeAllowed() {
    var delNodeAllowed;
    if (snDecl == null || pnDecl == null) {
        return true;
    }
    if (clType == &quot;en&quot;) {
        var fparticle;
        fparticle = pnDecl.type.contentModel.particles[0]

        var chcount, chmin;
        if (fparticle.itemType == SOMITEM_ANY) {
            chcount = XMLChildTagsCount(fatherNode, &quot;*&quot;);
            chmin = parseInt(fparticle.minOccurs);
        } else {
            chcount = XMLChildTagsCount(fatherNode, selectedNode.nodeName);
            &#x2F;&#x2F;     &#x27;Järgnev on MSXML6 korral alati = 1, MSXML4-s veel töötas
            &#x2F;&#x2F;     chmin = parseInt(snDecl.minOccurs)
            try {
                chmin = parseInt(pnDecl.type.contentModel.particles.itemByName(snDecl.name).minOccurs);
            }
            catch (e) {
                &#x2F;&#x2F;nt kui pnDecl sees pole snDecl-it ette nähtud;
                chmin = 0;
            }
        }
        if (chcount &gt; chmin) {
            delNodeAllowed = true;
        } else {
            delNodeAllowed = false;
        }
    } else if (clType == &quot;et&quot;) {
        if (selectedNode.childNodes.length &gt; 1) {
            delNodeAllowed = true;
        } else {
            delNodeAllowed = false;
        }
    } else if (clType == &quot;at&quot;) {
        if (snDecl.use == SCHEMAUSE_REQUIRED) {
            delNodeAllowed = false;
        } else {
            var attrNoEditOtsitav;
            if (neAttribs.indexOf(&quot;&#x2F;&quot;) &gt; -1) {
                attrNoEditOtsitav = fatherNode.nodeName + &quot;&#x2F;@&quot; + selectedNode.nodeName;
            } else {
                attrNoEditOtsitav = selectedNode.nodeName;
            }
            if (neAttribs.indexOf(&quot;;&quot; + attrNoEditOtsitav + &quot;;&quot;) &gt; -1) {
                delNodeAllowed = false;
            } else {
                delNodeAllowed = true;
            }
        }
    } else if (clType == &quot;ct&quot;) {
        delNodeAllowed = true;
    } else {
        delNodeAllowed = false;
    }
    return delNodeAllowed;
} &#x2F;&#x2F;delNodeAllowed


&#x2F;**
* Kuvab menüü määratud kohta.
*
* @method DisplayCMenu
* @param {Int} posx
* @param {Int} posy
*&#x2F;
function DisplayCMenu(posx, posy) {
    cmenu.style.pixelLeft = posx;
    cmenu.style.pixelTop = posy;
    cmenu.style.display = &quot;&quot;;
    cmenu.style.cursor = &quot;default&quot;;
    cmenu.setCapture();
} &#x2F;&#x2F;DisplayCMenu


&#x2F;**
* 
*
* @method ClickCMenu
*&#x2F;
function ClickCMenu() {
    var cmel;

    cmel = window.event.srcElement;
    &#x2F;&#x2F;peamenüü (cmenu sees div-id)
    &#x2F;&#x2F;&quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;add_before&#x27;&gt;Lisa ette&lt;&#x2F;div&gt;&quot;
    &#x2F;&#x2F;&quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;add_insert&#x27;&gt;Lisa sisse&lt;&#x2F;div&gt;&quot;
    &#x2F;&#x2F;&quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;add_after&#x27;&gt;Lisa järele&lt;&#x2F;div&gt;&quot;
    &#x2F;&#x2F;&quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;add_attrs&#x27;&gt;Lisa tunnus&lt;&#x2F;div&gt;&quot;
    &#x2F;&#x2F;&quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;cut_node&#x27;&gt;Lõika üksus&lt;&#x2F;div&gt;&quot;
    &#x2F;&#x2F;&quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;copy_node&#x27;&gt;Kopeeri üksus&lt;&#x2F;div&gt;&quot;
    &#x2F;&#x2F;&quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;paste_node&#x27;&gt;Kleebi üksus&lt;&#x2F;div&gt;&quot;
    &#x2F;&#x2F;&quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;del_self&#x27;&gt;Kustuta&lt;&#x2F;div&gt;&quot;
    &#x2F;&#x2F;&quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; id=&#x27;comment_this&#x27;&gt;Lisa kommentaar&lt;&#x2F;div&gt;&quot;

    if ((cmel.className == &quot;dl&quot; || cmel.className == &quot;md&quot;)) {
        return;
    }

    &#x2F;&#x2F;klõps põhimenüüs
    if (cmel.parentElement.id == &quot;cmenu&quot;) {
        if (openmenuid == &quot;&quot;) {
            if (cmel.className == &quot;hi&quot;) {
                cmel.className = &quot;mi&quot;;
            } else if (cmel.className == &quot;hi_span&quot;) {
                cmel.className = &quot;mi_span&quot;;
            }
            document.releaseCapture();
        }
        &#x2F;&#x2F;klõps alammenüüdes või üldse suvalises kohas
    } else {
        if (cmel.className == &quot;hi&quot;) {
            cmel.className = &quot;mi&quot;;
        } else if (cmel.className == &quot;hi_span&quot;) {
            cmel.className = &quot;mi_span&quot;;
        }
        document.releaseCapture();
    }

    var norm_elem, newnode, backupnode, refNode, tval, dfr, pasteFragment, pasteCheck;

    norm_elem = null;
    refNode = null;

    var tarr, i;
    var sqna, tulemus;
    var smdArgs, retVal;

    var domCopy, asuKoht;

    &#x2F;&#x2F;kontrolli morfo uuendusi ...
    if (cmel.id == &quot;morf_ana&quot; || cmel.id == &quot;morf_syn&quot; || cmel.id == &quot;morf_syn_asenda&quot;) {
        if (!checkRpmUpdates()) {
            return;
        }
    }

    var sisuTekstid, sisuTekst, yldStruNode;

    &#x2F;&#x2F;kommenteerimine ning ette, sisse, järele, atribuudid alammenüüd:
    &#x2F;&#x2F;sm_before, sm_after, sm_insert, sm_attrs
    if (cmel.id == &quot;comment_this&quot; || jsLeft(cmel.parentElement.id, 3) == &quot;sm_&quot;) { &#x2F;&#x2F;&#x27;elemendi nimi: clType = &quot;en&quot;
        norm_elem = fatherNode;
        if (cmel.id == &quot;comment_this&quot;) {
            tval = prompt(&quot;Sisesta kommentaar!&quot;);
            if (tval == &quot;&quot;) {
                return;
            }
            newnode = oEditDOM.createNode(NODE_COMMENT, &quot;&quot;, &quot;&quot;);
            newnode.text = tval;
            norm_elem.insertBefore(newnode, selectedNode);
        } else if (jsLeft(cmel.parentElement.id, 3) == &quot;sm_&quot;) { &#x2F;&#x2F;&#x27;ette, sisse, järele, atribuudid;
            &#x2F;&#x2F;sm_*: cmel.id:;
            &#x2F;&#x2F;= qn(0); item.uri(1); typename(item)(2); typename(item.type)(3);;
            &#x2F;&#x2F;item.type.contentType(4); item.type.name(5); item.minOcc(6);;
            &#x2F;&#x2F;item.maxOcc(7); kirjeldav(8); item.name(9);
            &#x2F;&#x2F;= #text;
            tarr = cmel.id.split(&quot;;&quot;);
            if (cmel.parentElement.id == &quot;sm_attrs&quot;) { &#x2F;&#x2F;&#x27;atribuudid;
                if (yldStruDom.documentElement.getAttribute(&quot;pr_sd:ver&quot;) == &quot;2.0&quot;) {
                    yldStruNode = yldStruDom.selectSingleNode(&quot;.&#x2F;&#x2F;&quot; + selectedNode.nodeName);
                    var lisatavAttr = yldStruNode.attributes.getNamedItem(tarr[0]);
                    selectedNode.attributes.setNamedItem(oEditDOM.importNode(lisatavAttr, true));
                }
                else {
                    selectedNode.attributes.setNamedItem(oEditDOM.createNode(NODE_ATTRIBUTE, tarr[0], tarr[1]));
                }
            } else { &#x2F;&#x2F;ette, sisse, järele;
                if (tarr[0] == &quot;#text&quot;) {
                    newnode = oEditDOM.createNode(NODE_TEXT, &quot;&quot;, &quot;&quot;);
                    &#x2F;&#x2F;MIDAGI PEAB PANEMA, muidu fataalne viga MSXML4 - s;
                    newnode.text = &quot;&quot;;
                } else { &#x2F;&#x2F;elemendid;
                    if (yldStruDom.documentElement.getAttribute(&quot;pr_sd:ver&quot;) == &quot;2.0&quot;) {
                        newnode = oEditDOM.createNode(NODE_ELEMENT, tarr[0], tarr[1]);
                        yldStruNode = yldStruDom.selectSingleNode(&quot;.&#x2F;&#x2F;&quot; + tarr[0]);
                        getMajors(yldStruNode, newnode);
                    }
                    else {
                        newnode = GetAddElementFromFile(tarr[0], tarr[1]);
                    }
                }
                if (cmel.parentElement.id == &quot;sm_before&quot;) {
                    newnode = fatherNode.insertBefore(newnode, selectedNode);
                } else if (cmel.parentElement.id == &quot;sm_insert&quot;) {
                    newnode = selectedNode.insertBefore(newnode, null);
                } else if (cmel.parentElement.id == &quot;sm_after&quot;) {
                    newnode = fatherNode.insertBefore(newnode, selectedNode.nextSibling);
                }
                AddGruppChecks(newnode);  &#x2F;&#x2F; n&#x2F;@nrl, tähendusnumbrite ümberarvutused;
            }
        }
        norm_elem.normalize();
        setATTAPlokid(norm_elem);
        vaatedRefresh(2);
    } else if (cmel.id == &quot;ren_elem&quot;) { &#x2F;&#x2F;&#x27;elemendi nimi: clType = &quot;en&quot;;
        &#x2F;&#x2F;prompt(: prompt, default)
        tval = prompt(snKirjeldavQName + &#x27;\r\n\r\n&#x27; + DLG_GET_ELEM_NAME, selectedNode.nodeName);
        if (tval == &quot;&quot; || tval == selectedNode.nodeName) {
            return;
        }
        norm_elem = fatherNode;
        &#x2F;&#x2F;        backupnode = norm_elem.cloneNode(true);
        dfr = oEditDOM.createDocumentFragment();
        var newNoded = selectedNode.childNodes;
        for (i = 0; i &lt; newNoded.length; i++) {
            var newNode = newNoded[i];
            dfr.appendChild(newNode.cloneNode(true));
        }
        newnode = oEditDOM.createNode(NODE_ELEMENT, tval, DICURI);
        if (window.event.ctrlLeft) {
            var oAttrs = selectedNode.Attributes;
            for (i = 0; i &lt; oAttrs.length; i++) {
                var oAttr = oAttrs[i];
                newnode.Attributes.setNamedItem(oAttr.cloneNode(true));
            }
        }
        newnode.appendChild(dfr);
        norm_elem.replaceChild(newnode, selectedNode)

        &#x2F;&#x2F;        if (!(ValidateXML(norm_elem, oXsdSc))) {
        &#x2F;&#x2F;            norm_elem.parentNode.replaceChild(backupnode, norm_elem);
        &#x2F;&#x2F;            norm_elem = null;
        &#x2F;&#x2F;            return;
        &#x2F;&#x2F;        }

        norm_elem.normalize();
        setATTAPlokid(norm_elem);
        vaatedRefresh(2);

    } else if (cmel.id == &quot;incr_indent&quot;) { &#x2F;&#x2F;&#x27;elemendi nimi: clType = &quot;en&quot;;
        norm_elem = fatherNode;
        refNode = selectedNode.selectSingleNode(&quot;preceding-sibling::&quot; + DICPR + &quot;:t[1]&quot;);
        refNode.appendChild(selectedNode);
        norm_elem.normalize();
        setATTAPlokid(norm_elem);
        vaatedRefresh(2);
    } else if (cmel.id == &quot;decr_indent&quot;) { &#x2F;&#x2F;&#x27;elemendi nimi: clType = &quot;en&quot;;
        norm_elem = fatherNode.parentNode;
        refNode = fatherNode.nextSibling;
        fatherNode.parentNode.insertBefore(selectedNode, refNode);
        norm_elem.normalize();
        setATTAPlokid(norm_elem);
        vaatedRefresh(2);
    } else if (cmel.id == &quot;morf_ana&quot;) {
        &#x2F;&#x2F; sqna = jsTrim(jsLeft(selectedNode.text, 30))
        sqna = jsMid(sMarkSona, sMarkSona.lastIndexOf(&quot; &quot;) + 1);
        sqna = RemoveSymbols(sqna, &quot; &quot;) &#x2F;&#x2F;&#x27;2. parm VÕIB OLLA;
        &#x2F;&#x2F;sqna, tuletusega, liitsqnaga, sqnastikuga, vkkuju (sisekood, vorminimi, klaarkood, FS-kood; 0, 1, 2, 3);
        tulemus = eelexSWCtl.analyysi(sqna, ma_tul, ma_ls, ma_sqn, ma_vkkuju);
        var intVal, codeStr;
        codeStr = &quot;&quot;;
        for (i = 0; i &lt; tulemus.length; i++) {
            intVal = tulemus.charCodeAt(i);
            codeStr = codeStr + &quot;[&lt;b&gt;&quot; + tulemus.charAt(i) + &quot;&lt;&#x2F;b&gt; U+&quot; + jsStrRepeat(4 - hex(intVal, true).length, &quot;0&quot;) + hex(intVal, true) + &quot;, &quot; + intVal + &quot;]&quot;;
        }
        showDbgVar(&quot;tulemus: codeStr&quot;, tulemus, &quot;ClickCMenu&quot;, &quot;Morf analüüsi tulemus&quot;, codeStr, new Date());
        alert(&quot;&#x27;&quot; + sqna + &quot;&#x27;:&quot; + &#x27;\r\n\r\n&#x27; + &quot;&#x27;&quot; + tulemus + &quot;&#x27;&quot;, vbInformation, NAME_MORF_ANA);
    } else if (cmel.id == &quot;morf_syn&quot;) {
        &#x2F;&#x2F; sqna = jsTrim(jsLeft(selectedNode.text, 30))
        sqna = jsMid(sMarkSona, sMarkSona.lastIndexOf(&quot; &quot;) + 1);
        sqna = RemoveSymbols(sqna, &quot;&quot;); &#x2F;&#x2F;&#x27;2. parm VÕIB OLLA;
        tulemus = getLemmasForSyn(sqna);
        if (tulemus.length &gt; 0) {
            smdArgs = dic_desc + JR + sAppLang + JR + tulemus + JR + &quot;Paradigma&quot; + JR + ms_valtega + JR + ms_vkkuju;
            window.showModalDialog(&quot;html&#x2F;morf_syntees_vormid.htm&quot;, smdArgs, &quot;dialogHeight:768px;dialogWidth:1024px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:no;unadorned:no&quot;);
        }
    } else if (cmel.id == &quot;morf_syn_asenda&quot;) {
        &#x2F;&#x2F;siia jõuab ainult siis kui klõpsad muutevormide väljal;
        &#x2F;&#x2F; sqna = jsTrim(jsLeft(sMarkSona, 30))
        sqna = jsMid(sMarkSona, sMarkSona.lastIndexOf(&quot; &quot;) + 1);
        sqna = RemoveSymbols(sqna, &quot;&quot;); &#x2F;&#x2F;&#x27;2. parm VÕIB OLLA;
        &#x2F;&#x2F;üle ChrW(+HE001) märksõnad;
        &#x2F;&#x2F;algavad &#x27;+&#x27; v &#x27;?+&#x27; kui on liitsõna tagaosa v küsivav v mõlemad v kumbagi. Veel võib ees olla &quot;¡&quot; pl märkimiseks;
        tulemus = getLemmasForSyn(sqna);
        if (tulemus.length &gt; 0) {
            smdArgs = dic_desc + JR + sAppLang + JR + tulemus + JR + &quot;Muutevormid&quot; + JR + ms_valtega + JR + ms_vkkuju;
            retVal = window.showModalDialog(&quot;html&#x2F;morf_syntees_vormid.htm&quot;, smdArgs, &quot;dialogHeight:384px;dialogWidth:1024px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:no;unadorned:no&quot;);
            if (retVal) {
                var komplektid, komplekt, morfAndmed;
                komplektid = retVal.split(String.fromCharCode(0xE002));
                komplekt = komplektid[0];
                &#x2F;&#x2F;mv - mt - vk - sl - lsOsa;
                morfAndmed = komplekt.split(JR);
                selectedNode.text = morfAndmed[4] + morfAndmed[0] &#x2F;&#x2F;kas tuleb &#x27;+&#x27; ette;

                var gspq, lisatav, onMt, onSl, onVk;
                onMt = false;
                onSl = false;
                onVk = false;
                &#x2F;&#x2F;tüübinumber;
                lisatav = fatherNode.selectSingleNode(DICPR + &quot;:mt&quot;);
                if (!lisatav) {
                    &#x2F;&#x2F;GetSchemaPosQuery: teeb oStruDom - ist päringu following-sibling nimede kohta;
                    gspq = GetSchemaPosQuery(fatherNode, DICPR + &quot;:mt&quot;);
                    if (!(gspq == &quot;Ei saa&quot;)) {
                        refNode = fatherNode.selectSingleNode(gspq);
                        lisatav = fatherNode.insertBefore(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:mt&quot;, DICURI), refNode);
                        lisatav.text = morfAndmed[1];
                        onMt = true;
                    }
                } else {
                    lisatav.text = morfAndmed[1];
                    onMt = true;
                }
                &#x2F;&#x2F;sõnaliik;
                if ((morfAndmed[3] == &quot;S&quot;)) {
                    morfAndmed[3] = &quot;s&quot;;
                } else if ((morfAndmed[3] == &quot;V&quot;)) {
                    morfAndmed[3] = &quot;v&quot;;
                } else if ((morfAndmed[3] == &quot;A&quot;)) {
                    morfAndmed[3] = &quot;adj&quot;;
                }
                lisatav = fatherNode.selectSingleNode(DICPR + &quot;:sly&quot;); &#x2F;&#x2F;&#x27;Eesti-X - == on &lt;grg&gt; sõnaliigiks &lt;sly&gt;;
                if (!lisatav) {
                    &#x2F;&#x2F;GetSchemaPosQuery: teeb oStruDom - ist päringu following-sibling nimede kohta;
                    gspq = GetSchemaPosQuery(fatherNode, DICPR + &quot;:sly&quot;);
                    if (!(gspq == &quot;Ei saa&quot;)) {
                        refNode = fatherNode.selectSingleNode(gspq);
                        lisatav = fatherNode.insertBefore(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:sly&quot;, DICURI), refNode);
                        lisatav.text = morfAndmed[3];  &#x2F;&#x2F;Eesti-X - == on nt &#x27;s&#x27;, tuleb &#x27;S&#x27;;
                        onSl = true;
                    }
                } else {
                    lisatav.text = morfAndmed[3]; &#x2F;&#x2F;Eesti-X - == on nt &#x27;s&#x27;, tuleb &#x27;S&#x27;;
                    onSl = true;
                }
                &#x2F;&#x2F;vormikood;
                if (morfAndmed[2].length &gt; 0) {

                    &#x2F;&#x2F;                var oConfigDOM, cfgElem
                    &#x2F;&#x2F;               oConfigDOM = IDD(&quot;File&quot;, &quot;shsconfig_&quot; + dic_desc + &quot;.xml&quot;, false, false, null)
                    &#x2F;&#x2F;               cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;koht_vk&quot;)

                    var koht_vk, vkParent;
                    koht_vk = &quot;x:P&#x2F;x:mg&quot;;
                    if (!(koht_vk == &quot;&quot;)) {
                        vkParent = selectedNode.selectSingleNode(&quot;ancestor::&quot; + DICPR + &quot;:A&#x2F;&quot; + koht_vk);
                        lisatav = vkParent.selectSingleNode(DICPR + &quot;:vk&quot;);
                        if (!lisatav) {
                            &#x2F;&#x2F;GetSchemaPosQuery: teeb oStruDom - ist päringu following-sibling nimede kohta;
                            gspq = GetSchemaPosQuery(vkParent, DICPR + &quot;:vk&quot;);
                            if (!(gspq == &quot;Ei saa&quot;)) {
                                refNode = vkParent.selectSingleNode(gspq);
                                lisatav = vkParent.insertBefore(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:vk&quot;, DICURI), refNode);
                                lisatav.text = morfAndmed[2];
                                onVk = true;
                            }
                        } else {
                            lisatav.text = morfAndmed[2];
                            onVk = true;
                        }
                    } else {
                        lisatav = fatherNode.selectSingleNode(DICPR + &quot;:vk&quot;);
                        if (!lisatav) {
                            &#x2F;&#x2F;GetSchemaPosQuery: teeb oStruDom - ist päringu following-sibling nimede kohta;
                            gspq = GetSchemaPosQuery(fatherNode, DICPR + &quot;:vk&quot;);
                            if (!(gspq == &quot;Ei saa&quot;)) {
                                refNode = fatherNode.selectSingleNode(gspq);
                                lisatav = fatherNode.insertBefore(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:vk&quot;, DICURI), refNode);
                                lisatav.text = morfAndmed[2];
                                onVk = true;
                            }
                        } else {
                            lisatav.text = morfAndmed[2];
                            onVk = true;
                        }
                    }
                    onVk = false &#x2F;&#x2F;et &quot;vk&quot; saaks lisatud ainult 1 kord ...;
                }
                if (komplektid.length &gt; 1) {
                    var uusGrg;
                    refNode = fatherNode.nextSibling;
                    for (i = 1; i &lt; komplektid.length; i++) {
                        komplekt = komplektid[i];
                        &#x2F;&#x2F;mv - mt - vk - sl - lsOsa;
                        morfAndmed = komplekt.split(JR);
                        uusGrg = fatherNode.parentNode.insertBefore(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:grg&quot;, DICURI), refNode);
                        if ((morfAndmed[2].length &gt; 0 &amp;&amp; onVk)) { &#x2F;&#x2F;vormikood;
                            lisatav = uusGrg.appendChild(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:vk&quot;, DICURI));
                            lisatav.text = morfAndmed[2];
                        }
                        lisatav = uusGrg.appendChild(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:mv&quot;, DICURI));
                        lisatav.text = morfAndmed[4] + morfAndmed[0] &#x2F;&#x2F;kas tuleb &#x27;+&#x27; ette;
                        if ((onSl)) {
                            lisatav = uusGrg.appendChild(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:sly&quot;, DICURI));
                            lisatav.text = morfAndmed[3];
                        }
                        if ((onMt)) {
                            lisatav = uusGrg.appendChild(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:mt&quot;, DICURI));
                            lisatav.text = morfAndmed[1];
                        }
                    }
                }
                setATTAPlokid(selectedNode);
                vaatedRefresh(2);
            }
        }
    } else if (cmel.id == &quot;open_for_copy&quot;) {
        if (!oCopyView) {
            oCopyView = IDD(&quot;File&quot;, &quot;xsl&#x2F;copyview.xsl&quot;, false, false, null);
        }
        oViewAll(&quot;ifrviewdiv&quot;).innerHTML = selectedNode.transformNode(oCopyView);
		&#x2F;&#x2F; ======================================================================================================
		&#x2F;&#x2F; ats+++  (16.11.2012&#x2F;18.11.2012)
		&#x2F;&#x2F; ======================================================================================================
	  } else if (cmel.id == &quot;viitcontrol&quot;) {
		&#x2F;&#x2F; atsoft...
		ccField = selectedNode.text;
		if (ccField == &quot;&quot;) {
		  alert(&quot;Viiteväli on tühi!&quot;);
		}else {
		  atsRunQuery(selectedNode.text);
		}
		&#x2F;&#x2F;ats
    } else if (cmel.id == &quot;openFindReplace&quot;) {
        var hulgiNimi;
        if (dic_desc == &quot;sp_&quot;) {
            hulgiNimi = &quot;openFindReplace&quot;;
        } else {
            hulgiNimi = &quot;hulgiParandused&quot;;
        }
        window.open(&quot;html&#x2F;&quot; + hulgiNimi + &quot;.htm?valitud=1&quot;, &quot;_blank&quot;, &quot;width=1024,height=700,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=yes,titlebar=yes,toolbar=no&quot;);
    } else if (cmel.id == &quot;del_self&quot;) {
        var sTekst, nn; &#x2F;&#x2F;nodeName;
        sTekst = clickedNode.text;
        updMuudatused(&quot;K&quot;, sTekst);
        if (clType == &quot;en&quot;) {
            norm_elem = fatherNode;  &#x2F;&#x2F;selectedNode.parentNode;
            nn = selectedNode.nodeName;
            norm_elem.removeChild(selectedNode);
            arvutaTxhendusNumbrid(norm_elem, nn);
        } else if (clType == &quot;et&quot; || clType == &quot;ct&quot;) {
            norm_elem = selectedNode;
            norm_elem.removeChild(clickedNode);
        } else if (clType == &quot;at&quot;) {
            norm_elem = fatherNode; &#x2F;&#x2F;element, millele atribuut kuulub;
            norm_elem.removeAttributeNode(selectedNode);
        }
        norm_elem.normalize();
        setATTAPlokid(norm_elem);
        vaatedRefresh(2);
    } else if (cmel.id == &quot;cut_node&quot;) {
        norm_elem = fatherNode;
        cpfragment.selectNodes(&quot;*&quot;).removeAll();
        cpfragment.appendChild(clickedNode);
        norm_elem.normalize();
        setATTAPlokid(norm_elem);
        vaatedRefresh(2);
    } else if (cmel.id == &quot;cut_node_add&quot;) {
        norm_elem = fatherNode;
        cpfragment.appendChild(clickedNode);
        norm_elem.normalize();
        setATTAPlokid(norm_elem);
        vaatedRefresh(2);
    } else if (cmel.id == &quot;copy_node&quot;) {
        cpfragment.selectNodes(&quot;*&quot;).removeAll();
        cpfragment.appendChild(clickedNode.cloneNode(true));
    } else if (cmel.id == &quot;copy_node_add&quot;) {
        cpfragment.appendChild(clickedNode.cloneNode(true));
    } else if (cmel.parentElement.id == &quot;paste_node_options&quot;) {
        backupnode = fatherNode.cloneNode(true)

        if (clType == &quot;en&quot;) {
            norm_elem = fatherNode;
            refNode = selectedNode;
        } else if (clType == &quot;et&quot; || clType == &quot;ct&quot;) {
            norm_elem = selectedNode;
            refNode = clickedNode;
        }

        if (window.event.ctrlLeft &amp;&amp; cpfragment.childNodes.length == 1) {
            &#x2F;&#x2F;prompt(: prompt, default)
            tval = prompt(cpfragment.childNodes[0].nodeName + &#x27;\r\n\r\n&#x27; + DLG_GET_ELEM_NAME, DLG_REN_ELEMENT, cpfragment.childNodes[0].nodeName);
            if ((tval == &quot;&quot;)) {
                return;
            }
            dfr = oEditDOM.createDocumentFragment();
            dfr.appendChild(oEditDOM.createNode(NODE_ELEMENT, tval, DICURI));
            newNoded = cpfragment.childNodes[0].childnodes;
            for (i = 0; i &lt; newNoded.length; i++) {
                newNode = newNoded[i];
                dfr.childNodes[0].appendChild(newNode.cloneNode(true));
            }
            pasteFragment = dfr;
        } else {
            pasteFragment = cpfragment.cloneNode(true);
        }

        var fPasted, myNode;
        fPasted = null;

        var myNoded = pasteFragment.childNodes;
        if (cmel.id == &quot;paste_node_before&quot;) {
            for (i = 0; i &lt; myNoded.length; i++) {
                myNode = myNoded[i];
                if (fPasted == null) {
                    fPasted = norm_elem.insertBefore(myNode.cloneNode(true), refNode);
                } else {
                    norm_elem.insertBefore(myNode.cloneNode(true), refNode);
                }
            }
        } else if (cmel.id == &quot;paste_node_insert&quot;) {
            for (i = 0; i &lt; myNoded.length; i++) {
                myNode = myNoded[i];
                if (fPasted == null) {
                    fPasted = refNode.appendChild(myNode.cloneNode(true));
                } else {
                    refNode.appendChild(myNode.cloneNode(true));
                }
            }
        } else if (cmel.id == &quot;paste_node_insertContent&quot;) {
            myNoded = pasteFragment.childNodes[0].childNodes;
            for (i = 0; i &lt; myNoded.length; i++) {
                myNode = myNoded[i];
                if (fPasted == null) {
                    fPasted = refNode.appendChild(myNode.cloneNode(true));
                } else {
                    refNode.appendChild(myNode.cloneNode(true));
                }
                refNode.appendChild(myNode.cloneNode(true));
            }
        } else if (cmel.id == &quot;paste_node_after&quot;) {
            refNode = refNode.nextSibling;
            for (i = 0; i &lt; myNoded.length; i++) {
                myNode = myNoded[i];
                if (fPasted == null) {
                    fPasted = norm_elem.insertBefore(myNode.cloneNode(true), refNode);
                } else {
                    norm_elem.insertBefore(myNode.cloneNode(true), refNode);
                }
            }
        } else if (cmel.id == &quot;paste_node_over&quot;) {
            for (i = 0; i &lt; myNoded.length; i++) {
                myNode = myNoded[i];
                if (fPasted == null) {
                    fPasted = norm_elem.insertBefore(myNode.cloneNode(true), refNode);
                } else {
                    norm_elem.insertBefore(myNode.cloneNode(true), refNode);
                }
            }
            norm_elem.removeChild(refNode);
        }
        AddGruppChecks(fPasted);  &#x2F;&#x2F; @nrl, tähendusnumbrite ümberarvutused;

        pasteCheck = fatherNode.cloneNode(true);
        DeleteEmptys(pasteCheck);

        if (!(ValidateXML(pasteCheck, oXsdSc))) {
            fatherNode.parentNode.replaceChild(backupnode, fatherNode);
            norm_elem = null;
            return;
        }

        norm_elem.normalize();
        setATTAPlokid(norm_elem);
        vaatedRefresh(2);

    } else if (cmel.parentElement.id == &quot;aacContMenu&quot;) {
        norm_elem = fatherNode;
        if (cmel.id == &quot;addAssembleComplete&quot;) {
            var newAttr;
            newAttr = oEditDOM.createNode(NODE_ATTRIBUTE, DICPR + &quot;:aK&quot;, DICURI);
            newAttr.value = sUsrName;
            selectedNode.attributes.setNamedItem(newAttr);
            newAttr = oEditDOM.createNode(NODE_ATTRIBUTE, DICPR + &quot;:aKL&quot;, DICURI);
            newAttr.value = GetXSDDateTime(new Date());
            selectedNode.attributes.setNamedItem(newAttr);
        } else if (cmel.id == &quot;remAssembleComplete&quot;) {
            selectedNode.removeAttribute(DICPR + &quot;:aK&quot;);
            selectedNode.removeAttribute(DICPR + &quot;:aKL&quot;);
        }
        norm_elem.normalize();
        setATTAPlokid(norm_elem);
        vaatedRefresh(2);
    } else if (cmel.id == &quot;morfofonInfo&quot;) {
        var mfDom = exCGISync(&quot;create_mfp.cgi&quot;, dic_desc + PD + selectedNode.xml);
        var mf = jsTrim(mfDom.responseText);
        if (mf) {
            var mfpNode = selectedNode.selectSingleNode(DICPR + &quot;:mfp&quot;);
            if (mfpNode) {
                norm_elem = selectedNode;
                var mfNode = mfpNode.selectSingleNode(DICPR + &quot;:mf&quot;);
                if (!mfNode) {
                    mfNode = mfpNode.insertBefore(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:mf&quot;, DICURI), mfpNode.firstChild);
                }
                mfNode.text = mf;
            }
            else {
                alert(&quot;Puudub morfoloogiaplokk!&quot;);
                return;
            }
        }
        else {
            alert(&quot;Morfofonoloogiline vastus tühi!&quot;);
            return;
        }
        norm_elem.normalize();
        setATTAPlokid(norm_elem);
        vaatedRefresh(2);
    } else if (cmel.id == &quot;guuglisse&quot; || cmel.id == &quot;extLinks&quot;) {
        sisuTekst = &quot;&quot;;
        sisuTekstid = selectedNode.selectNodes(&quot;.&#x2F;&#x2F;text()[not(local-name(..) = &#x27;G&#x27; or local-name(..) = &#x27;K&#x27; or local-name(..) = &#x27;KA&#x27; or local-name(..) = &#x27;KL&#x27; or local-name(..) = &#x27;T&#x27; or local-name(..) = &#x27;TA&#x27; or local-name(..) = &#x27;TL&#x27; or local-name(..) = &#x27;PT&#x27; or local-name(..) = &#x27;PTA&#x27; or local-name(..) = &#x27;X&#x27; or local-name(..) = &#x27;XA&#x27;)]&quot;);
        for (ix = 0; ix &lt; sisuTekstid.length; ix++) {
            if (sisuTekst) {
                sisuTekst += &quot; &quot;;
            }
            sisuTekst += sisuTekstid[ix].text;
        }
        sisuTekst = sisuTekst.replace(&#x2F;(&amp;amp;)&#x2F;g, &#x27;&amp;&#x27;);
        sisuTekst = sisuTekst.replace(&#x2F;(&amp;\w+;)&#x2F;g, &quot;&quot;);
        sisuTekst = sisuTekst.replace(&#x2F;[!&quot;#$%&amp;&#x27;\(\)\*\+,\-\.\&#x2F;:;&lt;=&gt;\?\[\\\]&#x60;\{\|\}¤]&#x2F;g, &quot;&quot;);
        sisuTekst = encodeURIComponent(sisuTekst);
        if (cmel.id == &quot;guuglisse&quot;) {
            window.open(&quot;http:&#x2F;&#x2F;www.google.com&#x2F;search?q=&quot; + sisuTekst, &quot;guugler&quot;);
        }
        else {
            window.open(&quot;extLinks.cgi?dictid=&quot; + dic_desc + &quot;&amp;sone=&quot; + sisuTekst, &quot;extLinks&quot;);
        }
    }
} &#x2F;&#x2F;ClickCMenu


&#x2F;**
* 
*
* @method GetAddElementFromFile
* @param {String} qname
* @param {String} uri
* @returns {Object}
*&#x2F;
function GetAddElementFromFile(qname, uri) {
    var frdoc, aenode
    frdoc = IDD(&quot;file&quot;, &quot;xml&#x2F;&quot; + dic_desc + &quot;&#x2F;ag_&quot; + unName(qname) + &quot;.xml&quot;, false, false, null);
    if (frdoc.parseError.errorCode == 0) {
        aenode = oEditDOM.importNode(frdoc.documentElement, true);
    } else {
        aenode = oEditDOM.createNode(NODE_ELEMENT, qname, uri);
    }
    AddEmptyTexts(aenode);
    return aenode;
} &#x2F;&#x2F;GetAddElementFromFile


&#x2F;**
* 
*
* @method GetAddElement
* @param {String} qname
* @param {String} uri
* @returns {Object}
*&#x2F;
function GetAddElement(qname, uri) {
    var xh, oRespDom, sta, frDoc, aenode, elXml;
    &#x2F;&#x2F;set aenode = null
    xh = exCGISync(&quot;tools.cgi&quot;, &quot;getAddElements&quot; + JR + dic_desc + JR + sUsrName + JR + &quot;xml&#x2F;&quot; + dic_desc + &quot;&#x2F;&quot; + JR + &quot;ag_&quot; + unName(qname) + &quot;.xml&quot; + JR + &quot;&quot;);
    if ((xh.statusText == &quot;OK&quot;)) {
        oRespDom = xh.responseXML &#x2F;&#x2F;responseXML: TypeName = DomDocument;
        sta = oRespDom.selectSingleNode(&quot;rsp&#x2F;sta&quot;).text;
        if ((sta == &quot;Success&quot;)) {
            elXml = oRespDom.selectSingleNode(&quot;rsp&#x2F;answer&quot;).firstChild.xml;
            frDoc = IDD(&quot;&quot;, &quot;&quot;, false, false, null);
            frDoc.loadXML(elXml);
            aenode = frDoc.documentElement;
        }
    }
    AddEmptyTexts(aenode)
    return aenode;
} &#x2F;&#x2F;GetAddElement


&#x2F;**
* 
*
* @method AddEmptyTexts
* @param {Object} nodeToCheck
*&#x2F;
function AddEmptyTexts(nodeToCheck) {
    var emptynodes, emptynode, oParticle
    emptynodes = nodeToCheck.selectNodes(&quot;descendant-or-self::*[not(text() or *)]&quot;);
    for (i = 0; i &lt; emptynodes.length; i++) {
        emptynode = emptynodes[i];
        try {
            oParticle = oSchRootElems.itemByQName(emptynode.baseName, emptynode.namespaceURI);
            if ((oParticle.type.itemType == SOMITEM_COMPLEXTYPE)) {
                if (!(oParticle.type.contentType == SCHEMACONTENTTYPE_ELEMENTONLY)) {
                    emptynode.text = &quot;&quot;;
                }
            } else {
                emptynode.text = &quot;&quot;;
            }
        }
        catch (e) {
            alert(e.name + &quot; 0x&quot; + hex(e.number, true) + &quot;: &#x27;&quot; + e.description);
        }
    }
} &#x2F;&#x2F;AddEmptyTexts


&#x2F;&#x2F;-----------------------------------------------------------------------------------
&#x2F;&#x2F;----------------------------- TN (teksti sees) menüü  -----------------------------
&#x2F;&#x2F;-----------------------------------------------------------------------------------
&#x2F;**
* TN (teksti sees) menüü.
*
* @method GetTNSubMenus
*&#x2F;
function GetTNSubMenus() {
    var prevqn;
    var nextqn

    prevqn = &quot;&quot;;
    nextqn = &quot;&quot;

    var tnode
    tnode = clickedNode.selectSingleNode(&quot;preceding-sibling::*[1]&quot;);
    if (!(tnode == null)) {
        prevqn = tnode.nodeName;
    }
    tnode = clickedNode.selectSingleNode(&quot;following-sibling::*[1]&quot;);
    if (!(tnode == null)) {
        nextqn = tnode.nodeName;
    }

    var pnqn;
    pnqn = selectedNode.nodeName

    var frdoc;
    var anynames;
    var chcount;
    var chmax;
    var smhtml = &#x27;&#x27;;
    var subelems

    var i;
    var subelem;
    var tarr

    &#x2F;&#x2F;GetElSchemaInfo =
    &#x2F;&#x2F;qn(0); item.uri(1); typename(item)(2); typename(item.type)(3);
    &#x2F;&#x2F;item.type.contentType(4); item.type.name(5); item.minOcc(6);
    &#x2F;&#x2F;item.maxOcc(7); kirjeldav(8); item.name(9)

    if (snDecl.type.contentModel.particles.length &gt; 0) {
        var fparticle = snDecl.type.contentModel.particles[0];

        if ((fparticle.itemType == SOMITEM_ANY)) {
            frdoc = IDD(&quot;file&quot;, &quot;xml&#x2F;&quot; + dic_desc + &quot;&#x2F;aa_&quot; + unName(pnqn) + &quot;.xml&quot;, false, false, null);
            if ((frdoc.parseError.errorCode != 0)) {
                return;
            }
            anynames = frdoc.documentElement.text.split(&quot;|&quot;);
            chcount = XMLChildTagsCount(selectedNode, &quot;*&quot;);
            chmax = parseInt(fparticle.maxOccurs);
            if ((chmax == -1 || chcount &lt; chmax)) {
                subelems = new Array(anynames.length);
                for (i = 0; i &lt; anynames.length; i++) {
                    subelem = oSchRootElems.itemByQName(jsMid(anynames[i], anynames[i].indexOf(&quot;:&quot;) + 1), oXmlNsm.getURI(jsMid(anynames[i], 0, anynames[i].indexOf(&quot;:&quot;))));
                    subelems[i] = GetElSchemaInfo(subelem);
                    tarr = subelems[i].split(&quot;;&quot;);
                    smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; &quot; + &quot;id=&#x27;&quot; + subelems[i] + &quot;&#x27; &quot; + &quot;title=&#x27;&quot; + tarr[0] + &quot;&#x27;&gt;&quot; + tarr[8] + &quot; (&quot; + tarr[0] + &quot;)&lt;&#x2F;div&gt;&quot;;
                }
            }
        } else {
            var pncount;
            pncount = snDecl.type.contentModel.particles.length;
            subelems = new Array(pncount);
            var subqn;
            var elbefind;
            var elaftind;
            elbefind = 0;
            elaftind = pncount - 1;
            for (i = 0; i &lt; pncount; i++) {
                subelem = snDecl.type.contentModel.particles[i];
                subelems[i] = GetElSchemaInfo(subelem);
                subqn = oXmlNsm.getPrefixes(subelem.namespaceURI).item(0) + &quot;:&quot; + subelem.name;
                if ((subqn == prevqn)) {
                    elbefind = i;
                }
                if ((subqn == nextqn)) {
                    elaftind = i;
                }
            }
            for (i = elbefind; i &lt;= elaftind; i++) {
                tarr = subelems[i].split(&quot;;&quot;);
                chcount = XMLChildTagsCount(selectedNode, tarr[0]);
                chmax = parseInt(tarr[7]);
                if ((chmax == -1 || chcount &lt; chmax)) {
                    smhtml = smhtml + &quot;&lt;div style=&#x27;width:100%&#x27; class=&#x27;mi&#x27; &quot; + &quot;id=&#x27;&quot; + subelems[i] + &quot;&#x27; &quot; + &quot;title=&#x27;&quot; + tarr[0] + &quot;&#x27;&gt;&quot; + tarr[8] + &quot; (&quot; + tarr[0] + &quot;)&lt;&#x2F;div&gt;&quot;;
                }
            }
        }
    }
    tn_sm_before.innerHTML = smhtml;
    tn_sm_after.innerHTML = smhtml;
    tn_sm_insert.innerHTML = smhtml;
} &#x2F;&#x2F;GetTNSubMenus

&#x2F;**
* 
* @method sqnastikuTooriistad
*&#x2F;
function sqnastikuTooriistad() {
    var sSrToolsMenu, delimline;
    sSrToolsMenu = &quot;&quot;;
    delimline = jsStrRepeat((div_SrToolsMenu.style.pixelWidth &#x2F; 8), &quot;\u2013&quot;);  &#x2F;&#x2F;400 &#x2F; 8, mõttekriips

    &#x2F;&#x2F;EELex, kes saab mida:
    &#x2F;&#x2F;
    &#x2F;&#x2F; toimetamise logi                  kõik
    &#x2F;&#x2F; sarnased märksõnad                (EELex, kui ka MySql-is)
    &#x2F;&#x2F; vigased viited                    (EELex, kui ka MySql-is)
    &#x2F;&#x2F; EELex sätted                      peatoimetajad
    &#x2F;&#x2F; koopia                            EELex adminnid + &#x27;koopia&#x27;
    &#x2F;&#x2F; vaate genereerimine               EELex adminnid + &#x27;vaateGen&#x27;
    &#x2F;&#x2F; hulgiparandused                   EELex adminnid + &#x27;hulgi&#x27;
    &#x2F;&#x2F;--------------------
    &#x2F;&#x2F; loendid                           &quot;loendid&quot;
    &#x2F;&#x2F;--------------------
    &#x2F;&#x2F; peatoimetajate haldus             (EXSA)
    &#x2F;&#x2F; toimetajate haldus                (EXSA)
    &#x2F;&#x2F; sõnastiku kustutamine             (EXSA)


    var oConfigDOM, cfgElem;
    var koopia, vaateGen, hulgi, skeemiGen, loendid, importimine;
    koopia = false;
    vaateGen = false;
    hulgi = false;
    skeemiGen = false;
    loendid = false;
    importimine = false;
    oConfigDOM = IDD(&quot;File&quot;, &quot;shsconfig_&quot; + dic_desc + &quot;.xml&quot;, false, false, null);

    if (appDesc == &quot;EXSA&quot;) { &#x2F;&#x2F;&#x27;EXSA
        if (srTegija &amp;&amp; ptd.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1) {
            koopia = true;
            vaateGen = true;
            hulgi = true;
            skeemiGen = true;
            loendid = true;
            importimine = true;
        }
    } else { &#x2F;&#x2F;EELex;
        if (eeLexAdmin.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1) {
            koopia = true;
            vaateGen = true;
            hulgi = true;
            skeemiGen = true;
            loendid = true;
            importimine = true;
        } else {
            cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;koopia&quot;);
            if (!(cfgElem == null)) {
                if ((cfgElem.text.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1)) {
                    koopia = true;
                }
            }
            cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;import&quot;);
            if (!(cfgElem == null)) {
                if ((cfgElem.text.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1)) {
                    importimine = true;
                }
            }
            cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;vaateGen&quot;);
            if (!(cfgElem == null)) {
                if ((cfgElem.text.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1)) {
                    vaateGen = true;
                }
            }
            cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;hulgi&quot;);
            if (!(cfgElem == null)) {
                if ((cfgElem.text.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1)) {
                    hulgi = true;
                }
            }
            cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;skeemiGen&quot;);
            if (!(cfgElem == null)) {
                if ((cfgElem.text.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1)) {
                    skeemiGen = true;
                }
            }
            cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;loendid&quot;);
            if (cfgElem) {
                if (cfgElem.text.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1) {
                    loendid = true;
                }
            }
        }
    }

    &#x2F;&#x2F;5) - importimine
    if (importimine) {
        sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idGetXMLImport&#x27; value=&#x27;idGetXMLImport&#x27;&gt;&quot; + &quot;&lt;td&gt;Import&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    }

    &#x2F;&#x2F;5) - koopia, eksport
    if (koopia) {
        sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idGetXMLCopy&#x27; value=&#x27;idGetXMLCopy&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + NAME_XMLCOPY + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    }

    &#x2F;&#x2F;6) - skeemi genereerimine
    if (skeemiGen) {
        if (dic_desc != &quot;sp_&quot;) { &#x2F;&#x2F; sõnaperede skeem on ainuomaselt hierarhiline + plokid sisse&#x2F;välja
            sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idSkeemiGen&#x27; value=&#x27;idSkeemiGen&#x27;&gt;&quot; + &quot;&lt;td&gt;Skeemi genereerimine&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        }
    }

    &#x2F;&#x2F;7) - vaate genereerimine
    if (vaateGen) {
        sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idVaateGen&#x27; value=&#x27;idVaateGen&#x27;&gt;&quot; + &quot;&lt;td&gt;Vaate genereerimine&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    }

    &#x2F;&#x2F;8) - hulgiparandused
    if (hulgi) {
        sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idBulkUpdate&#x27; value=&#x27;idBulkUpdate&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + NAME_BULK + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    }

    &#x2F;&#x2F;8)b - XML valideerimine serveris
    if (hulgi) {
        sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idSrvXmlValidate&#x27; value=&#x27;idSrvXmlValidate&#x27;&gt;&quot; + &quot;&lt;td&gt;Köite valideerimine&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    }

    if (qryMethodOrg == &quot;MySql&quot;) {
        &#x2F;&#x2F;2) - sarnased märksõnad
        sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idMsSarnased&#x27; value=&#x27;idMsSarnased&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + NAME_ALIKE_HW + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        &#x2F;&#x2F;3) - vigased viited
        sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idTyhjadViited&#x27; value=&#x27;idTyhjadViited&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + NAME_ERR_REFERENCES + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    }

    &#x2F;&#x2F;1) - toimetamise logi
    sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idViewLogs&#x27; value=&#x27;idViewLogs&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + NAME_LOG + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;

    &#x2F;&#x2F;kehtib nii EXSA-s kui EELex-is
    if (srTegija &amp;&amp; (ptd.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1 || eeLexAdmin.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1)) {
        &#x2F;&#x2F;4) - EELex sätted
        sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idEELexSetup&#x27; value=&#x27;idEELexSetup&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + NAME_EELEX_CONFIG + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    }


    &#x2F;&#x2F;9) - loendid
    var loendidHTML;
    loendidHTML = &quot;&quot;;
    if (loendid) {

        var itm, jrkd, ixItm

        jrkd = new ActiveXObject(&quot;Scripting.Dictionary&quot;)

        var locnKeys = (new VBArray(impSchemaLocations.Keys())).toArray();
        for (itm in locnKeys) {
            if ((jsLeft(impSchemaLocations.Item(locnKeys[itm]), 4) == dic_desc + &quot;&#x2F;&quot;)) { &#x2F;&#x2F;&#x27;asub tüüpide DOM-is;
                var tyybidDom, koikTyybid, tNimi, eaNimi, eaNode, eaKirjeldav, nimed;
                var kirjeldav, kasutatud, jubaTehtud, ixType, tyybiNode, allItems, prType, qnType, yksik

                tyybidDom = IDD(&quot;File&quot;, &quot;xsd&#x2F;&quot; + impSchemaLocations.Item(locnKeys[itm]), false, false, null);
                tyybidDom.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
                tyybidDom.setProperty(&quot;SelectionNamespaces&quot;, jsTrim(sXsdNsList));
                koikTyybid = tyybidDom.documentElement.selectNodes(&quot;xs:simpleType&quot;);
                for (ixType = 0; ixType &lt; koikTyybid.length; ixType++) {
                    tyybiNode = koikTyybid[ixType].selectSingleNode(&quot;xs:annotation&#x2F;xs:documentation[@xml:lang=&#x27;&quot; + sAppLang + &quot;&#x27;]&quot;);
                    tNimi = koikTyybid[ixType].getAttribute(&quot;name&quot;);
                    kirjeldav = &quot;&quot;;
                    if (!(tyybiNode == null)) {
                        if ((tyybiNode.text.length &gt; 0)) {
                            kirjeldav = tyybiNode.text;
                        }
                    }
                    prType = oXsdNsm.getPrefixes(locnKeys[itm]).item(0);
                    qnType = prType + &quot;:&quot; + tNimi

                    allItems = oXsdDOM.documentElement.selectNodes(&quot;xs:element[@type = &#x27;&quot; + qnType + &quot;&#x27; or .&#x2F;&#x2F;*&#x2F;@base = &#x27;&quot; + qnType + &quot;&#x27;] | xs:attribute[@type = &#x27;&quot; + qnType + &quot;&#x27;]&quot;);
                    jubaTehtud = &quot;; &quot;;
                    nimed = &quot;; &quot;;
                    kasutatud = &quot;&quot;;
                    for (ixItm = 0; ixItm &lt; allItems.length; ixItm++) {
                        eaNimi = allItems[ixItm].getAttribute(&quot;name&quot;);
                        eaNode = allItems[ixItm].selectSingleNode(&quot;xs:annotation&#x2F;xs:documentation[@xml:lang=&#x27;&quot; + sAppLang + &quot;&#x27;]&quot;);
                        eaKirjeldav = &quot;&quot;;
                        if (!(eaNode == null)) {
                            if ((eaNode.text.length &gt; 0)) {
                                eaKirjeldav = eaNode.text;
                            }
                        }
                        if ((eaKirjeldav == &quot;&quot;)) {
                            eaKirjeldav = eaNimi;
                        }
                        if ((allItems(ixItm).baseName == &quot;element&quot;)) {
                            eaNimi = &quot;&amp;lt;&quot; + eaNimi + &quot;&amp;gt;&quot;;
                            eaKirjeldav = &quot;&amp;lt;&quot; + eaKirjeldav + &quot;&amp;gt;&quot;;
                        } else {
                            eaNimi = &quot;@&quot; + eaNimi;
                            eaKirjeldav = &quot;@&quot; + eaKirjeldav;
                        }
                        if ((jubaTehtud.indexOf(&quot;; &quot; + eaNimi + &quot;; &quot;) &lt; 0)) {
                            jubaTehtud = jubaTehtud + eaNimi + &quot;; &quot;;
                        }
                        if ((nimed.indexOf(&quot;; &quot; + eaKirjeldav + &quot;; &quot;) &lt; 0)) {
                            nimed = nimed + eaKirjeldav + &quot;; &quot;;
                        }
                    }
                    jubaTehtud = jsMid(jubaTehtud, 2);
                    nimed = jsMid(nimed, 2);
                    if ((jubaTehtud.length &gt; 0)) {
                        jubaTehtud = jsLeft(jubaTehtud, jubaTehtud.length - 2);
                        nimed = jsLeft(nimed, nimed.length - 2);
                        kasutatud = nimed + &quot; (&quot; + jubaTehtud + &quot;)&quot;;
                    }

                    if ((kirjeldav == &quot;&quot;)) {
                        if ((kasutatud == &quot;&quot;)) {
                            kirjeldav = tNimi + &quot; ---&quot;;
                        } else {
                            kirjeldav = kasutatud;
                        }
                    } else {
                        if ((kasutatud == &quot;&quot;)) {
                            if (!(tNimi == &quot;xmllang_tyyp&quot;)) { &#x2F;&#x2F;&#x27;seda ei ole otseselt skeemis, ainult skriptis;
                                kirjeldav = tNimi + &quot; - &quot; + kirjeldav + &quot; ---&quot;;
                            }
                        } else {
                            kirjeldav = kasutatud + &quot; - &quot; + kirjeldav;
                        }
                    }
                    yksik = &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;&quot; + tNimi + &quot;&#x27; value=&#x27;xsd&#x2F;&quot; + impSchemaLocations.Item(locnKeys[itm]) + &quot;&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + NAME_LIST + &quot;: &quot; + kirjeldav + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
                    jrkd.Add(kirjeldav + &quot; - &quot; + tNimi, yksik);
                }
            }
        }
        var k = (new VBArray(jrkd.Keys())).toArray();
        k = k.sort(ciSort);
        for (ixItm = 0; ixItm &lt; jrkd.Count; ixItm++) {
            loendidHTML = loendidHTML + jrkd.Item(k[ixItm]);
        }
    }

    &#x2F;&#x2F;9+) jne
    if (loendidHTML.length &gt; 0) {
        sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;delim1&#x27; value=&#x27;delim1&#x27;&gt;&quot; + &quot;&lt;td disabled&gt;&quot; + delimline + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        sSrToolsMenu = sSrToolsMenu + loendidHTML;
    }

    if (appDesc == &quot;EXSA&quot;) {
        if (srTegija &amp;&amp; ptd.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1) {
            sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;delim3&#x27; value=&#x27;delim3&#x27;&gt;&quot; + &quot;&lt;td disabled&gt;&quot; + delimline + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
            sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; confFile=&#x27;..&#x2F;exsas&#x2F;sqnastikud.xml&#x27; id=&#x27;ptd&#x27; value=&#x27;idExsaManPtd&#x27;&gt;&quot; + &quot;&lt;td&gt;Peatoimetajate haldus&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
            sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; confFile=&#x27;..&#x2F;exsas&#x2F;sqnastikud.xml&#x27; id=&#x27;td&#x27; value=&#x27;idExsaManUsr&#x27;&gt;&quot; + &quot;&lt;td&gt;Toimetajate haldus&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
            sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idRemoveDict&#x27; value=&#x27;idExsaRemoveDict&#x27;&gt;&quot; + &quot;&lt;td&gt;Kustuta sõnastik&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        }
    } else {
        if (dic_desc == &quot;ex_&quot;) {
            if (srTegija &amp;&amp; (ptd.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1 || eeLexAdmin.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1)) {
                sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;delim2&#x27; value=&#x27;delim2&#x27;&gt;&quot; + &quot;&lt;td disabled&gt;&quot; + delimline + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
                sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idArtImport&#x27; value=&#x27;idArtImport&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + NAME_IMPORT_ENTRY + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
            }
        } else if (dic_desc == &quot;od_&quot;) {
            sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;delim2&#x27; value=&#x27;delim2&#x27;&gt;&quot; + &quot;&lt;td disabled&gt;&quot; + delimline + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
            sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idOxfordDudenSisukord&#x27; value=&#x27;idOxfordDudenSisukord&#x27;&gt;&quot; + &quot;&lt;td&gt;Sisukord&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
            sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idOxfordDudenIndeksEng&#x27; value=&#x27;idOxfordDudenIndeksEng&#x27;&gt;&quot; + &quot;&lt;td&gt;Register: inglise&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
            sSrToolsMenu = sSrToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idOxfordDudenIndeksEst&#x27; value=&#x27;idOxfordDudenIndeksEst&#x27;&gt;&quot; + &quot;&lt;td&gt;Register: eesti&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        }
    }

    &#x2F;&#x2F;sSrToolsMenu = sSrToolsMenu +  &#x2F;&#x2F;    &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;delimN&#x27; value=&#x27;delimN&#x27;&gt;&quot; +  &#x2F;&#x2F;            &quot;&lt;td disabled&gt;&quot; + delimline + &quot;&lt;&#x2F;td&gt;&quot; +  &#x2F;&#x2F;    &quot;&lt;&#x2F;tr&gt;&quot;
    &#x2F;&#x2F;sSrToolsMenu = sSrToolsMenu +  &#x2F;&#x2F;    &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idAbout&#x27; value=&#x27;idAbout&#x27;&gt;&quot; +  &#x2F;&#x2F;            &quot;&lt;td&gt;&quot; + NAME_ABOUT + &quot;&lt;&#x2F;td&gt;&quot; +  &#x2F;&#x2F;    &quot;&lt;&#x2F;tr&gt;&quot;

    if (sSrToolsMenu.length &gt; 0) {
        div_SrToolsMenu.innerHTML = &quot;&lt;table id=&#x27;tbl_SrToolsMenu&#x27; width=&#x27;100%&#x27; border=&#x27;0&#x27; cellSpacing=&#x27;0&#x27;&gt;&quot; + sSrToolsMenu + &quot;&lt;&#x2F;table&gt;&quot;;
        if (div_SrToolsMenu.all.tags(&quot;TR&quot;).length &gt; (maxEnumRows + 1)) {
            div_SrToolsMenu.style.height = &quot;480px&quot;;
        } else {
            div_SrToolsMenu.style.height = &quot;&quot;;
        }
    }
} &#x2F;&#x2F;sqnastikuTooriistad


&#x2F;**
* 
* @method assignMainEntry
*&#x2F;
function assignMainEntry() {
    var esiOsa, tagaOsa, oM1Node, art, liik;
    oM1Node = oEditDOMRoot.selectSingleNode(first_default);
    liik = oM1Node.getAttribute(DICPR + &quot;:liik&quot;);
    art = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&quot;);
    if ((liik == &quot;f&quot; || liik == &quot;y&quot;)) {
        art.removeAttribute(DICPR + &quot;:Al&quot;);
    } else {
        if ((sMarkSona.indexOf(&quot;|&quot;) &gt; -1)) {
            esiOsa = jsMid(sMarkSona, 0, sMarkSona.indexOf(&quot;|&quot;));
            tagaOsa = jsMid(sMarkSona, sMarkSona.indexOf(&quot;|&quot;) + 1);
        } else if ((jsLeft(sMarkSona, 1) == &quot;\\&quot;)) {
            esiOsa = sMarkSona.split(&quot;\\&quot;)[1];
            tagaOsa = jsMid(sMarkSona, sMarkSona.lastIndexOf(&quot;\\&quot;) + 1);
        } else {
            return;
        }
        oM1Node.text = esiOsa + &quot;|&quot; + tagaOsa;
        art.removeAttribute(DICPR + &quot;:Al&quot;);
    }
    oEditAll(&quot;ifrdiv&quot;).setAttribute(&quot;xmlChanged&quot;, 2); &#x2F;&#x2F;&#x27;2 korral värskendatakse kogu iframe ...;
} &#x2F;&#x2F;assignMainEntry


&#x2F;**
* 
* @method assignSubEntry
*&#x2F;
function assignSubEntry() {
    var onLS, esiOsa, tagaOsa, oM1Node, art, liik;
    oM1Node = oEditDOMRoot.selectSingleNode(first_default);
    liik = oM1Node.getAttribute(DICPR + &quot;:liik&quot;);
    art = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&quot;);
    if ((liik == &quot;f&quot; || liik == &quot;y&quot;)) {
        art.setAttribute(DICPR + &quot;:Al&quot;, &quot;all&quot;);
    } else {
        if ((sMarkSona.indexOf(&quot;|&quot;) &gt; -1)) {
            esiOsa = jsMid(sMarkSona, 0, sMarkSona.indexOf(&quot;|&quot;));
            tagaOsa = jsMid(sMarkSona, sMarkSona.indexOf(&quot;|&quot;) + 1);
        } else if ((jsLeft(sMarkSona, 1) == &quot;\\&quot;)) {
            esiOsa = sMarkSona.split(&quot;\\&quot;)[1];
            tagaOsa = jsMid(sMarkSona, sMarkSona.lastIndexOf(&quot;\\&quot;) + 1);
        } else {
            return;
        }
        oM1Node.text = &quot;\\&quot; + esiOsa + &quot;\\&quot; + tagaOsa;
        art.setAttribute(DICPR + &quot;:Al&quot;, &quot;all&quot;);
    }
    oEditAll(&quot;ifrdiv&quot;).setAttribute(&quot;xmlChanged&quot;, 2); &#x2F;&#x2F;&#x27;2 korral värskendatakse kogu iframe ...;
} &#x2F;&#x2F;assignSubEntry



&#x2F;**
* 
* @method artikliStaatus
* @param {String} st Vist on string.
*&#x2F;
function artikliStaatus(st) {
    var MyVar, artNode
    artNode = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&quot;);
    artNode.setAttribute(DICPR + &quot;:AS&quot;, st)

    vaatedRefresh(2);
    &#x2F;&#x2F;MyVar=alert(&quot;Muudatus edukalt tehtud. Ärge unustage artiklit salvestada!!!&quot;, 0, &quot;Teade&quot;)
} &#x2F;&#x2F;artikliStaatus


&#x2F;**
* 
* @method AllartikkelYesNo
*&#x2F;
function AllartikkelYesNo() {
    var MyVar, artNode, homNr, st
    artNode = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&quot;);
    &#x2F;&#x2F;artNode.CreateAttribute(DICPR, &quot;all&quot;, &quot;http:&#x2F;&#x2F;www.eki.ee&#x2F;dict&#x2F;ex&quot;)
    homNr = artNode.getAttribute(DICPR + &quot;:all&quot;);
    if (homNr == null) {
        artNode.setAttribute(DICPR + &quot;:all&quot;, &quot;all&quot;);
    } else {
        artNode.removeAttribute(DICPR + &quot;:all&quot;);
    }
    vaatedRefresh(2);
    &#x2F;&#x2F;MyVar=alert(&quot;Muudatus edukalt tehtud. Ärge unustage artiklit salvestada!!!&quot;, 0, &quot;Teade&quot;)
} &#x2F;&#x2F;artikliStaatus


&#x2F;**
* 
* @method ABartikkelYesNo
*&#x2F;
function ABartikkelYesNo() {
    var MyVar, artNode, homNr, st
    artNode = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&quot;);
    &#x2F;&#x2F;artNode.CreateAttribute(DICPR, &quot;all&quot;, &quot;http:&#x2F;&#x2F;www.eki.ee&#x2F;dict&#x2F;ex&quot;)
    homNr = artNode.getAttribute(DICPR + &quot;:AS&quot;);
    if (homNr == null) {
        artNode.setAttribute(DICPR + &quot;:AS&quot;, &quot;AB&quot;);
    } else {
        artNode.removeAttribute(DICPR + &quot;:AS&quot;);
    }


    vaatedRefresh(2);
    &#x2F;&#x2F;MyVar=alert(&quot;Muudatus edukalt tehtud. Ärge unustage artiklit salvestada!!!&quot;, 0, &quot;Teade&quot;)
} &#x2F;&#x2F;artikliStaatus


&#x2F;**
* 
* @method showMsSarnased
*&#x2F;
function showMsSarnased() {
    if ((salvestaJaKatkesta())) {
        return;
    }

    sCmdId = &quot;msSarnased&quot;;
    sQryInfo = &quot;Sarnased märksõnad&quot;

    var sPrmDomXml, oPrmDom, qM;
    qM = &quot;MySql&quot;;
    sPrmDomXml = &quot;&lt;prm&gt;&quot; + &quot;&lt;cmd&gt;&quot; + sCmdId + &quot;&lt;&#x2F;cmd&gt;&quot; + &quot;&lt;vol&gt;&quot; + sel_Vol.options(sel_Vol.selectedIndex).id + &quot;&lt;&#x2F;vol&gt;&quot; + &quot;&lt;nfo&gt;&quot; + sQryInfo + &quot;&lt;&#x2F;nfo&gt;&quot; + &quot;&lt;qn&gt;&quot; + qn_ms + &quot;&lt;&#x2F;qn&gt;&quot; + &quot;&lt;qM&gt;&quot; + qM + &quot;&lt;&#x2F;qM&gt;&quot; + &quot;&lt;&#x2F;prm&gt;&quot;;

    oPrmDom = IDD(&quot;String&quot;, sPrmDomXml, false, false, null);
    if ((oPrmDom.parseError.errorCode != 0)) {
        ShowXMLParseError(oPrmDom);
        return;
    }
    StartOperation(oPrmDom);
} &#x2F;&#x2F;showMsSarnased


&#x2F;**
* 
* @method showTyhjadViited
*&#x2F;
function showTyhjadViited() {
    if ((salvestaJaKatkesta())) {
        return;
    }

    var viiteLn, smdArgs;
    &#x2F;&#x2F;prompt(: prompt, default)
    &#x2F;&#x2F;&quot;&lt;qn&gt;&quot; + DICPR + &quot;:&quot; + viiteLn + &quot;&lt;&#x2F;qn&gt;&quot; + &quot;&lt;qn2&gt;&quot; + DICPR + &quot;:&quot; + viiteLn2 + &quot;&lt;&#x2F;qn2&gt;&quot;

    smdArgs = dic_desc + PD + sUsrName + PD + sAppLang + PD + DICPR + PD + default_query;
    viiteLn = window.showModalDialog(&quot;html&#x2F;viganeViit.htm&quot;, smdArgs, &quot;dialogHeight:320px;dialogWidth:600px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:yes;unadorned:no&quot;);



    if ((viiteLn == &quot;&quot;)) {
        return;
    }

    sCmdId = &quot;tyhjadViited&quot;;
    sQryInfo = &quot;Olematud viited &amp;lt;&quot; + viiteLn + &quot;&amp;gt;&quot;

    var sPrmDomXml, oPrmDom, qM;
    qM = &quot;MySql&quot;;
    sPrmDomXml = &quot;&lt;prm&gt;&quot; + &quot;&lt;cmd&gt;&quot; + sCmdId + &quot;&lt;&#x2F;cmd&gt;&quot; + &quot;&lt;vol&gt;&quot; + sel_Vol.options(sel_Vol.selectedIndex).id + &quot;&lt;&#x2F;vol&gt;&quot; + &quot;&lt;nfo&gt;&quot; + sQryInfo + &quot;&lt;&#x2F;nfo&gt;&quot; + viiteLn + &quot;&lt;qM&gt;&quot; + qM + &quot;&lt;&#x2F;qM&gt;&quot; + &quot;&lt;&#x2F;prm&gt;&quot;;

    oPrmDom = IDD(&quot;String&quot;, sPrmDomXml, false, false, null);
    if ((oPrmDom.parseError.errorCode != 0)) {
        ShowXMLParseError(oPrmDom);
        return;
    }
    StartOperation(oPrmDom);
} &#x2F;&#x2F;showTyhjadViited


&#x2F;**
* 
* @method XMLChanged
*&#x2F;
function XMLChanged() {
    var oSrc, sPropName;

    oSrc = window.event.srcElement;
    sPropName = window.event.propertyName

    &#x2F;&#x2F;peale iga muutust salvestatakse puhvrisse artikli hetkeseis, 1. koopia tehakse juba artikli ettetoomisel
    if ((sPropName == &quot;xmlChanged&quot;)) {
        if ((urindex == urfragment.childNodes.length - 1)) { &#x2F;&#x2F;lõpus;
            if ((urindex &gt; -1)) {
                &#x2F;&#x2F;ainult salvestamise korral on võimalik, et artikkel võib sama olla ...;
                if ((oEditDOMRoot.firstChild.xml != urfragment.childNodes(urindex).xml)) {
                    urfragment.appendChild(oEditDOMRoot.firstChild.cloneNode(true));
                    urindex = urindex + 1;
                }
            } else {
                urfragment.appendChild(oEditDOMRoot.firstChild.cloneNode(true));
                urindex = urindex + 1;
            }
        } else {
            &#x2F;&#x2F;ainult salvestamise korral on võimalik, et artikkel võib sama olla ...;
            if ((oEditDOMRoot.firstChild.xml != urfragment.childNodes(urindex).xml)) {
                urindex = urindex + 1;
                urfragment.replaceChild(oEditDOMRoot.firstChild.cloneNode(true), urfragment.childNodes(urindex));
            }
        }
        if ((urindex == urmax)) {
            urfragment.removeChild(urfragment.childNodes[0]);
            urindex = urindex - 1;
        }
        urlast = urindex;
        if ((oSrc.getAttribute(sPropName) == 2)) {
            oSrc.innerHTML = oEditDOM.transformNode(oXslEdit);
        }
    }

    var oM1Node, i, intVal, msCodeStr;

    msCodeStr = &quot;&quot;;

    &#x2F;&#x2F;siia jõutakse kas &#x27;xmlChanged&#x27; või &#x27;innerHTML&#x27; - iga
    if ((oEditDOMRoot.hasChildNodes())) {

        oM1Node = oEditDOMRoot.selectSingleNode(first_default);
        sMarkSona = oM1Node.text;
        sMSortVal = oM1Node.getAttribute(qn_sort_attr);
        msAsendus = &quot;&quot;;
        for (i = 0; i &lt; sMarkSona.length; i++) {
            if ((CAP_LETT_LA.indexOf(sMarkSona.charAt(i).toUpperCase()) &gt; -1)) {
                msAsendus = msAsendus + sMarkSona.charAt(i);
            }
        }
        spn_MsVal.innerText = sMSortVal;

        for (i = 0; i &lt; sMarkSona.length; i++) {
            intVal = sMarkSona.charCodeAt(i);
            msCodeStr = msCodeStr + &quot;[&lt;b&gt;&quot; + sMarkSona.charAt(i) + &quot;&lt;&#x2F;b&gt; U+&quot; + jsStrRepeat(4 - hex(intVal, true).length, &quot;0&quot;) + hex(intVal, true) + &quot;, &quot; + intVal + &quot;]&quot;;
        }
        showDbgVar(&quot;sMarkSona: msCodeStr&quot;, sMarkSona, &quot;XMLChanged&quot;, &quot; &quot;, msCodeStr, new Date())

        if ((oEditDOMRoot.firstChild.xml != oOrgArtNode.xml)) {
            spn_ArtModified.innerText = &quot;*&quot;;
            bArtModified = true;
        } else {
            spn_ArtModified.innerText = &quot;&quot;;
            bArtModified = false;
        }

        spn_UndoRedoIndex.innerText = urindex;
        spn_UndoRedoLast.innerText = urlast + 1;
        if ((urindex == 0)) {
            img_Undo.src = &quot;graphics&#x2F;back_grey 16-16.ico&quot;;
        } else {
            img_Undo.src = &quot;graphics&#x2F;back 16-16.ico&quot;;
        }
        if ((urindex == urlast)) {
            img_Redo.src = &quot;graphics&#x2F;forward_grey 16-16.ico&quot;;
        } else {
            img_Redo.src = &quot;graphics&#x2F;forward 16-16.ico&quot;;
        }

    } else {

        &#x2F;&#x2F;algus või deleted;
        sMarkSona = &quot;&quot;;
        msAsendus = &quot;&quot;;
        sMSortVal = &quot;&quot;;
        showDbgVar(&quot;sMarkSona: msCodeStr&quot;, sMarkSona + &quot;: &quot; + msCodeStr, &quot;XMLChanged&quot;, &quot; &quot;, &quot; &quot;, new Date());
        spn_MsVal.innerText = sMSortVal;
        spn_ArtModified.innerText = &quot;&quot;;
        spn_NodeInfo.innerText = &quot;&quot;;
        bArtSaveAllowed = false;
        bArtDelAllowed = false;
        bArtModified = false;
        artMuudatused = &quot;&quot;

    }
} &#x2F;&#x2F;XMLChanged


&#x2F;**
* 
* @method showDbgVar
* @param {String} varName
* @param {String} varVal
* @param {String} procName
* @param {String} idNr
* @param {String} idDesc
* @param {Object} praegu
*&#x2F;
function showDbgVar(varName, varVal, procName, idNr, idDesc, praegu) {

    var nrName = 0;
    var nrValue = 1;
    var nrProcName = 2;
    var nrIdNr = 3;
    var nrIdDesc = 4;
    var nrTime = 5

    var rowId;
    rowId = varName + &quot;_&quot; + procName;
    if ((idNr != &quot; &quot;)) {
        rowId = rowId + &quot;_&quot; + idNr;
    }

    var varRow, varCell
    varRow = oDbgTable.all(rowId)

    if ((varRow == null)) {

        varRow = oDbgTable.insertRow();
        varRow.id = rowId

        varCell = varRow.insertCell() &#x2F;&#x2F;nimi;
        varCell.className = &quot;hd&quot;;
        varCell = varRow.insertCell() &#x2F;&#x2F;väärtus;
        varCell = varRow.insertCell() &#x2F;&#x2F;protseduuri nimi;
        varCell = varRow.insertCell() &#x2F;&#x2F;number;
        varCell = varRow.insertCell() &#x2F;&#x2F;kirjeldus;
        varCell = varRow.insertCell() &#x2F;&#x2F;aeg

    }

    varRow.cells(nrName).innerText = varName;
    varRow.cells(nrValue).innerText = varVal;
    varRow.cells(nrProcName).innerText = procName;
    varRow.cells(nrIdNr).innerText = idNr;
    varRow.cells(nrIdDesc).innerHTML = idDesc;
    varRow.cells(nrTime).innerText = praegu.toString();

} &#x2F;&#x2F;showDbgVar


&#x2F;**
* 
* @method getLemmasForSyn
* @param {String} sqna
* @returns {String} 
*&#x2F;
function getLemmasForSyn(sqna) {
    var leitud;
    var lsd, sl;
    var tulemus, lemmaRead, lemmaRida, lemma, i, j, k

    &#x2F;&#x2F;Sätete lehel ei saa väljundkuju osas muud valida kui &quot;vorminimi&quot;
    &#x2F;&#x2F;nt:
    &#x2F;&#x2F;
    &#x2F;&#x2F;jõul =jõu  (SgAd  &gt;jõud !22_S
    &#x2F;&#x2F;jõul =jõul  (ID  &gt;jõul !41_K
    &#x2F;&#x2F;jõul =jõul  (SgN  &gt;jõul !22_S
    &#x2F;&#x2F;&#x27;
    &#x2F;&#x2F;jõulud =jõulu  (PlN  &gt;jõul !22_S
    &#x2F;&#x2F;
    &#x2F;&#x2F;aastane =aastane  (SgN  &gt;aastane !10_A
    &#x2F;&#x2F;aastane =aastane  (SgN  &gt;aastane !12_A
    &#x2F;&#x2F;
    &#x2F;&#x2F;elama =ela  (Sup  &gt;elama !27_V
    &#x2F;&#x2F;
    &#x2F;&#x2F;# ----------
    &#x2F;&#x2F;taaskohtama =kohta  (Sup  &gt;taas+kohtama !29_V
    &#x2F;&#x2F;
    &#x2F;&#x2F;?taaskohtatama =taaskohta  (SupIps  &gt;taaskohtama !27_V
    &#x2F;&#x2F;?taaskohtatama =taaskohtata  (Sup  &gt;taaskohtatama !27_V
    &#x2F;&#x2F;?taaskohtatama =taaskohtatama  (SgG  &gt;taaskohtatam !02_A
    &#x2F;&#x2F;# ----------
    &#x2F;&#x2F;?taaskohtatama =atama  (SgG  &gt;taas+koht+atam !02_A
    &#x2F;&#x2F;?taaskohtatama =kohtata  (Sup  &gt;taas+kohtatama !27_V
    &#x2F;&#x2F;
    &#x2F;&#x2F;### exama

    tulemus = eelexSWCtl.analyysi(sqna, ma_tul, ma_ls, ma_sqn, ma_vkkuju);
    if ((jsLeft(tulemus, 4) == &quot;### &quot;)) {
        alert(&quot;Lemma ei ole reeglitega lubatud!&quot;, jsvbCritical, sqna);
        return &#x27;&#x27;;
    }
    leitud = new Array();
    lsd = 0; &#x2F;&#x2F;liitsõnad;
    lemmaRead = tulemus.split(&#x27;\r\n&#x27;);
    for (i = 0; i &lt; lemmaRead.length; i++) {
        lemmaRida = jsTrim(lemmaRead[i]);
        sl = &quot;&quot;; &#x2F;&#x2F;&#x27;sõnaliik;
        j = lemmaRida.lastIndexOf(&quot;_&quot;);
        if ((j &gt; 0)) {
            sl = jsTrim(jsMid(lemmaRida, j + 1));
        }
        if ((jsLeft(lemmaRida, 3) == &quot;# -&quot;)) {
            lsd = 1;
        }
        j = lemmaRida.indexOf(&quot;(SgN  &gt;&quot;);
        if ((j &gt; 0)) {
            lemma = jsMid(lemmaRida, j + 7);
            lemma = jsTrim(jsMid(lemma, 0, lemma.indexOf(&quot;!&quot;)));
            if ((lsd == 1)) {
                if ((sqna == jsReplace(lemma, &quot;+&quot;, &quot;&quot;))) {
                    k = lemma.lastIndexOf(&quot;+&quot;);
                    lemma = jsMid(lemma, k) &#x2F;&#x2F;koos plussiga;
                }
            }
            if ((jsLeft(lemmaRida, 1) == &quot;?&quot;)) {
                lemma = &quot;?&quot; + lemma;
            }
            leitud.push(lemma);
        }
        j = lemmaRida.indexOf(&quot;(PlN  &gt;&quot;);
        if ((j &gt; 0)) {
            lemma = jsMid(lemmaRida, j + 7);
            lemma = jsTrim(jsMid(lemma, 0, lemma.indexOf(&quot;!&quot;)));
            if ((lsd == 1)) {
                k = lemma.lastIndexOf(&quot;+&quot;);
                lemma = jsMid(lemma, k) &#x2F;&#x2F;koos plussiga;
            }
            if ((jsLeft(lemmaRida, 1) == &quot;?&quot;)) {
                lemma = &quot;?&quot; + lemma;
            }
            lemma = &quot;¡&quot; + lemma; &#x2F;&#x2F;&#x27;pl märkimiseks &lt;vk&gt; - s;
            leitud.push(lemma);
        }
        j = lemmaRida.indexOf(&quot;(Sup  &gt;&quot;); &#x2F;&#x2F;&#x27;V - tegusõnad;
        if ((j &gt; 0)) {
            lemma = jsMid(lemmaRida, j + 7);
            lemma = jsTrim(jsMid(lemma, 0, lemma.indexOf(&quot;!&quot;)));
            if ((lsd == 1)) {
                k = lemma.lastIndexOf(&quot;+&quot;);
                lemma = jsMid(lemma, k) &#x2F;&#x2F;koos plussiga;
            }
            if ((jsLeft(lemmaRida, 1) == &quot;?&quot;)) {
                lemma = &quot;?&quot; + lemma;
            }
            leitud.push(lemma);
        }
    }
    tulemus = JR;  &#x2F;&#x2F;JR = ChrW(&amp;HE001);
    for (i = 0; i &lt; leitud.length; i++) {
        if ((tulemus.indexOf(JR + leitud[i] + JR) &lt; 0)) {
            tulemus = tulemus + leitud[i] + JR;
        }
    }
    tulemus = jsMid(tulemus, 1);
    if ((tulemus.length &gt; 0)) {
        tulemus = jsMid(tulemus, 0, tulemus.length - 1);
    } else {
        tulemus = sqna;
    }
    return tulemus;
} &#x2F;&#x2F;getLemmasForSyn


&#x2F;**
* 
* @method lisa_KL_TL_PT 
*&#x2F;
function lisa_KL_TL_PT() {
    &#x2F;&#x2F;see kutsutakse välja &#x27;FillArtFrames&#x27; - st peale bArtSaveAllowed, bArtDelAllowed määramist
    var i, delimwidth, delimline;
    delimwidth = div_ArtToolsMenu.style.pixelWidth &#x2F; 16;
    delimline = &quot;&quot;;
    for (i = 0; i &lt; delimwidth; i++) {
        delimline = delimline + EN_DASH;
    }

    var sArtToolsMenu = &quot;&quot;;
    &#x2F;&#x2F;FillArtFrames - == pannakse salvestamise õigused paika
    &#x2F;&#x2F;teine toimetaja EI SAA TL märget maha võtta (ei ole &#x27;bArtSaveAllowed&#x27;)
    &#x2F;&#x2F;peatoimetaja SAAB teise toimetaja TL märke maha võtta (on &#x27;bArtSignAllowed&#x27;)
    if (bArtSaveAllowed || bArtSignAllowed) {
        &#x2F;&#x2F;koostamise lõpp;
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idKoostamiseLopp&#x27; value=&#x27;idKoostamiseLopp&#x27;&gt;&quot; + &quot;&lt;td&gt;Lisa koostamise lõpu märge&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idRemKoostamiseLopp&#x27; value=&#x27;idRemKoostamiseLopp&#x27;&gt;&quot; + &quot;&lt;td&gt;Eemalda koostamise lõpu märge&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        &#x2F;&#x2F;toimetamise lõpp;
        if (dic_desc == &#x27;elt&#x27;) {
            sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;dl&#x27;&gt;&lt;td&gt;&quot; + delimline + &quot;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&quot;;
            sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idCompleteEntryLatvian&#x27; value=&#x27;idCompleteEntryLatvian&#x27;&gt;&lt;td&gt;Lisa LÄTI osa toimetamise lõpu märge&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&quot;;
            sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idRemCompleteEntryLatvian&#x27; value=&#x27;idRemCompleteEntryLatvian&#x27;&gt;&lt;td&gt;Eemalda LÄTI osa toimetamise lõpu märge&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&quot;;
            sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;dl&#x27;&gt;&lt;td&gt;&quot; + delimline + &quot;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&quot;;
            sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idCompleteEntryEstonian&#x27; value=&#x27;idCompleteEntryEstonian&#x27;&gt;&lt;td&gt;Lisa EESTI osa toimetamise lõpu märge&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&quot;;
            sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idRemCompleteEntryEstonian&#x27; value=&#x27;idRemCompleteEntryEstonian&#x27;&gt;&lt;td&gt;Eemalda EESTI osa toimetamise lõpu märge&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&quot;;
        } else {
            sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;dl&#x27;&gt;&lt;td&gt;&quot; + delimline + &quot;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&quot;;
            sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idCompleteEntry&#x27; value=&#x27;idCompleteEntry&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + MARK_AS_COMPLETE + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
            sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idRemCompleteEntry&#x27; value=&#x27;idRemCompleteEntry&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + REM_MARK_AS_COMPLETE + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        }
    }
    &#x2F;&#x2F;bArtSignAllowed: srtegija ja ptd hulgas
    &#x2F;&#x2F;teine peatoimetaja SAAB PT märke maha võtta (on &#x27;bArtSignAllowed&#x27;)
    if (bArtSignAllowed) {
        if (sArtToolsMenu) {
            sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;dl&#x27;&gt;&lt;td&gt;&quot; + delimline + &quot;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&quot;;
        }
        &#x2F;&#x2F;peatoimetaja märge;
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idSignEntry&#x27; value=&#x27;idSignEntry&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + SIGN_ENTRY + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idRemSignEntry&#x27; value=&#x27;idRemSignEntry&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + REM_SIGN_ENTRY + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    }

    if (sArtToolsMenu) {
        div_ArtToolsMenu.innerHTML = div_ArtToolsMenu.innerHTML + &quot;&lt;table id=&#x27;tbl_ArtToolsMenu_KL_TL_PT&#x27; width=&#x27;100%&#x27; border=&#x27;0&#x27; cellSpacing=&#x27;0&#x27;&gt;&quot; + sArtToolsMenu + &quot;&lt;&#x2F;table&gt;&quot;;
    }
} &#x2F;&#x2F;lisa_KL_TL_PT


&#x2F;**
* 
* @method lisaVeelArtToolse 
*&#x2F;
function lisaVeelArtToolse() {
    &#x2F;&#x2F;see kutsutakse välja &#x27;FillArtFrames&#x27; - st peale bArtSaveAllowed, bArtDelAllowed määramist

    var i, delimwidth, delimline;
    delimwidth = div_ArtToolsMenu.style.pixelWidth &#x2F; 16;
    delimline = &quot;&quot;;
    for (i = 0; i &lt; delimwidth; i++) {
        delimline = delimline + EN_DASH;
    }

    var sArtToolsMenu = &quot;&quot;;

    if (dic_desc == &quot;har&quot; || dic_desc == &quot;geo&quot;) {
        &#x2F;&#x2F;--------------------------------------------------------------------------------
        &#x2F;&#x2F; Eesmärk : ToolsMenusse valikute loomine
        &#x2F;&#x2F; Loodud  : 10.04.2009 10:50 ATeesalu
        &#x2F;&#x2F; Muutis  : 13.04.2009 10:20 ATeesalu
        &#x2F;&#x2F;--------------------------------------------------------------------------------
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idDictionaryEntry&#x27; value=&#x27;idDictionaryEntry&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ENTRY_DICTIONARY + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idDatabaseEntry&#x27; value=&#x27;idDatabaseEntry&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ENTRY_DATABASE + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    } else if (dic_desc == &quot;ukr&quot;) {
        &#x2F;&#x2F;--------------------------------------------------------------------------------
        &#x2F;&#x2F; Eesmärk : ToolsMenusse valikute loomine
        &#x2F;&#x2F; Loodud  : 01.12.2009 10:50 ATeesalu
        &#x2F;&#x2F; Muutis  : 01.12.2009 10:20 ATeesalu
        &#x2F;&#x2F;--------------------------------------------------------------------------------
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idDictionaryEntryUkr&#x27; value=&#x27;idDictionaryEntryUkr&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ENTRY_DICTIONARY_UKR + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idDatabaseEntryUkr&#x27; value=&#x27;idDatabaseEntryUkr&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ENTRY_DATABASE_UKR + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    } else if (dic_desc == &quot;vsl&quot;) {
        &#x2F;&#x2F;--------------------------------------------------------------------------------
        &#x2F;&#x2F; Eesmärk : ToolsMenusse valikute loomine
        &#x2F;&#x2F; Loodud  : 19.01.2010 10:50 ATeesalu
        &#x2F;&#x2F; Muutis  : 19.01.2010 10:20 ATeesalu
        &#x2F;&#x2F;--------------------------------------------------------------------------------
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idDictionaryEntryVsl&#x27; value=&#x27;idDictionaryEntryVsl&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ENTRY_DICTIONARY_VSL + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idDatabaseEntryVsl&#x27; value=&#x27;idDatabaseEntryVsl&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ENTRY_DATABASE_VSL + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    } else if (dic_desc == &quot;fin&quot;) {
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idDictionaryEntryVsl&#x27; value=&#x27;idDictionaryEntryFin&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ENTRY_DICTIONARY_FIN + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idDatabaseEntryVsl&#x27; value=&#x27;idDatabaseEntryFin&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ENTRY_DATABASE_FIN + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    } else if (dic_desc == &quot;ss1&quot;) {
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idDictionaryEntryVsl&#x27; value=&#x27;idDictionaryEntrySS1&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ENTRY_DICTIONARY_SS1 + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idDatabaseEntryVsl&#x27; value=&#x27;idDatabaseEntrySS1&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ENTRY_DATABASE_SS1 + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    } else if (dic_desc == &quot;knr&quot;) {
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idDictionaryEntryVsl&#x27; value=&#x27;idDictionaryEntryKNR&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ENTRY_DICTIONARY_KNR + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idDatabaseEntryVsl&#x27; value=&#x27;idDatabaseEntryKNR&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ENTRY_DATABASE_KNR + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    } else if (dic_desc == &quot;ss_&quot;) {
        &#x2F;&#x2F;määra põhiartikliks;
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idMainEntry&#x27; value=&#x27;idMainEntry&#x27;&gt;&quot; + &quot;&lt;td&gt;Määra &#x27;põhiartikliks&#x27;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        &#x2F;&#x2F;määra allartikliks;
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idSubEntry&#x27; value=&#x27;idSubEntry&#x27;&gt;&quot; + &quot;&lt;td&gt;Määra &#x27;allartikliks&#x27;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    } else if (dic_desc == &quot;od_&quot;) {
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idAddEmptyEquiv&#x27; value=&#x27;idAddEmptyEquiv&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ADD_EMPTY_EQUIV + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idImportFromWord&#x27; value=&#x27;idImportFromWord&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + IMP_FROM_WORD + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    } else if (dic_desc == &quot;mar&quot;) {
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idDictionaryEntryVsl&#x27; value=&#x27;idDictionaryEntryEX&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ENTRY_DICTIONARY_EX + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    } else if (dic_desc == &quot;ex_&quot;) {
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idDictionaryEntryVsl&#x27; value=&#x27;idDictionaryEntryEX&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ENTRY_DICTIONARY_EX + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    } else if (dic_desc == &quot;eos&quot;) {
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idDictionaryEntryVsl&#x27; value=&#x27;idDictionaryEntryEX&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + ENTRY_DICTIONARY_EX + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    }

    if (sArtToolsMenu) {
        sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;dl&#x27;&gt;&lt;td&gt;&quot; + delimline + &quot;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&quot;;
    }
    &#x2F;&#x2F; vii teise köitesse (sihtköite kontrolliga)
    sArtToolsMenu = sArtToolsMenu + &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;idMoveToVolume&#x27; value=&#x27;idMoveToVolume&#x27;&gt;&lt;td&gt;Vii teise köitesse&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&quot;;

    if (sArtToolsMenu) {
        if (div_ArtToolsMenu.innerHTML) {
            sArtToolsMenu = &quot;&lt;tr class=&#x27;dl&#x27;&gt;&lt;td&gt;&quot; + delimline + &quot;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&quot; + sArtToolsMenu;
        }
        div_ArtToolsMenu.innerHTML = div_ArtToolsMenu.innerHTML + &quot;&lt;table id=&#x27;tbl_ArtToolsMenu_veelArtToolse&#x27; width=&#x27;100%&#x27; border=&#x27;0&#x27; cellSpacing=&#x27;0&#x27;&gt;&quot; + sArtToolsMenu + &quot;&lt;&#x2F;table&gt;&quot;;
    }
} &#x2F;&#x2F;lisaVeelArtToolse


&#x2F;**
* 
* @method showArtHistory 
*&#x2F;
function showArtHistory() {
    var oSrc, nX, nY, nVerGap
    oSrc = window.event.srcElement;
    nVerGap = 4 &#x2F;&#x2F;oSrc border &quot;thin&quot; (2?) ja parent TD padding (2?);
    nX = window.event.clientX + 2 * oSrc.offsetWidth;
    nY = window.event.screenY - window.screenTop - window.event.offsetY - oSrc.offsetTop - nVerGap;
    div_ArtHistoryMenu.style.pixelLeft = nX;
    div_ArtHistoryMenu.style.pixelTop = nY;
    div_ArtHistoryMenu.style.display = &quot;&quot;;
    div_ArtHistoryMenu.style.cursor = &quot;default&quot;;
    div_ArtHistoryMenu.setCapture();
} &#x2F;&#x2F;showArtHistory


&#x2F;**
* 
* @method ClickArtHistoryMenu 
*&#x2F;
function ClickArtHistoryMenu() {
    var sCFP, rida, artGuid, volId, veerg, sPrmDomXml, oPrmDom, oSrc;
    sCFP = div_ArtHistoryMenu.componentFromPoint(window.event.clientX, window.event.clientY);
    if ((jsLeft(sCFP, 6) == &quot;scroll&quot;)) {
        div_ArtHistoryMenu.doScroll(sCFP);
    } else if ((sCFP == &quot;&quot;)) {
        document.releaseCapture();
        oSrc = window.event.srcElement;
        if ((oSrc.tagName == &quot;TD&quot;)) {
            if ((salvestaJaKatkesta())) {
                return;
            }
            rida = oSrc.parentElement;
            artGuid = rida.id;
            volId = rida.getAttribute(&quot;v&quot;);
            sCmdId = &quot;BrowseRead&quot;; &#x2F;&#x2F;&#x27;sCmdId - globaalne;
            veerg = rida.all.tags(&quot;TD&quot;)[0];
            sQryInfo = veerg.innerText &#x2F;&#x2F;sQryInfo - globaalne;

            sPrmDomXml = &quot;&lt;prm&gt;&quot; + &quot;&lt;cmd&gt;&quot; + sCmdId + &quot;&lt;&#x2F;cmd&gt;&quot; + &quot;&lt;vol&gt;&quot; + volId + &quot;&lt;&#x2F;vol&gt;&quot; + &quot;&lt;nfo&gt;&quot; + sQryInfo + &quot;&lt;&#x2F;nfo&gt;&quot; + &quot;&lt;G&gt;&quot; + artGuid + &quot;&lt;&#x2F;G&gt;&quot; + &quot;&lt;qM&gt;MySql&lt;&#x2F;qM&gt;&quot; + &quot;&lt;&#x2F;prm&gt;&quot;;
            oPrmDom = IDD(&quot;String&quot;, sPrmDomXml, false, false, null);
            StartOperation(oPrmDom);
        }
    } else if ((sCFP == &quot;outside&quot;)) {
        document.releaseCapture();
    }
} &#x2F;&#x2F;ClickArtHistoryMenu



&#x2F;**
* 
* @method salvestaJaKatkesta 
* @returns {Boolean}
*&#x2F;
function salvestaJaKatkesta() {
    var salvestaJaKatkesta = false;
    if ((bArtModified &amp;&amp; bArtSaveAllowed)) {

        var oArtBackup, avatavad;
        oArtBackup = oEditDOMRoot.firstChild.cloneNode(true);
        avatavad = oArtBackup.selectNodes(&quot;.&#x2F;&#x2F;*&#x2F;@&quot; + DICPR + &quot;:edO&quot;);
        avatavad.removeAll();
        &#x2F;&#x2F;mõlemad on nüüd &quot;@edO&quot; -st puhtad;
        if ((oOrgArtNode.xml == oArtBackup.xml)) {
            return false;
        }

        var bRet = confirm(SAVE_CHANGES_Q);
        if ((bRet)) {
            imgArtSaveClick();
            salvestaJaKatkesta = true;
        } else {
            var midagi;
            &#x2F;&#x2F;*&#x2F;*&#x2F; korral jäävad G, K, KA jt välja;
            midagi = oEditDOMRoot.firstChild.selectSingleNode(&quot;*&#x2F;&#x2F;*[name() != &#x27;&quot; + qn_ms + &quot;&#x27;][normalize-space(text()) != &#x27;&#x27;]&quot;);
            if ((midagi == null)) {
                nRetBtn = confirm(&quot;Artiklist on olemas ainult märksõna, kuid artikkel EI OLE SALVESTATUD.&quot; + &#x27;\r\n\r\n&#x27; + &quot;Kas soovid artikli kustutada?&quot;);
                if ((nRetBtn == 6)) {
                    kustutaArtikkel();
                    salvestaJaKatkesta = true;
                }
            }
        }
    }
    return salvestaJaKatkesta;
} &#x2F;&#x2F;salvestaJaKatkesta



&#x2F;**
* 
* @method salvestaJaKatkesta 
* @param {String} sNewId Kontrolli andmetüüpi.
* @param {Boolean} sNewAttrValue Kontrolli andmetüüpi.
*&#x2F;
function SetSelectedInfo(sNewId, sNewAttrValue) {
    var tarr, tarr2;
    var oParticle, sEnu;
    var sXsdXPath, oXsdNode, sKirjeldav;
    var sSpnElemsMenuText, sSpnElemsMenuTitle;
    var importDOM, oType

    if (sSeldItemId) {
        if (sSeldAttrValue) {
            div_ElemsMenu.all(sSeldItemId.substr(0, sSeldItemId.lastIndexOf(&quot;&#x2F;&quot;))).className = &quot;mi&quot;;
        } else {
            div_ElemsMenu.all(sSeldItemId).className = &quot;mi&quot;;
        }
    }

    sSeldItemId = sNewId;

    if (sNewAttrValue) {
        div_ElemsMenu.all(sSeldItemId.substr(0, sSeldItemId.lastIndexOf(&quot;&#x2F;&quot;))).className = &quot;si&quot;;
        sSeldElemValue = div_ElemsMenu.all(sSeldItemId.substr(0, sSeldItemId.lastIndexOf(&quot;&#x2F;&quot;))).value;
    } else {
        div_ElemsMenu.all(sSeldItemId).className = &quot;si&quot;;
        sSeldElemValue = div_ElemsMenu.all(sSeldItemId).value;
    }
    sSeldAttrValue = sNewAttrValue


    mnuElemLang = &quot;&quot;;
    div_ElemEnumsMenu.innerHTML = &quot;&quot;;

    &#x2F;&#x2F;sSeldElemValue: qname|name|URI|IsElement|sKirjeldav
    tarr = sSeldElemValue.split(&quot;|&quot;);
    if (tarr[1]) { &#x2F;&#x2F; &#x27;name&#x27;
        if (!(yldStruDom == null)) {
            var yldStruElem;
            yldStruElem = yldStruDom.documentElement.selectSingleNode(sSeldItemId);
            if (!(yldStruElem == null)) {
                mnuElemLang = yldStruElem.transformNode(strLangXsl);
            }
        }
        oParticle = oSchRootElems.itemByQName(tarr[1], tarr[2]);
        if ((oParticle.type.enumeration.length &gt; 0)) {
            updElemEnumsMenu();
        }
        if ((oParticle.type.itemType == SOMITEM_COMPLEXTYPE)) {
            if ((oParticle.type.contentType == SCHEMACONTENTTYPE_TEXTONLY)) {
                sel_queryType.selectedIndex = 2 &#x2F;&#x2F;id = text(), MySql tekstides on ainult elemendi enda tekstid;
            } else if ((oParticle.type.contentType == SCHEMACONTENTTYPE_ELEMENTONLY)) {
                sel_queryType.selectedIndex = 1 &#x2F;&#x2F;id = self::node(): &quot;.&quot;;
            } else if ((oParticle.type.contentType == SCHEMACONTENTTYPE_MIXED)) {
                sel_queryType.selectedIndex = 2 &#x2F;&#x2F;id = text(), MySql tekstides on ainult elemendi enda tekstid;
            } else {
                sel_queryType.selectedIndex = 1 &#x2F;&#x2F;id = self::node(): &quot;.&quot;;
            }
        } else {
            &#x2F;&#x2F; if ((oParticle.type.itemType == SOMITEM_SIMPLETYPE))
            sel_queryType.selectedIndex = 1 &#x2F;&#x2F;id = self::node();
        }
    } else {
        sel_queryType.selectedIndex = 1; &#x2F;&#x2F;id = self::node();
    }
    if (div_ElemEnumsMenu.innerHTML != &quot;&quot;) {
        img_ElemEnumsMenu.src = &quot;graphics&#x2F;downarrow 16-16.ico&quot;;
        img_ElemEnumsMenu.disabled = false;
    } else {
        img_ElemEnumsMenu.src = &quot;graphics&#x2F;downarrow_grey 16-16.ico&quot;;
        img_ElemEnumsMenu.disabled = true;
    }
    sSpnElemsMenuText = tarr[4]; &#x2F;&#x2F; &#x27;sKirjeldav&#x27;
    if (tarr[3] == &quot;1&quot;) { &#x2F;&#x2F; &#x27;IsElement&#x27;
        sSpnElemsMenuTitle = sSeldItemId;
    } else {
        sSpnElemsMenuTitle = tarr[0]; &#x2F;&#x2F; &#x27;qname&#x27;
    }

    &#x2F;&#x2F;atribuutide enum-id
    div_AttrEnumsMenu.innerHTML = &quot;&quot;;

    if (sSeldAttrValue) {
        &#x2F;&#x2F;sSeldAttrValue: qname|name|URI|IsElement|sKirjeldav;
        tarr2 = sSeldAttrValue.split(&quot;|&quot;);
        if (tarr2[1]) { &#x2F;&#x2F; &#x27;name&#x27;
            updAttrEnumsMenu();
        }
        sSpnElemsMenuText = sSpnElemsMenuText + &quot; &quot; + AND_WORD.toUpperCase() + &quot; &quot; + tarr2[4]; &#x2F;&#x2F; &#x27;sKirjeldav&#x27;
        if (tarr[3] == &quot;0&quot;) { &#x2F;&#x2F; &#x27;IsElement&#x27;
            sSpnElemsMenuTitle = sSpnElemsMenuTitle + &quot; &#x2F;&quot; + tarr2[0]; &#x2F;&#x2F; &#x27;qname&#x27;
        }
        &#x2F;&#x2F;atribuudi väärtuse textbox;
        inp_AttrText.style.backgroundColor = &quot;&quot;;
        inp_AttrText.disabled = false;
        inp_AttrText.setActive();
        inp_AttrText.focus();
        inp_AttrText.select();
    } else {
        inp_AttrText.style.backgroundColor = &quot;silver&quot;;
        inp_AttrText.disabled = true;
        inp_ElemText.setActive();
        inp_ElemText.focus();
        inp_ElemText.select();
    }
    if (div_AttrEnumsMenu.innerHTML != &quot;&quot;) {
        img_AttrEnumsMenu.src = &quot;graphics&#x2F;downarrow 16-16.ico&quot;;
        img_AttrEnumsMenu.disabled = false;
    } else {
        img_AttrEnumsMenu.src = &quot;graphics&#x2F;downarrow_grey 16-16.ico&quot;;
        img_AttrEnumsMenu.disabled = true;
    }
    spn_ElemsMenu.innerText = sSpnElemsMenuText;
    spn_ElemsMenu.title = sSpnElemsMenuTitle + &quot; [&quot; + mnuElemLang + &quot;]&quot;;

    if (sSeldItemId.substr(0, &quot;mySqlYhisedMs&quot;.length) == &quot;mySqlYhisedMs&quot;) {
        if (sSeldAttrValue) {
            var mTekst = jsTrim(inp_ElemText.value);
            if (!mTekst) {
                mTekst = &quot;*&quot;;
            }
            var selectedDics = &#x27;;&#x27; + dic_desc + &#x27;;&#x27; + tarr2[0] + &#x27;;&#x27;;
            var search = &quot;cmd=yhised&amp;ms=&quot; + encodeURIComponent(RemoveSymbols(mTekst, &#x27; *?&#x27;)) + &quot;&amp;dics=&quot; + selectedDics;
            &#x2F;&#x2F; eelex.eki.ee või eelex.dyn.eki.ee
            window.open(&quot;http:&#x2F;&#x2F;&quot; + location.hostname + &quot;&#x2F;run&#x2F;SL&#x2F;Koond&#x2F;Koond.html?&quot; + search, &quot;_koondParingYhised&quot;, &quot;&quot;, false);
        }
    }

} &#x2F;&#x2F;SetSelectedInfo


&#x2F;**
* 
* @method getEnumsHTML 
* @param {Object} osake
* @returns {String}
*&#x2F;
function getEnumsHTML(osake) {
    var tyyp, xPath, dlXPath, tyybiDom, sEnu, enumDocnNode, kirjeldav, enumRows;
    if ((osake.type.name == &quot;&quot;)) { &#x2F;&#x2F;&#x27;complexType
        tyyp = osake.type.baseTypes[0];
    } else {
        tyyp = osake.type;
    }
    xPath = &quot;.&#x2F;&#x2F;xs:simpleType[@name = &#x27;&quot; + tyyp.name + &quot;&#x27;]&#x2F;&#x2F;xs:enumeration[@value = &#x27;[%s]&#x27;]&#x2F;xs:annotation&#x2F;xs:documentation[@xml:lang = &#x27;&quot; + sAppLang + &quot;&#x27;]&quot;;
    dlXPath = &quot;.&#x2F;&#x2F;xs:simpleType[@name = &#x27;&quot; + tyyp.name + &quot;&#x27;]&#x2F;&#x2F;xs:enumeration[@value = &#x27;[%s]&#x27;]&#x2F;xs:annotation&#x2F;xs:documentation[@xml:lang = &#x27;&quot; + dest_language + &quot;&#x27;]&quot;;
    if ((tyyp.namespaceURI != DICURI)) {
        tyybiDom = IDD(&quot;File&quot;, &quot;xsd&#x2F;&quot; + impSchemaLocations.Item(tyyp.namespaceURI), false, false, null);
        tyybiDom.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
        tyybiDom.setProperty(&quot;SelectionNamespaces&quot;, jsTrim(sXsdNsList));
    } else {
        tyybiDom = oXsdDOM;
    }
    enumRows = &quot;&quot;;
    for (i = 0; i &lt; osake.type.enumeration.length; i++) {
        sEnu = osake.type.enumeration[i];
        enumDocnNode = tyybiDom.documentElement.selectSingleNode(jsReplace(xPath, &quot;[%s]&quot;, sEnu));
        if (!(enumDocnNode == null)) {
            kirjeldav = enumDocnNode.text;
            if (!(dest_language == &quot;&quot;)) {
                enumDocnNode = tyybiDom.documentElement.selectSingleNode(jsReplace(dlXPath, &quot;[%s]&quot;, sEnu));
                if (!(enumDocnNode == null)) {
                    kirjeldav = kirjeldav + &quot; &#x2F; &quot; + enumDocnNode.text;
                }
            }
        } else {
            kirjeldav = sEnu;
        }
        enumRows = enumRows + &quot;&lt;tr class=&#x27;mi&#x27; &quot; + &quot;id=&#x27;&quot; + sEnu + &quot;&#x27; &quot; + &quot;value=&#x27;&quot; + sEnu + &quot;&#x27;&quot; + &quot;title=&#x27;&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + sEnu + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;td&gt;&quot; + kirjeldav + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
    }
    return enumRows;
} &#x2F;&#x2F;getEnumsHTML


&#x2F;**
* 
* @method updElemEnumsMenu 
*&#x2F;
function updElemEnumsMenu() {
    var sEnumItems, oParticle, tarr;
    sEnumItems = &quot;&quot;

    &#x2F;&#x2F;sSeldElemValue: qname|name|URI|IsElement|sKirjeldav
    tarr = sSeldElemValue.split(&quot;|&quot;)
    oParticle = oSchRootElems.itemByQName(tarr[1], tarr[2]);
    sEnumItems = getEnumsHTML(oParticle);
    div_ElemEnumsMenu.innerHTML = &quot;&lt;table id=&#x27;tbl_ElemEnumsMenu&#x27; width=&#x27;100%&#x27; border=&#x27;0&#x27; cellSpacing=&#x27;0&#x27;&gt;&quot; + sEnumItems + &quot;&lt;&#x2F;table&gt;&quot;;
    &#x2F;&#x2F;    if ((div_ElemEnumsMenu.all.tags(&quot;TR&quot;).length &gt; maxEnumRows)) {
    div_ElemEnumsMenu.style.height = &quot;480px&quot;;
    &#x2F;&#x2F;    } else {
    &#x2F;&#x2F;        div_ElemEnumsMenu.style.height = &quot;&quot;;
    &#x2F;&#x2F;    }
} &#x2F;&#x2F;updElemEnumsMenu


&#x2F;**
* 
* @method updAttrEnumsMenu 
*&#x2F;
function updAttrEnumsMenu() {
    var sEnumItems, oParticle, tarr;
    sEnumItems = &quot;&quot;

    &#x2F;&#x2F;sSeldAttrValue: qname|name|URI|IsElement|sKirjeldav
    tarr = sSeldAttrValue.split(&quot;|&quot;);
    if ((tarr[1] == &quot;lang&quot; &amp;&amp; tarr[2] == NS_XML)) { &#x2F;&#x2F;&#x27;xml:lang
        sEnumItems = getEnumRows();
    } else {
        oParticle = oSchRootAttrs.itemByQName(tarr[1], tarr[2]);
        if ((oParticle.type.enumeration.length &gt; 0)) {
            sEnumItems = getEnumsHTML(oParticle);
        }
    }

    if ((sEnumItems.length &gt; 0)) {
        div_AttrEnumsMenu.innerHTML = &quot;&lt;table id=&#x27;tbl_AttrEnumsMenu&#x27; width=&#x27;100%&#x27; border=&#x27;0&#x27; cellSpacing=&#x27;0&#x27;&gt;&quot; + sEnumItems + &quot;&lt;&#x2F;table&gt;&quot;;
        if ((div_AttrEnumsMenu.all.tags(&quot;TR&quot;).length &gt; maxEnumRows)) {
            div_AttrEnumsMenu.style.height = &quot;480px&quot;;
        } else {
            div_AttrEnumsMenu.style.height = &quot;&quot;;
        }
    }
} &#x2F;&#x2F;updAttrEnumsMenu


&#x2F;**
* 
* @method ShowAdminView 
*&#x2F;
function ShowAdminView() {
    var smdArgs, retVal, artGuid, sLinkVols, volId, opt;
    artGuid = &quot;&quot;;
    if ((oEditDOMRoot.hasChildNodes()))
        artGuid = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + qn_guid).text;
    sLinkVols = &quot;&quot;;
    volId = &quot;&quot;;
    for (i = 0; i &lt; sel_Vol.options.length; i++) {
        opt = sel_Vol.options[i];
        if ((opt.id == dic_desc + &quot;All&quot;)) {
            break;
        }
        sLinkVols = sLinkVols + &quot;&lt;option id=&#x27;&quot; + opt.id + &quot;&#x27;&quot;;
        if ((opt.selected == true)) {
            sLinkVols = sLinkVols + &quot; selected&quot;;
            volId = opt.id;
        }
        sLinkVols = sLinkVols + &quot;&gt;&quot; + opt.text + &quot;&lt;&#x2F;option&gt;&quot;;
    }

    &#x2F;&#x2F; sDicName - &#x27;lexlist.xml&#x27; failist pannakse &#x27;art.cgi&#x27; kaudu serverist kaasa &#x27;spn_SrvParms&#x27; kaudu
    smdArgs = dic_desc + JR + sUsrName + JR + sAppLang + JR +
            sDicName + JR +
            sMarkSona + JR +
            artGuid + JR +
            sLinkVols + JR +
            volId + JR +
            gendXslNimi;
    retVal = window.showModalDialog(&quot;html&#x2F;gen_view.htm&quot;, smdArgs, &quot;dialogHeight:768;dialogWidth:1024;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:no;unadorned:no&quot;);

    if (retVal) {

        initViewTransform(1);

        if (oEditDOMRoot.hasChildNodes())
            vaatedRefresh(1);

        window.status = &quot;Vaate uuendamine OK (&quot; + retVal + &quot;)!&quot;;
    }
} &#x2F;&#x2F;ShowAdminView


&#x2F;**
* 
* @method ShowSkeemiGen 
*&#x2F;
function ShowSkeemiGen() {
    var smdArgs, retVal;
    smdArgs = new Array(dic_desc, sUsrName, sAppLang);
    retVal = window.showModalDialog(&quot;html&#x2F;gen_skeem.htm&quot;, smdArgs, &quot;dialogHeight:640px;dialogWidth:1100px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:yes;unadorned:no&quot;);
    if (retVal) {
        var sXSDFile;
        sXSDFile = &quot;xsd&#x2F;schema_&quot; + dic_desc + &quot;.xsd&quot;;
        oXsdDOM = IDD(&quot;File&quot;, sXSDFile, false, false, null);
        oXsdDOM.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
        oXsdDOM.setProperty(&quot;SelectionNamespaces&quot;, jsTrim(sXsdNsList))

        oXsdSc = new ActiveXObject(&quot;Msxml2.XMLSchemaCache.6.0&quot;);
        oXsdSc.validateOnLoad = true;
        oXsdSc.add(DICURI, sXSDFile)

        oEditDOM = IDD(&quot;String&quot;, oEditDOM.xml, false, false, oXsdSc);
        oEditDOM.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
        oEditDOM.setProperty(&quot;SelectionNamespaces&quot;, sXmlNsList);
        oEditDOMRoot = oEditDOM.documentElement

        oXmlSc = oEditDOM.namespaces

        oSchRootElems = oXmlSc.getSchema(DICURI).elements;
        oSchRootAttrs = oXmlSc.getSchema(DICURI).attributes

        &#x2F;&#x2F;üldstruktuur
        yldStruDom = IDD(&quot;File&quot;, &quot;xml&#x2F;&quot; + dic_desc + &quot;&#x2F;stru_&quot; + dic_desc + &quot;.xml&quot;, false, false, oXsdSc);
        if (yldStruDom.parseError.errorCode != 0) {
            yldStruDom = null;
        } else {
            yldStruDom.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
            yldStruDom.setProperty(&quot;SelectionNamespaces&quot;, jsTrim(sXsdNsList) + &quot; xmlns:&quot; + SDPR + &quot;=&#x27;&quot; + SDURI + &quot;&#x27;&quot;);
        }

        FillElementsMenu();
        SetSelectedInfo(default_query, &quot;&quot;);
        sqnastikuTooriistad();

        initEditTransform();

        var xh, rspDOM, sta, status, myCSS;
        var editCssHREF = &quot;css&#x2F;gendEdit_&quot; + dic_desc + &quot;.css&quot;;
        xh = exCGISync(&quot;tools.cgi&quot;, &quot;getTextFileContent&quot; + PD + dic_desc + PD + sUsrName + PD +
                    editCssHREF);
        if (xh.statusText == &quot;OK&quot;) {
            rspDOM = IDD(&quot;&quot;, &quot;&quot;, false, false, null);
            sta = rspDOM.load(xh.responseXML); &#x2F;&#x2F;&#x27;responseXML: TypeName = DomDocument

            if (sta) {
                status = rspDOM.selectSingleNode(&quot;rsp&#x2F;sta&quot;).text;
                if (status == &quot;Success&quot;) {
                    myCSS = rspDOM.selectSingleNode(&quot;rsp&#x2F;answer&quot;).text;
                    editCSS.cssText = myCSS;
                }
                else
                    alert(status);
            }
        }
        else {
            alert(xh.status + &quot;: &quot; + xh.statusText + xh.responseText);
        }

        if (oEditDOMRoot.hasChildNodes())
            vaatedRefresh(2);

        window.status = &quot;Skeemi uuendamine OK (&quot; + retVal + &quot;)!&quot;;
    }
} &#x2F;&#x2F;ShowSkeemiGen


&#x2F;**
* 
* @method FillElementsMenu 
*&#x2F;
function FillElementsMenu() {
    var oParticle, sItemURI, sItemQN;
    var sMaxSymbol, sSubMenu;
    var sXsdXPath, oXsdNode, sKirjeldav, sFullPath, sPr;

    oParticle = oXmlSc.getDeclaration(oEditDOMRoot)

    if (!(oParticle.namespaceURI == &quot;&quot;)) {
        sItemURI = oParticle.namespaceURI;
        sPr = oXmlNsm.getPrefixes(sItemURI).item(0);
        if ((sPr == &quot;&quot;)) {
            sItemQN = oParticle.name;
        } else {
            sItemQN = sPr + &quot;:&quot; + oParticle.name;
        }
    } else {
        sItemURI = &quot;&quot;;
        sItemQN = oParticle.name;
    }

    var nContentType, nGroupType, sDispType;
    if ((oParticle.type.itemType == SOMITEM_COMPLEXTYPE)) {
        nContentType = oParticle.type.contentType;
        if ((nContentType == SCHEMACONTENTTYPE_MIXED)) {
            sDispType = &quot;Ct,Mx&quot;;
        } else if ((nContentType == SCHEMACONTENTTYPE_ELEMENTONLY)) {
            sDispType = &quot;Ct,Eo&quot;;
        } else if ((nContentType == SCHEMACONTENTTYPE_TEXTONLY)) {
            sDispType = &quot;Ct,To&quot;;
        } else if ((nContentType == SCHEMACONTENTTYPE_EMPTY)) {
            sDispType = &quot;Ct, &quot;;
        }
        &#x2F;&#x2F;&quot;ISchemaComplexType&quot; korral peaks alati olema TypeName(oParticle.type.contentModel) = &quot;ISchemaModelGroup&quot; ?;
        nGroupType = oParticle.type.contentModel.itemType;
        if ((nGroupType == SOMITEM_EMPTYPARTICLE)) {
            sDispType = sDispType + &quot;, &quot;;
        } else if ((nGroupType == SOMITEM_SEQUENCE)) {
            sDispType = sDispType + &quot;,Sq&quot;;
        } else if ((nGroupType == SOMITEM_CHOICE)) {
            sDispType = sDispType + &quot;,Ch&quot;;
        } else if ((nGroupType == SOMITEM_ALL)) {
            sDispType = sDispType + &quot;,All&quot;;
        }
        if ((oParticle.type.attributes.length &gt; 0)) {
            sSubMenu = String.fromCharCode(&quot;0x&quot; + jsMid(BLACK_RIGHT_POINTING_POINTER, 3, 4));
        } else {
            sSubMenu = &quot;&quot;;
        }
    } else {
        &#x2F;&#x2F; if ((oParticle.type.itemType == SOMITEM_SIMPLETYPE))
        nContentType = -1;
        nGroupType = -1;
        sDispType = &quot;St&quot;;
    }

    if ((oParticle.maxOccurs == &quot;-1&quot;)) {
        sMaxSymbol = String.fromCharCode(&quot;0x&quot; + jsMid(eeLex_INFINITY, 3, 4));
    } else {
        sMaxSymbol = oParticle.maxOccurs;
    }
    sXsdXPath = &quot;.&#x2F;&#x2F;&quot; + NS_XS_PR + &quot;:element[@name=&#x27;&quot; + oParticle.name + &quot;&#x27;]&#x2F;&quot; + NS_XS_PR + &quot;:annotation&#x2F;&quot; + NS_XS_PR + &quot;:documentation[@xml:lang=&#x27;&quot; + sAppLang + &quot;&#x27;]&quot;
    oXsdNode = oXsdDOM.documentElement.selectSingleNode(sXsdXPath);
    if (!(oXsdNode == null)) {
        sKirjeldav = oXsdNode.text;
    } else {
        sKirjeldav = sItemQN;
    }
    sFullPath = sItemQN;

    div_ElemsMenu.innerHTML = &quot;&lt;table id=&#x27;tbl_ElementsMenu&#x27; width=&#x27;100%&#x27; border=&#x27;0&#x27; cellSpacing=&#x27;0&#x27;&gt;&lt;&#x2F;table&gt;&quot;;
    oElMenuTable = div_ElemsMenu.all(&quot;tbl_ElementsMenu&quot;);

    valmisParingud();

    aTTAPlokid = &#x27;;&#x27;;
    if (oParticle.type.itemType == SOMITEM_COMPLEXTYPE) {
        GetMenuElements(oParticle, &quot;&quot;, 0);
    }

} &#x2F;&#x2F;FillElementsMenu


&#x2F;**
* 
* @method GetMenuElements
* @param {Object} oISchItem
* @param {String} sFullPath
* @param {Int} nDepth
*&#x2F;
function GetMenuElements(oISchItem, sFullPath, nDepth) {
    var sItemURI, sItemQN;
    var nContentType, nGroupType, sDispType;
    var sMinSymbol, sMaxSymbol, sSubMenu, sXsdXPath, oXsdNode, sKirjeldav, sElemPath;
    var oXmlFrDom, sPr, sLName, aAnyNames;
    var sParentQN;
    var i;
    var oNewTableRow, oNewRowCell;
    var sRowVal

    if (!(oISchItem.namespaceURI == &quot;&quot;)) {
        sPr = oXmlNsm.getPrefixes(oISchItem.namespaceURI).item(0);
        if ((sPr == &quot;&quot;)) {
            sParentQN = oISchItem.name;
        } else {
            sParentQN = sPr + &quot;:&quot; + oISchItem.name;
        }
    } else {
        sParentQN = oISchItem.name;
    }

    var oFirstParticle
    oFirstParticle = oISchItem.type.contentModel.particles[0]

    var oParticle, nParticleCount, xh, oRespDom, sta;
    if ((oFirstParticle.itemType == SOMITEM_ANY)) {
        &#x2F;&#x2F;aa: &quot;add any&quot;;
        xh = exCGISync(&quot;tools.cgi&quot;, &quot;getAddElements&quot; + JR + dic_desc + JR + sUsrName + JR + &quot;xml&#x2F;&quot; + dic_desc + &quot;&#x2F;&quot; + JR + &quot;aa_&quot; + unName(sParentQN) + &quot;.xml&quot; + JR + &quot;&quot;);
        if ((xh.statusText == &quot;OK&quot;)) {
            oRespDom = xh.responseXML &#x2F;&#x2F;responseXML: TypeName = DomDocument;
            sta = oRespDom.selectSingleNode(&quot;rsp&#x2F;sta&quot;).text;
            if ((sta == &quot;Success&quot;)) {
                aAnyNames = oRespDom.selectSingleNode(&quot;rsp&#x2F;answer&quot;).text.split(&quot;|&quot;);
                nParticleCount = aAnyNames.length;
            }
        }
        &#x2F;&#x2F;   oXmlFrDom = IDD(&quot;file&quot;, &quot;xml&#x2F;&quot; + dic_desc + &quot;&#x2F;aa_&quot; + unName(sParentQN) + &quot;.xml&quot;,  false, false, null)
        if (!(sta == &quot;Success&quot;)) {
            sItemURI = NS_XS;
            sItemQN = NS_XS_PR + &quot;:any&quot;;
            sDispType = &quot;Any,-,-&quot;;
            sKirjeldav = sItemQN;
            oParticle = oFirstParticle;
            if ((oParticle.maxOccurs == &quot;-1&quot;)) {
                sMaxSymbol = String.fromCharCode(&quot;0x&quot; + jsMid(eeLex_INFINITY, 3, 4));
            } else {
                sMaxSymbol = oParticle.maxOccurs;
            }
            if ((sFullPath == &quot;&quot;)) {
                sElemPath = sItemQN;
            } else {
                sElemPath = sFullPath + &quot;&#x2F;&quot; + sItemQN;
            }
            oNewTableRow = oElMenuTable.insertRow();
            oNewTableRow.className = &quot;mi&quot;;
            oNewTableRow.id = sElemPath;
            oNewTableRow.setAttribute(&quot;value&quot;, sItemQN + &quot;|&quot; + oParticle.name + &quot;|&quot; + sItemURI + &quot;|1|&quot; + sKirjeldav);
            oNewTableRow.title = sElemPath

            oNewRowCell = oNewTableRow.insertCell();
            oNewRowCell.innerText = jsStrRepeat(4 * nDepth, &quot;\u00A0&quot;) + sKirjeldav;
            oNewRowCell = oNewTableRow.insertCell();
            oNewRowCell.innerText = sItemQN;
            oNewRowCell = oNewTableRow.insertCell();
            oNewRowCell.innerText = sDispType;
            oNewRowCell = oNewTableRow.insertCell();
            oNewRowCell.innerText = &quot;(&quot; + oParticle.minOccurs + &quot;, &quot; + sMaxSymbol + &quot;)&quot;;
            oNewRowCell = oNewTableRow.insertCell() &#x2F;&#x2F;sSubMenu;
            return;
        }
    } else {
        nParticleCount = oISchItem.type.contentModel.particles.length;
    }

    for (i = 0; i &lt; nParticleCount; i++) {
        if ((oFirstParticle.itemType == SOMITEM_ANY)) {
            sItemQN = aAnyNames[i];
            if ((sItemQN.indexOf(&quot;:&quot;) &gt; -1)) {
                sPr = jsMid(sItemQN, 0, sItemQN.indexOf(&quot;:&quot;));
                sLName = jsMid(sItemQN, sItemQN.indexOf(&quot;:&quot;) + 1);
                sItemURI = oXmlNsm.getURI(sPr);
            } else {
                sPr = &quot;&quot;;
                sLName = sItemQN;
                sItemURI = oXmlNsm.getURI(&quot;&quot;);
            }
            oParticle = oSchRootElems.itemByQName(sLName, sItemURI);
        } else if ((oFirstParticle.itemType == SOMITEM_ELEMENT)) {
            oParticle = oISchItem.type.contentModel.particles[i];
            if (!(oParticle.namespaceURI == &quot;&quot;)) {
                sItemURI = oParticle.namespaceURI;
                sPr = oXmlNsm.getPrefixes(sItemURI).item(0);
                if ((sPr == &quot;&quot;)) {
                    sItemQN = oParticle.name;
                } else {
                    sItemQN = sPr + &quot;:&quot; + oParticle.name;
                }
            } else {
                sItemURI = &quot;&quot;;
                sItemQN = oParticle.name;
            }
        }

        nContentType = -1;
        nGroupType = -1;
        sSubMenu = &quot;&quot;

        if ((oParticle.type.itemType == SOMITEM_COMPLEXTYPE)) {
            nContentType = oParticle.type.contentType;
            if ((nContentType == SCHEMACONTENTTYPE_MIXED)) {
                sDispType = &quot;Ct,Mx&quot;;
            } else if ((nContentType == SCHEMACONTENTTYPE_ELEMENTONLY)) {
                sDispType = &quot;Ct,Eo&quot;;
            } else if ((nContentType == SCHEMACONTENTTYPE_TEXTONLY)) {
                sDispType = &quot;Ct,To&quot;;
            } else if ((nContentType == SCHEMACONTENTTYPE_EMPTY)) {
                sDispType = &quot;Ct, &quot;;
            }
            &#x2F;&#x2F;&quot;ISchemaComplexType&quot; korral peaks alati olema TypeName(oParticle.type.contentModel) = &quot;ISchemaModelGroup&quot; ?;
            nGroupType = oParticle.type.contentModel.itemType;
            if ((nGroupType == SOMITEM_EMPTYPARTICLE)) {
                sDispType = sDispType + &quot;, &quot;;
            } else if ((nGroupType == SOMITEM_SEQUENCE)) {
                sDispType = sDispType + &quot;,Sq&quot;;
            } else if ((nGroupType == SOMITEM_CHOICE)) {
                sDispType = sDispType + &quot;,Ch&quot;;
            } else if ((nGroupType == SOMITEM_ALL)) {
                sDispType = sDispType + &quot;,All&quot;;
            }
            if (oParticle.type.attributes.length &gt; 0) {
                sSubMenu = String.fromCharCode(&quot;0x&quot; + jsMid(BLACK_RIGHT_POINTING_POINTER, 3, 4));
                var ea = new Enumerator(oParticle.type.attributes);
                var tunnused = { &quot;aT&quot;: 0, &quot;aTA&quot;: 0 };
                ea.moveFirst();
                while (ea.atEnd() == false) {
                    var attr = ea.item();
                    if (attr.name == &quot;aT&quot; || attr.name == &quot;aTA&quot;) {
                        tunnused[attr.name] = 1;
                    }
                    ea.moveNext();
                } &#x2F;&#x2F; while
                if (tunnused[&quot;aT&quot;] == 1 &amp;&amp; tunnused[&quot;aTA&quot;] == 1) {
                    aTTAPlokid += sItemQN + &#x27;;&#x27;;
                }
            }
        } else {
            &#x2F;&#x2F; if ((oParticle.type.itemType == SOMITEM_SIMPLETYPE))
            sDispType = &quot;St&quot;;
        }
        sXsdXPath = &quot;.&#x2F;&#x2F;&quot; + NS_XS_PR + &quot;:element[@name=&#x27;&quot; + oParticle.name + &quot;&#x27;]&#x2F;&quot; + NS_XS_PR + &quot;:annotation&#x2F;&quot; + NS_XS_PR + &quot;:documentation[@xml:lang=&#x27;&quot; + sAppLang + &quot;&#x27;]&quot;;
        oXsdNode = oXsdDOM.documentElement.selectSingleNode(sXsdXPath);
        if (!(oXsdNode == null)) {
            sKirjeldav = oXsdNode.text;
        } else {
            sKirjeldav = sItemQN;
        }

        if ((oFirstParticle.itemType == SOMITEM_ANY)) {
            sMinSymbol = oFirstParticle.minOccurs;
            if ((oFirstParticle.maxOccurs == &quot;-1&quot;)) {
                sMaxSymbol = String.fromCharCode(&quot;0x&quot; + jsMid(eeLex_INFINITY, 3, 4));
            } else {
                sMaxSymbol = oFirstParticle.maxOccurs;
            }
        } else if ((oFirstParticle.itemType == SOMITEM_ELEMENT)) {
            sMinSymbol = oParticle.minOccurs;
            if ((oParticle.maxOccurs == &quot;-1&quot;)) {
                sMaxSymbol = String.fromCharCode(&quot;0x&quot; + jsMid(eeLex_INFINITY, 3, 4));
            } else {
                sMaxSymbol = oParticle.maxOccurs;
            }
        }

        if ((sFullPath == &quot;&quot;)) {
            sElemPath = sItemQN;
        } else {
            sElemPath = sFullPath + &quot;&#x2F;&quot; + sItemQN;
        }

        oNewTableRow = oElMenuTable.insertRow();
        oNewTableRow.className = &quot;mi&quot;;
        oNewTableRow.id = sElemPath

        sRowVal = sItemQN + &quot;|&quot; + oParticle.name + &quot;|&quot; + sItemURI + &quot;|1|&quot; + sKirjeldav

        oNewTableRow.setAttribute(&quot;value&quot;, sRowVal);
        oNewTableRow.title = sElemPath;

        oNewRowCell = oNewTableRow.insertCell();
        oNewRowCell.innerText = jsStrRepeat(4 * nDepth, &quot;\u00A0&quot;) + sKirjeldav;
        oNewRowCell = oNewTableRow.insertCell();
        oNewRowCell.innerText = sItemQN;
        oNewRowCell = oNewTableRow.insertCell();
        oNewRowCell.innerText = sDispType;
        oNewRowCell = oNewTableRow.insertCell();
        oNewRowCell.innerText = &quot;(&quot; + sMinSymbol + &quot;, &quot; + sMaxSymbol + &quot;)&quot;;
        oNewRowCell = oNewTableRow.insertCell();
        oNewRowCell.innerText = sSubMenu

        if ((oParticle.type.itemType == SOMITEM_COMPLEXTYPE)) {
            if ((oParticle.type.contentModel.particles.length &gt; 0)) {
                &#x2F;&#x2F;nt q:no (ÕS) pärast läheb tsüklisse;
                if (!(sParentQN == sItemQN)) {
                    GetMenuElements(oParticle, sElemPath, nDepth + 1);
                }
            }
        }
    }
} &#x2F;&#x2F;GetMenuElements


&#x2F;**
* 
* @method artExpandCollapse
*&#x2F;
function artExpandCollapse() {
    var oSrc, pilt, avatud, kinniLahtid, kinniLahti
    oSrc = window.event.srcElement;
    pilt = &quot;graphics&#x2F;112_Minus_Orange_16x16_72.png&quot;;
    &#x2F;&#x2F;dün &quot;src&quot;: kirjas on täielik tee
    if ((jsRight(oSrc.src, pilt.length) == pilt)) {
        avatud = &quot;0&quot;;
    } else {
        avatud = &quot;1&quot;;
    }
    kinniLahtid = oEditDOMRoot.selectNodes(&quot;.&#x2F;&#x2F;@&quot; + DICPR + &quot;:edO&quot;);
    for (i = 0; i &lt; kinniLahtid.length; i++) {
        kinniLahtid[i].value = avatud;
    }
    vaatedRefresh(2);
} &#x2F;&#x2F;artExpandCollapse


&#x2F;**
* 
* @method useSymbolsOnClick
*&#x2F;
function useSymbolsOnClick() {
    var oSrc, pilt, avatud, kinniLahtid, kinniLahti
    oSrc = window.event.srcElement;
    if ((oSrc.checked)) {
        inp_UseFakult.checked = false;
        inp_UseFakult.disabled = true;
    } else {
        inp_UseFakult.disabled = false;
    }
} &#x2F;&#x2F;useSymbolsOnClick


&#x2F;**
* 
* @method imgArtExportClick
*&#x2F;
function imgArtExportClick() {

    var qM = &quot;MySql&quot;;
    if (window.event.ctrlLeft) {
        qM = &quot;XML&quot;;
    }

    var oPrmDom = GetQueryParams(qM);
    if (!oPrmDom) {
        alert(QUERY_ERROR, jsvbCritical, QUERY_WORD);
        return;
    }

    var art_xpath, pQrySql, volId, volCond;
    qM = oPrmDom.documentElement.selectSingleNode(&quot;qM&quot;).text;
    art_xpath = oPrmDom.documentElement.selectSingleNode(&quot;axp&quot;).text;
    pQrySql = oPrmDom.documentElement.selectSingleNode(&quot;pQrySql&quot;).text;

    var smdArgs = sQryInfo + JR + &quot;c:&#x2F;EELex&#x2F;Väljatrükid&#x2F;artiklid.doc&quot; + JR + dic_desc + JR + sAppLang + JR + &#x27;blahh&#x27;;
    var sParms = window.showModalDialog(&quot;html&#x2F;artsprint.htm&quot;, smdArgs, &quot;dialogHeight:400px;dialogWidth:800px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:no;unadorned:no&quot;);
    if (!sParms) {
        return;
    }

    volId = sel_Vol.options(sel_Vol.selectedIndex).id;
    volCond = dic_desc + &quot;.vol_nr = &quot; + jsMid(volId, 3, 1);
    if (volId == dic_desc + &quot;All&quot;) {
        volCond = dic_desc + &quot;.vol_nr &gt; 0&quot;;
    }

    &#x2F;&#x2F;1                    2          3          4              5                  6
    &#x2F;&#x2F;useQuery|useM + JR + sM1 + JR + sM2 + JR + nPageNr + JR + useFullText + JR + sFile
    var tarr = sParms.split(JR);

    &#x2F;&#x2F;Märksõna lõppu võib vajadusel lisada hom nr - i,
    &#x2F;&#x2F;seda maha ei teisendata, pealegi od_ korral koosneb kogu märksõna numbritest.
    if (tarr[0] == &quot;useQuery&quot;) {
        var ix, ordBy;
        ix = pQrySql.indexOf(&quot; ORDER BY &quot;);
        ordBy = jsMid(pQrySql, ix);
        pQrySql = jsMid(pQrySql, 0, ix) + &quot; GROUP BY &quot; + dic_desc + &quot;.G&quot; + ordBy;
    } else {
        sQryInfo = &quot;[1. &quot; + HEADWORD_WORD + &quot; (&quot; + first_default + &quot;) [ &gt;= &#x27;&quot; + tarr[1] + &quot;&#x27; &quot; + AND_WORD.toUpperCase() + &quot; &lt;= &#x27;&quot; + tarr[2] + &quot;&#x27; ]], &quot; + CASE_INSENSITIVE + &quot;, &quot; + SYMS_EXCLUDED;
        &#x2F;&#x2F;so siis märkideta, tõstutundetu, lokaalne;
        var ms1, ms2, msPred, msTekstTing;
        ms1 = RemoveSymbols(tarr[1].toLowerCase(), &quot; &quot;);
        ms2 = RemoveSymbols(tarr[2].toLowerCase(), &quot; &quot;);
        &#x2F;&#x2F; &quot;compMs&quot; kasutas kunagi Perl &#x27;ge&#x27;, &#x27;le&#x27;, need ei tööta eesti järjestuse puhul
        msPred = &quot;[al_p:compMs(., &#x27;&quot; + ms1 + &quot;&#x27;, &#x27;&quot; + ms2 + &quot;&#x27;) &gt; 0]&quot;;
        art_xpath = first_default.substr(0, first_default.indexOf(&quot;&#x2F;&quot;)) + &quot;[&quot; + first_default.substr(first_default.indexOf(&quot;&#x2F;&quot;) + 1) + msPred + &quot;]&quot;;

        &#x2F;&#x2F; &quot;STRCMP&quot; peaks töötama normaalselt, välja arvatud et võrreldakse kõiki ms-gruppe, mitte ainult esimest
        &#x2F;&#x2F; seega tulevad väljatrükile kaasa igasugused, mis vahemikku klapivad
        &#x2F;&#x2F; prigantiin, brigantiin
        msTekstTing = &quot;STRCMP(msid.ms_nos, &#x27;&quot; + ms1 + &quot;&#x27;) &gt;= 0 AND STRCMP(msid.ms_nos, &#x27;&quot; + ms2 + &quot;&#x27;) &lt;= 0&quot;;
        msTekstTing = &quot; AND (&quot; + msTekstTing + &quot;)&quot;;

        pQrySql = &quot;SELECT &quot; + dic_desc + &quot;.md AS md, &quot; + &quot;msid.ms AS l, &quot; + &quot;msid.ms_att_i AS ms_att_i, msid.ms_att_liik AS ms_att_liik, &quot; + &quot;msid.ms_att_ps AS ms_att_ps, msid.ms_att_tyyp AS ms_att_tyyp, msid.ms_att_mliik AS ms_att_mliik, &quot; + &quot;msid.ms_att_k AS ms_att_k, msid.ms_att_mm AS ms_att_mm, msid.ms_att_st AS ms_att_st, &quot; + &quot;msid.ms_att_vm AS ms_att_vm, msid.ms_att_all AS ms_att_all, msid.ms_att_uus AS ms_att_uus, &quot; + &quot;msid.ms_att_zs AS ms_att_zs, msid.ms_att_u AS ms_att_u, msid.ms_att_em AS ms_att_em, &quot; + dic_desc + &quot;.G AS G, &quot; + dic_desc + &quot;.art AS art, &quot; + dic_desc + &quot;.K AS K, &quot; + dic_desc + &quot;.T AS T, &quot; + dic_desc + &quot;.TA AS TA, &quot; + dic_desc + &quot;.PT AS PT, &quot; + dic_desc + &quot;.vol_nr AS vol_nr &quot; + &quot;FROM msid, &quot; + dic_desc + &quot; WHERE (&quot; + dic_desc + &quot;.G = msid.G&quot; + &quot; AND msid.dic_code = &#x27;&quot; + dic_desc + &quot;&#x27;&quot; + msTekstTing + &quot; AND &quot; + volCond + &quot;)&quot; + &quot; GROUP BY &quot; + dic_desc + &quot;.G&quot; + &quot; ORDER BY &quot; + dic_desc + &quot;.ms_att_OO&quot;;

        &#x2F;&#x2F; olgu &quot;XML&quot;, et vältida sql korral tulevaid artikleid, mis rahuldavad tingimust teise jne ms tõttu
        qM = &quot;XML&quot;;
    }

    showDbgVar(&quot;sQryInfo&quot;, sQryInfo, &quot;imgArtExportClick&quot;, &quot;&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;art_xpath&quot;, art_xpath, &quot;imgArtExportClick&quot;, &quot;&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;pQrySql&quot;, pQrySql, &quot;imgArtExportClick&quot;, &quot;&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;qM&quot;, qM, &quot;imgArtExportClick&quot;, &quot;&quot;, &quot; &quot;, new Date());

    nStartPageNumber = parseInt(tarr[3]);
    bRemoveShaded = !jsStringToBoolean(tarr[4]);
    sWordFileName = tarr[5];

    sCmdId = &quot;ClientPrint&quot;;

    oPrmDom.documentElement.selectSingleNode(&quot;cmd&quot;).text = sCmdId;
    oPrmDom.documentElement.selectSingleNode(&quot;vol&quot;).text = volId;
    oPrmDom.documentElement.selectSingleNode(&quot;nfo&quot;).text = sQryInfo;
    oPrmDom.documentElement.selectSingleNode(&quot;axp&quot;).text = art_xpath;
    oPrmDom.documentElement.selectSingleNode(&quot;qM&quot;).text = qM;
    oPrmDom.documentElement.selectSingleNode(&quot;pQrySql&quot;).text = pQrySql;

    StartOperation(oPrmDom);
} &#x2F;&#x2F;imgArtExportClick
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
