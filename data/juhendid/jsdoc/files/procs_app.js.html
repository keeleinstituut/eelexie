<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>procs_app.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.7.0&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.7.0&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/dxf.html">dxf</a></li>
            
                <li><a href="..&#x2F;classes/komponendid.html">komponendid</a></li>
            
                <li><a href="..&#x2F;classes/kontrollid.html">kontrollid</a></li>
            
                <li><a href="..&#x2F;classes/lisad.html">lisad</a></li>
            
                <li><a href="..&#x2F;classes/procs_app.html">procs_app</a></li>
            
                <li><a href="..&#x2F;classes/procs_edt.html">procs_edt</a></li>
            
                <li><a href="..&#x2F;classes/procs_TextContMenu.html">procs_TextContMenu</a></li>
            
                <li><a href="..&#x2F;classes/tools.html">tools</a></li>
            
                <li><a href="..&#x2F;classes/tools_dx.html">tools_dx</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: procs_app.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
﻿&#x2F;**
* procs_app.js
* 
*
* @class procs_app
*&#x2F;
&#x2F;&#x2F;Copyright© 2006 - 2012. Andres Loopmann, EKI, andres.loopmann@eki.ee. All rights reserved.

&#x2F;**
* 
* 
* @property PaljuProperteid
*&#x2F;
var oXsdDOM;
var oXsdSc;
var oXsdNsm;
var sXsdNsList;
var oEditDOM;
var oEditDOMRoot;
var oXmlSc;
var oSchRootElems, oSchRootAttrs;
var oXmlNsm;
var sXmlNsList;
var oXsl1, oXsl2, oXsl3, oXslEdit, oXslView, oXslBrowse, oCopyView;
var gendXslStandard, gendXslNimi = &#x27;&#x27;, xslViewName;
var oEditAll, oViewAll, oDbgTable;

var viewCSS, editCSS;

var sOrgMarkSona, sOrgHomnr;
var sMarkSona, sMSortVal, msAsendus, sFromVolume, sDeldVolId, sAllVolId;
var sTextToCopy;
var bArtModified;

var oElMenuTable;
var sCurrElemId, sSeldItemId, sSeldElemValue, sSeldAttrValue;

var dtOpStart, sQryInfo, sCmdId;
var browseDoc, nBrRowIndex;
var oBrowseNode, browseSortBy, browseSortOrder, filterBy;

&#x2F;&#x2F;Word väljatrükk
var nStartPageNumber, bRemoveShaded, sWordFileName;

&#x2F;&#x2F;edit stuff (vana)
var oClicked, oClickedBorder, trueIfrDocClick, contextClicked;
var clType, clEditable, scv, nodepath, elemlang;
var ivde, ivdebgc;
var clickedNode;
var selectedNode, snDecl, snQName, snKirjeldavQName, cmHeading;
var fatherNode, pnDecl;

var neElems, neAttribs;
var ptd;  &#x2F;&#x2F;rakenduse peatoimetajad;
var zeus;  &#x2F;&#x2F;see, kes KÕIKE peaks saama teha ...;
var eeLexAdmin, qryMethodOrg;

&#x2F;&#x2F;edit värk
var oOrgArtNode, artOrgString, cpfragment, urfragment, urindex, urlast, urmax;

&#x2F;&#x2F;art.cgi - st
var sUsrName, srTegija, dic_desc, sAppLang, sDicName;

var bArtSaveAllowed, bArtDelAllowed, bArtAddAllowed, bPrintToWordAllowed, bArtSignAllowed, bArtToolsEnabled, bSrToolsEnabled;
var artMuudatused;

&#x2F;&#x2F;konfigureeritavad
var appDesc;
var DICPR;
var DICURI;
var dic_vols_count;
var default_query;
var first_default;
var qn_sort_attr;
var fakult, msLsp;
var mySqlDataVer;
var qn_ms, qn_homnr, qn_guid, qn_toimetaja, qn_tkp, qn_autor, qn_akp, qn_art;

&#x2F;&#x2F;eelexSWCtl tarkvara
&#x2F;&#x2F;&quot;ma&quot; - morfoloogiline analüüs, &quot;ms&quot; - morfoloogiline süntees
var setKeyboard, orgKBLayoutLang;
var doSpellCheck;
var useMorfo, ma_tul, ma_ls, ma_sqn, ma_vkkuju, ms_valtega, ms_vkkuju;


&#x2F;&#x2F;üldstruktuur
var yldStruDom, strLangXsl, mnuElemLang;
var impSchemaLocations;

&#x2F;&#x2F;keelekoodid, tõlkekeeled (need, mis on ISO 639-1 hulgast &quot;palutud&quot;)
var rootLang;
var dest_language;  &#x2F;&#x2F; &lt;julius&gt; sõnastiku teine keel;
var keelteValik;
var appKeeled = { &quot;et&quot;: 0, &quot;en&quot;: 1, &quot;ru&quot;: 2 };


&#x2F;&#x2F; märksõna keel (@xml:lang), tähestik
var msLang = &#x27;&#x27;, msAlpha = &#x27;&#x27;, msTranslSrc = &#x27;&#x27;, msTranslDst = &#x27;&#x27;;

&#x2F;&#x2F; plokid, milledel on aT, aTA atribuudid (automaatse salvestusinfo jaoks)
var aTTAPlokid = &#x27;&#x27;;

var textEditFont;
var asuKoht;
var brVer = &quot;Unknown&quot;;


&#x2F;**
* 
*
* @method bodyOnLoad
*&#x2F;
function bodyOnLoad() {

    var fullAddress = window.location.href;

    asuKoht = fullAddress.substr(0, fullAddress.lastIndexOf(&quot;&#x2F;&quot;) + 1); &#x2F;&#x2F; koos &#x27;&#x2F;&#x27;
    brVer = getBrowserData();

    selectedNode = null;

    &#x2F;&#x2F;algus ---------------------------------------------------------------
    &#x2F;&#x2F;algväärtused --------------------------------------------------------

    var i, tarr;
    tarr = spn_SrvParms.innerText.split(&quot;|&quot;);
    sUsrName = tarr[0];
    srTegija = jsStringToBoolean(tarr[1]);
    dic_desc = tarr[2];
    sAppLang = tarr[3];
    sDicName = tarr[4];

    bArtModified = false;

    &#x2F;&#x2F;konfig
    var oConfigDOM = IDD(&quot;File&quot;, &quot;shsconfig_&quot; + dic_desc + &quot;.xml&quot;, false, false, null);
    if ((oConfigDOM.parseError.errorCode != 0)) {
        ShowXMLParseError(oConfigDOM);
        return;
    }
    var cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;appDesc&quot;); &#x2F;&#x2F;&#x27;EXSA, EELex;
    if (!(cfgElem == null)) {
        appDesc = cfgElem.text;
    } else {
        appDesc = &quot;&quot;;
    }

    DICPR = oConfigDOM.documentElement.selectSingleNode(&quot;dicpr&quot;).text;
    DICURI = oConfigDOM.documentElement.selectSingleNode(&quot;dicuri&quot;).text;
    dic_vols_count = oConfigDOM.documentElement.selectNodes(&quot;vols&#x2F;vol&quot;).length;

    default_query = oConfigDOM.documentElement.selectSingleNode(&quot;default_query&quot;).text;
    first_default = oConfigDOM.documentElement.selectSingleNode(&quot;first_default&quot;).text;

    qn_sort_attr = oConfigDOM.documentElement.selectSingleNode(&quot;qn_sort_attr&quot;).text;

    &#x2F;&#x2F;muidu märksõna &lt;m&gt;, hariduses nt &lt;ter&gt;
    qn_ms = jsMid(default_query, default_query.lastIndexOf(&quot;&#x2F;&quot;) + 1);

    qn_homnr = DICPR + &quot;:i&quot;;
    qn_guid = DICPR + &quot;:G&quot;;
    qn_toimetaja = DICPR + &quot;:T&quot;;
    qn_tkp = DICPR + &quot;:TA&quot;;
    qn_autor = DICPR + &quot;:K&quot;;
    qn_akp = DICPR + &quot;:KA&quot;;
    qn_art = DICPR + &quot;:A&quot;;

    neElems = oConfigDOM.documentElement.selectSingleNode(&quot;neelems&quot;).text;
    neAttribs = oConfigDOM.documentElement.selectSingleNode(&quot;neattribs&quot;).text;

    &#x2F;&#x2F;rootLang: ainult xsl2 genereerimisel, ka editDom moodustamisel, kui ag_sr pole
    rootLang = &quot;et&quot;;
    cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;rootLang&quot;);
    if (cfgElem) {
        rootLang = cfgElem.text;
    }

    &#x2F;&#x2F; &lt;julius&gt; kui sõnastiku teine keel on määratud, võtame selle
    cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;destLang&quot;);
    dest_language = &quot;&quot;;
    if (cfgElem) {
        dest_language = cfgElem.text;
    }
    &#x2F;&#x2F;destLang: ainult loendite menüüdes sihtkeeles
    if (dest_language == &quot;et&quot;) { &#x2F;&#x2F;&#x27;nt Pärtel Lippus: Inglise-eesti foneetika terminite sõnastik
        if ((sAppLang == &quot;et&quot;)) {
            dest_language = &quot;&quot;;
        }
    }
    &#x2F;&#x2F; &lt;julius&gt;

    msAlpha = &quot;AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsŠšZzŽžTtUuVvWwÕõÄäÖöÜüXxYy&quot;;
    cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;msLang&quot;);
    if (cfgElem) {
        msLang = cfgElem.text;
    }
    if (msLang) {
        cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;msAlpha&quot;);
        if (cfgElem) {
            msAlpha = cfgElem.text;
        }
        else {
            alert(&quot;Märksõna keel olemas (&#x27;&quot; + msLang + &quot;&#x27;), kuid puudub tähestik!&quot;);
            return;
        }
        cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;msTranslSrc&quot;);
        if (cfgElem)
            msTranslSrc = cfgElem.text;
        cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;msTranslDst&quot;);
        if (cfgElem)
            msTranslDst = cfgElem.text;
    }

    &#x2F;&#x2F;Morfoloogia
    cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;cfgUseMorfo&quot;);
    if (cfgElem) {
        useMorfo = jsStringToBoolean(cfgElem.text);
    } else {
        useMorfo = false;
    }
    &#x2F;&#x2F;morfoloogia sätted: analüüs
    ma_tul = 0;
    ma_ls = 0;
    ma_sqn = 0;
    ma_vkkuju = 0;
    &#x2F;&#x2F;morfoloogia sätted: süntees
    ms_valtega = 0;
    ms_vkkuju = 0;
    if (useMorfo) {
        &#x2F;&#x2F;analüüs;
        cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;morf_ana&#x2F;tul&quot;); &#x2F;&#x2F;&#x27;tuletusega;
        if (!(cfgElem == null)) {
            ma_tul = parseInt(cfgElem.text);
        }
        cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;morf_ana&#x2F;ls&quot;); &#x2F;&#x2F;&#x27;liitsõna oletusega;
        if (!(cfgElem == null)) {
            ma_ls = parseInt(cfgElem.text);
        }
        cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;morf_ana&#x2F;sqn&quot;); &#x2F;&#x2F;&#x27;sõnastikuga;
        if (!(cfgElem == null)) {
            ma_sqn = parseInt(cfgElem.text);
        }
        cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;morf_ana&#x2F;vkkuju&quot;); &#x2F;&#x2F;&#x27;vormikoodi kuju;
        if (!(cfgElem == null)) {
            ma_vkkuju = parseInt(cfgElem.text);
        }
        &#x2F;&#x2F;süntees;
        cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;morf_syn&#x2F;valde&quot;); &#x2F;&#x2F;&#x27;süntees välte märkimisega;
        if (!(cfgElem == null)) {
            ms_valtega = parseInt(cfgElem.text);
        }
        cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;morf_syn&#x2F;svkkuju&quot;); &#x2F;&#x2F;&#x27;vormikoodi kuju sünteesil;
        if (!(cfgElem == null)) {
            &#x2F;&#x2F;sünteesi korral on parameeter teise jrk-ga, shsconfig-is on mõlemad analüüsi moodi;
            ms_vkkuju = (parseInt(cfgElem.text) + 2) % 3;
        }
    }


    var xh, oRespDom, sta;
    &#x2F;&#x2F;ptd - peatoimetajad
    if (appDesc == &quot;EXSA&quot;) {
        xh = exCGISync(&quot;tools.cgi&quot;, &quot;exsaGetField&quot; + JR + dic_desc + JR + sUsrName + JR + &quot;&quot; + JR + &quot;items&#x2F;item[@code = &#x27;&quot; + dic_desc + &quot;&#x27;]&#x2F;ptd&quot;);
        if (xh.statusText == &quot;OK&quot;) {
            oRespDom = xh.responseXML;  &#x2F;&#x2F;responseXML: TypeName = DomDocument;
            sta = oRespDom.selectSingleNode(&quot;rsp&#x2F;sta&quot;).text;
            if (sta == &quot;Success&quot;) {
                ptd = oRespDom.selectSingleNode(&quot;rsp&#x2F;answer&quot;).text;
            } else {
                alert(&quot;Väärtuste leidmine ei õnnestunud!&quot;, jsvbCritical, document.title);
                return;
            }
        } else {
            alert(xh.status + &quot;: &quot; + xh.statusText + &#x27;\r\n\r\n&#x27; + xh.responseText, jsvbCritical);
            return;
        }
    } else {
        cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;ptd&quot;);
        if (!(cfgElem == null)) {
            ptd = cfgElem.text;
        } else {
            ptd = &quot;&quot;;
        }
        cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;zeus&quot;); &#x2F;&#x2F;&#x27;super parandajad;
        if (!(cfgElem == null)) {
            zeus = cfgElem.text;
        } else {
            zeus = &quot;&quot;;
        }
    }

    var shsConf = IDD(&quot;File&quot;, &quot;shsConfig.xml&quot;, false, false, null);
    eeLexAdmin = shsConf.documentElement.selectSingleNode(&quot;eeLexAdmin&quot;).text;

    qryMethodOrg = &quot;XML&quot;;
    var shsConfQmMySql = shsConf.documentElement.selectSingleNode(&quot;qmMySql&quot;).text;
    if (shsConfQmMySql.indexOf(&#x27;;&#x27; + dic_desc + &#x27;;&#x27;) &gt; -1) {
        qryMethodOrg = &quot;MySql&quot;;
    }

    bArtSaveAllowed = false;
    bArtSignAllowed = false;
    bArtDelAllowed = false;
    bArtAddAllowed = false;
    bPrintToWordAllowed = false;
    bArtToolsEnabled = false;
    bSrToolsEnabled = false;

    if (srTegija) {
        if (!(dic_desc == &quot;od_&quot;)) {
            bArtAddAllowed = true;
        }
        if (ptd.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1 || eeLexAdmin.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1) {
            bArtSignAllowed = true;
        }
        bPrintToWordAllowed = true;
    }

    fakult = oConfigDOM.documentElement.selectSingleNode(&quot;fakult&quot;).text;
    msLsp = &quot;&quot;;
    cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;msLsp&quot;);
    if (!(cfgElem == null)) {
        msLsp = cfgElem.text;
    }
    mySqlDataVer = &quot;&quot;;
    cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;mySqlDataVer&quot;);
    if (!(cfgElem == null)) {
        mySqlDataVer = cfgElem.text;
    }

    cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;do_spellcheck&quot;);
    if (!(cfgElem == null)) {
        doSpellCheck = jsStringToBoolean(cfgElem.text);
    } else {
        doSpellCheck = false;
    }
    cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;cfgSetKeyboard&quot;);
    if (!(cfgElem == null)) {
        setKeyboard = jsStringToBoolean(cfgElem.text);
    } else {
        setKeyboard = false;
    }

    cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;teade&quot;);
    if (!(cfgElem == null)) {
        if ((cfgElem.text.length &gt; 0)) {
            alert(cfgElem.text, vbInformation, &quot;Teade&quot;);
        }
    }

    cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;colorsFonts&#x2F;editArea&#x2F;editFont&quot;);
    if (cfgElem) {
        textEditFont = cfgElem.text;
    }

    oConfigDOM = null;


    orgKBLayoutLang = &quot;&quot;;
    if (setKeyboard) {
        try {
            orgKBLayoutLang = eelexSWCtl.getKBLayoutLang();
        }
        catch (e) {
            alert(e.name + &quot; 0x&quot; + hex(e.number, true) + &quot;: &#x27;&quot; + e.description + &quot;&#x27;.&quot;);
        }
    }

    sDeldVolId = dic_desc + &quot;0&quot;;
    sAllVolId = dic_desc + &quot;All&quot;;


    &#x2F;&#x2F;skeem, üldstruktuur, strLang ---------------------------------------------------------------
    &#x2F;&#x2F;---------------------------------------------------------------------

    var sXSDFile, sPr;
    sXSDFile = &quot;xsd&#x2F;schema_&quot; + dic_desc + &quot;.xsd&quot;;

    oXsdDOM = IDD(&quot;File&quot;, sXSDFile, false, false, null);
    if ((oXsdDOM.parseError.errorCode != 0)) {
        ShowXMLParseError(oXsdDOM);
        return;
    }

    oXsdNsm = new ActiveXObject(&quot;Msxml2.MXNamespaceManager.6.0&quot;);
    oXsdNsm.allowOverride = true;
    var oNsNodeList = oXsdDOM.documentElement.selectNodes(&quot;namespace::*&quot;);
    for (i = 0; i &lt; oNsNodeList.length; i++) {
        if ((oNsNodeList[i].prefix != &quot;&quot;)) {
            if ((oNsNodeList[i].baseName != &quot;xml&quot;)) {
                oXsdNsm.declarePrefix(oNsNodeList[i].baseName, oNsNodeList[i].value);
            }
        }
    }

    sXsdNsList = &quot;&quot;;
    for (i = 0; i &lt; oXsdNsm.getDeclaredPrefixes.length; i++) {
        sPr = oXsdNsm.getDeclaredPrefixes[i];
        if ((sPr != &quot;xml&quot;)) {
            sXsdNsList = sXsdNsList + &quot; xmlns:&quot; + sPr + &quot;=&#x27;&quot; + oXsdNsm.getURI(sPr) + &quot;&#x27;&quot;;
        }
    }
    oXsdDOM.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
    oXsdDOM.setProperty(&quot;SelectionNamespaces&quot;, jsTrim(sXsdNsList));

    oXsdSc = new ActiveXObject(&quot;Msxml2.XMLSchemaCache.6.0&quot;);
    oXsdSc.validateOnLoad = true;
    oXsdSc.add(DICURI, sXSDFile);


    &#x2F;&#x2F;imporditud skeemide asukohad, tõlkekeeled
    keelteValik = new Array();
    impSchemaLocations = new ActiveXObject(&quot;Scripting.Dictionary&quot;);
    var xsdImports = oXsdDOM.documentElement.selectNodes(NS_XS_PR + &quot;:import&quot;);
    for (i = 0; i &lt; xsdImports.length; i++) {
        var locn = xsdImports[i].getAttribute(&quot;schemaLocation&quot;);
        impSchemaLocations.Add(xsdImports[i].getAttribute(&quot;namespace&quot;), locn);
        if ((jsLeft(locn, 4) == dic_desc + &quot;&#x2F;&quot;)) { &#x2F;&#x2F;&#x27;asub tüüpide DOM-is;
            updKeelteValik(locn);
        }
    }
    xsdImports = null;


    &#x2F;&#x2F;üldstruktuur
    yldStruDom = IDD(&quot;File&quot;, &quot;xml&#x2F;&quot; + dic_desc + &quot;&#x2F;stru_&quot; + dic_desc + &quot;.xml&quot;, false, false, oXsdSc);
    if (yldStruDom.parseError.errorCode != 0) {
        yldStruDom = null;
    } else {
        yldStruDom.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
        yldStruDom.setProperty(&quot;SelectionNamespaces&quot;, jsTrim(sXsdNsList) + &quot; xmlns:&quot; + SDPR + &quot;=&#x27;&quot; + SDURI + &quot;&#x27;&quot;);
    }
    &#x2F;&#x2F;strLang
    &#x2F;&#x2F;resolveExternals = true, include&#x2F;import pärast ...
    strLangXsl = IDD(&quot;File&quot;, &quot;xsl&#x2F;tools&#x2F;strLang.xsl&quot;, true, false, null);
    if ((strLangXsl.parseError.errorCode != 0)) {
        ShowXMLParseError(strLangXsl);
        return;
    }


    &#x2F;&#x2F; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
    oEditDOM = IDD(&quot;String&quot;, &quot;&lt;&quot; + DICPR + &quot;:sr xmlns:&quot; + DICPR + &quot;=\&quot;&quot; + DICURI + &quot;\&quot; xml:lang=\&quot;&quot; + rootLang + &quot;\&quot;&#x2F;&gt;&quot;, false, false, oXsdSc);
    if (oEditDOM.parseError.errorCode != 0) {
        ShowXMLParseError(oEditDOM);
        return;
    }
    oEditDOMRoot = oEditDOM.documentElement;

    oXmlNsm = new ActiveXObject(&quot;Msxml2.MXNamespaceManager.6.0&quot;);
    oXmlNsm.allowOverride = true;
    oNsNodeList = oEditDOMRoot.selectNodes(&quot;namespace::*&quot;);
    for (i = 0; i &lt; oNsNodeList.length; i++) {
        if ((oNsNodeList[i].prefix != &quot;&quot;)) {
            if ((oNsNodeList[i].baseName != &quot;xml&quot;)) {
                oXmlNsm.declarePrefix(oNsNodeList[i].baseName, oNsNodeList[i].value);
            }
        }
    }

    oXmlSc = oEditDOM.namespaces;

    sXmlNsList = &quot;&quot;;
    for (i = 0; i &lt; oXmlNsm.getDeclaredPrefixes.length; i++) {
        sPr = oXmlNsm.getDeclaredPrefixes[i];
        if (sPr != &quot;xml&quot;) {
            sXmlNsList = sXmlNsList + &quot; xmlns:&quot; + sPr + &quot;=&#x27;&quot; + oXmlNsm.getURI(sPr) + &quot;&#x27;&quot;;
        }
    }
    sXmlNsList = jsTrim(sXmlNsList) + &quot; xmlns:&quot; + NS_XS_PR + &quot;=&#x27;&quot; + NS_XS + &quot;&#x27; xmlns:&quot; + NS_XSL_PR + &quot;=&#x27;&quot; + NS_XSL + &quot;&#x27; xmlns:pref=&#x27;&quot; + DICURI + &quot;&#x27;&quot;;

    oEditDOM.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
    oEditDOM.setProperty(&quot;SelectionNamespaces&quot;, sXmlNsList);

    oSchRootElems = oXmlSc.getSchema(DICURI).elements;
    oSchRootAttrs = oXmlSc.getSchema(DICURI).attributes;


    if (!(document.all(&quot;img_SrTools&quot;) == null)) {
        bSrToolsEnabled = true;
        sqnastikuTooriistad();  &#x2F;&#x2F;fillSrToolsMenu();
    }


    &#x2F;&#x2F;XSLT teisendused paika
    &#x2F;&#x2F;toimetamisala XSLT-d
    &#x2F;&#x2F;resolveExternals = true, include&#x2F;import pärast ...
    oXsl1 = IDD(&quot;File&quot;, &quot;xsl&#x2F;xsl1.xsl&quot;, true, false, null);
    if ((oXsl1.parseError.errorCode != 0)) {
        ShowXMLParseError(oXsl1);
        return;
    }
    oXsl1.setProperty(&quot;AllowXsltScript&quot;, true);


    initEditTransform();


    gendXslStandard = &quot;gendView_&quot; + dic_desc;
    if (gendXslNimi == &quot;&quot;) { &#x2F;&#x2F; mingi cookie, mis salvestaks &quot;gendXslNimi&quot;, pärast
        gendXslNimi = gendXslStandard;
    }
    xslViewName = gendXslNimi;

    viewCSS = document.styleSheets[2];

    initViewTransform(1);

    if (!oXslView) { &#x2F;&#x2F; kui ei saanud, siis vana, käsitsi tehtud
        xslViewName = &quot;view_&quot; + dic_desc;
        oXslView = IDD(&quot;File&quot;, &quot;xsl&#x2F;&quot; + xslViewName + &quot;.xsl&quot;, true, false, null);
        if (oXslView.parseError.errorCode != 0) {
            ShowXMLParseError(oXslView);
            return;
        }
        oXslView.setProperty(&quot;AllowXsltScript&quot;, true);
        oXslView.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
        oXslView.setProperty(&quot;SelectionNamespaces&quot;, sXmlNsList);

        var ruled = viewCSS.rules;
        &#x2F;&#x2F;vaate genereerimise ajal tehakse küll juba ära, aga kõikide jaoks ei ole genereeritud ...;
        var itad = &quot;&quot;;
        for (i = 0; i &lt; ruled.length; i++) {
            if ((ruled[i].style.fontStyle).toLowerCase() == &quot;italic&quot;) {
                &#x2F;&#x2F; .etvw_hld, .etvw_k, .etvw_k1, .etvw_k2, .etvw_sl, ...
                if (ruled[i].selectorText.substr(0, 1) == &quot;.&quot;) {
                    itad += &quot;;&quot; + ruled[i].selectorText.substr(1);
                } else {
                    itad += &quot;;&quot; + ruled[i].selectorText;
                }
            }
        }
        if (itad) {
            itad = itad + &quot;;&quot;;
            oXslView.documentElement.selectSingleNode(NS_XSL_PR + &quot;:variable[@name = &#x27;itad&#x27;]&quot;).text = itad;
        }

        oXsl3 = oXslView.cloneNode(true);
        oXsl3.documentElement.selectSingleNode(NS_XSL_PR + &quot;:variable[@name = &#x27;edMode&#x27;]&quot;).text = &quot;1&quot;
    }


    &#x2F;&#x2F;otsingu tulemuste lehitsemise XSLT
    &#x2F;&#x2F;resolveExternals = true, include&#x2F;import pärast ...
    oXslBrowse = IDD(&quot;File&quot;, &quot;xsl&#x2F;browse2.xsl&quot;, true, false, null);
    if ((oXslBrowse.parseError.errorCode != 0)) {
        ShowXMLParseError(oXslBrowse);
        return;
    }
    oXslBrowse.setProperty(&quot;AllowDocumentFunction&quot;, true);
    oXslBrowse.setProperty(&quot;AllowXsltScript&quot;, true);
    oXslBrowse.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
    oXslBrowse.setProperty(&quot;SelectionNamespaces&quot;, sXmlNsList);

    browseDoc = document.frames(&quot;frame_Browse&quot;).document;

    &#x2F;&#x2F;avaldised
    PaneEkspressioonid();

    oEditAll = divFrameEdit.all;
    oViewAll = divFrameView.all;

    oDbgTable = frame_dbgPrint.document.all(&quot;varsTable&quot;);

    showDbgVar(&quot;ptd&quot;, ptd, &quot;bodyOnLoad&quot;, &quot; &quot;, &quot; &quot;, new Date());

    cpfragment = oEditDOM.createDocumentFragment();

    ivde = null;
    trueIfrDocClick = true;
    urmax = 15;

    FillInsertSymbolsMenu();
    FillElementsMenu();

    &#x2F;&#x2F;märksõna JA @soov korral on nt nii:
    &#x2F;&#x2F;SetSelectedInfo(&quot;q:A&#x2F;q:P&#x2F;q:mg&#x2F;q:m&#x2F;@q:soov&quot;, &quot;q:soov|soov|&quot; + DICURI + &quot;|1&quot;)
    &#x2F;&#x2F;veel:
    &#x2F;&#x2F;SetSelectedInfo(&quot;q:A&#x2F;q:P&#x2F;q:mg&#x2F;q:grg&#x2F;q:s1&quot;, &quot;&quot;)
    &#x2F;&#x2F;SetSelectedInfo(&quot;q:A&#x2F;q:P&#x2F;q:mg&#x2F;q:grg&#x2F;q:s1&#x2F;@q:levik&quot;, &quot;q:levik|levik|&quot; + DICURI + &quot;|1&quot;)

    SetSelectedInfo(default_query, &quot;&quot;);

    xh = exCGISync(&quot;tools.cgi&quot;, &quot;appOpen&quot; + PD + dic_desc + PD + sUsrName + PD + brVer);
    if (xh.statusText == &quot;OK&quot;) {
        oRespDom = IDD(&quot;&quot;, &quot;&quot;, false, false, null);
        sta = oRespDom.load(xh.responseXML); &#x2F;&#x2F;&#x27;responseXML: TypeName = DomDocument
        if (sta) {
            var opStatus = oRespDom.selectSingleNode(&quot;rsp&#x2F;sta&quot;).text;
            if (opStatus == &quot;Success&quot;) {
            } else {
            }
        }
    }

} &#x2F;&#x2F;bodyOnLoad

&#x2F;**
* 
*
* @method initEditTransform
*&#x2F;
function initEditTransform() {

    &#x2F;&#x2F; toimetamisala XSLT
    &#x2F;&#x2F;resolveExternals = true, include&#x2F;import pärast ...
    var editGend = true;
    oXsl2 = IDD(&quot;File&quot;, &quot;xsl&#x2F;gendXsl2_&quot; + dic_desc + &quot;.xsl&quot;, true, false, null);
    if (oXsl2.parseError.errorCode != 0) {
        oXsl2 = IDD(&quot;File&quot;, &quot;xsl&#x2F;xsl2_&quot; + dic_desc + &quot;_&quot; + sAppLang + &quot;.xsl&quot;, true, false, null);
        if ((oXsl2.parseError.errorCode != 0)) {
            ShowXMLParseError(oXsl2);
            return;
        }
        editGend = false;
    }

    oXsl2.setProperty(&quot;AllowXsltScript&quot;, true);
    oXsl2.setProperty(&quot;AllowDocumentFunction&quot;, true);
    oXsl2.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
    oXsl2.setProperty(&quot;SelectionNamespaces&quot;, sXmlNsList);

    &#x2F;&#x2F; gend
    var cfgElem = oXsl2.documentElement.selectSingleNode(NS_XSL_PR + &quot;:variable[@name = &#x27;appLang&#x27;]&quot;);
    if (cfgElem)
        cfgElem.text = sAppLang;

    oXslEdit = oXsl2;

    if (editGend)
        document.styleSheets[1].href = &quot;css&#x2F;gendEdit_&quot; + dic_desc + &quot;.css&quot;;

    editCSS = document.styleSheets[1];

} &#x2F;&#x2F;initEditTransform


&#x2F;**
* 
*
* @method initViewTransform
* @param {Boolean} vaateValik
*&#x2F;
function initViewTransform(vaateValik) {

    &#x2F;&#x2F;resolveExternals = true, include&#x2F;import pärast ...
    oXslView = IDD(&quot;File&quot;, &quot;xsl&#x2F;&quot; + gendXslNimi + &quot;.xsl&quot;, true, false, null);
    if (oXslView.parseError.errorCode != 0) {
        gendXslNimi = gendXslStandard;
        xslViewName = gendXslNimi;
        oXslView = IDD(&quot;File&quot;, &quot;xsl&#x2F;&quot; + gendXslNimi + &quot;.xsl&quot;, true, false, null);
        if (oXslView.parseError.errorCode != 0) {
            &#x2F;&#x2F;            ShowXMLParseError(oXslView);
            oXslView = null;
            return;
        }
    }

    oXslView.setProperty(&quot;AllowXsltScript&quot;, true);
    oXslView.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
    oXslView.setProperty(&quot;SelectionNamespaces&quot;, sXmlNsList);

    &#x2F;&#x2F;    var viewCssNr = Math.floor(Math.random() * 4000000000);
    &#x2F;&#x2F;    viewCSS.href = &quot;css&#x2F;&quot; + gendXslNimi + &quot;.css?p=&quot; + viewCssNr; &#x2F;&#x2F; val1257(gendXslNimi)

    var d = new Date();
    &#x2F;&#x2F; The getTime method returns an integer value representing the number of milliseconds between midnight, 
    &#x2F;&#x2F; January 1, 1970 and the time value in the Date object
    var t = Math.floor(d.getTime() &#x2F; 1000);
    viewCSS.href = &quot;css&#x2F;&quot; + gendXslNimi + &quot;.css?p=&quot; + t;

    var xh, rspDOM, loadStatus, sta, ix;

    &#x2F;&#x2F;    &#x2F;&#x2F; pole olemas mingit CSS refresh võimalust, seega loe alati
    &#x2F;&#x2F;    xh = exCGISync(&quot;tools.cgi&quot;, &quot;getTextFileContent&quot; + JR + dic_desc + JR + sUsrName + JR +
    &#x2F;&#x2F;                        &quot;css&#x2F;&quot; + gendXslNimi + &quot;.css&quot;);
    &#x2F;&#x2F;    if (xh.statusText == &quot;OK&quot;) {
    &#x2F;&#x2F;        rspDOM = IDD(&quot;&quot;, &quot;&quot;, false, false, null);
    &#x2F;&#x2F;        loadStatus = rspDOM.load(xh.responseXML); &#x2F;&#x2F;&#x27;responseXML: TypeName = DomDocument

    &#x2F;&#x2F;        if (loadStatus) {
    &#x2F;&#x2F;            sta = rspDOM.selectSingleNode(&quot;rsp&#x2F;sta&quot;).text;
    &#x2F;&#x2F;            if (sta == &quot;Success&quot;) {
    &#x2F;&#x2F;                var myCSS = rspDOM.selectSingleNode(&quot;rsp&#x2F;answer&quot;).text;
    &#x2F;&#x2F;                viewCSS.cssText = myCSS;
    &#x2F;&#x2F;            }
    &#x2F;&#x2F;            else
    &#x2F;&#x2F;                alert(sta);
    &#x2F;&#x2F;        }
    &#x2F;&#x2F;    }
    &#x2F;&#x2F;    else {
    &#x2F;&#x2F;        alert(xh.status + &quot;: &quot; + xh.statusText + xh.responseText);
    &#x2F;&#x2F;    }


    if (vaateValik) {
        xh = exCGISync(&quot;tools.cgi&quot;, &quot;getFiles&quot; + JR + dic_desc + JR + sUsrName + JR +
                        &quot;xsl&#x2F;&quot; + JR +
                        gendXslStandard + &quot;*.xsl&quot;);

        if (xh.statusText == &quot;OK&quot;) {
            rspDOM = IDD(&quot;&quot;, &quot;&quot;, false, false, null);
            loadStatus = rspDOM.load(xh.responseXML); &#x2F;&#x2F;&#x27;responseXML: TypeName = DomDocument

            if (loadStatus) {
                while (sel_Vaated.options.length &gt; 0) {
                    sel_Vaated.options.remove(0);
                }

                var fNodes = rspDOM.selectNodes(&quot;rsp&#x2F;outDOM&#x2F;f&quot;);
                for (ix = 0; ix &lt; fNodes.length; ix++) {
                    var opt = document.createElement(&quot;OPTION&quot;);
                    sel_Vaated.options.add(opt);
                    var tekst = fNodes[ix].text;
                    opt.id = tekst;
                    var n = tekst.substr(0, tekst.lastIndexOf(&quot;.&quot;));
                    if (n == gendXslNimi) {
                        opt.selected = true;
                    }
                    if (n == gendXslStandard) {
                        opt.innerHTML = &quot;Standard&quot;;
                    } else {
                        opt.innerHTML = n.substr(gendXslStandard.length + 1); &#x2F;&#x2F; allkriips alguses
                    }
                }
                if (sel_Vaated.options.length &gt; 1) {
                    sel_Vaated.style.visibility = &quot;visible&quot;;
                }
                else {
                    sel_Vaated.style.visibility = &quot;hidden&quot;;
                }
            }
            else {
                alert(xh.status + &quot;: &quot; + xh.statusText + xh.responseText);
            }
        }
        else {
            alert(xh.status + &quot;: &quot; + xh.statusText + xh.responseText);
        }
    }

    &#x2F;&#x2F;piltide kontekst, pildiJuurikas
    var xslNode = oXslView.documentElement.selectSingleNode(NS_XSL_PR + &quot;:variable[@name = &#x27;pildiJuurikas&#x27;]&quot;);
    if (xslNode) {
        xslNode.text = asuKoht + &quot;__sr&#x2F;&quot;;
    }

    oXsl3 = oXslView.cloneNode(true);
    oXsl3.documentElement.selectSingleNode(NS_XSL_PR + &quot;:variable[@name = &#x27;edMode&#x27;]&quot;).text = &quot;1&quot;

} &#x2F;&#x2F;initViewTransform


&#x2F;**
* 
*
* @method xslViewSelected
*&#x2F;
function xslViewSelected() {
    var xslNimi = sel_Vaated.options(sel_Vaated.selectedIndex).id;
    var n = xslNimi.substr(0, xslNimi.lastIndexOf(&quot;.&quot;));
    gendXslNimi = n;
    initViewTransform(null);
    if (oEditDOMRoot.hasChildNodes())
        vaatedRefresh(1);
} &#x2F;&#x2F; xslViewSelected


&#x2F;**
* 
*
* @method PaneEkspressioonid
*&#x2F;
function PaneEkspressioonid() {

    &#x2F;&#x2F;kõik asjad toimetamisalas peale td_UndoRedoNumbers, img_Undo ning img_Redo
    &#x2F;&#x2F;on alguses disabled ning style=&quot;visibility:hidden&quot;,
    &#x2F;&#x2F;td_UndoRedoNumbers, img_Undo, img_Redo on ainult style=&quot;visibility:hidden&quot;,
    &#x2F;&#x2F;samuti on xsl1Edit, xsl2Edit, xsl3Edit ainult style=&quot;visibility:hidden&quot;

    img_ArtAdd.setExpression(&quot;disabled&quot;, &quot;(bArtAddAllowed) ? false : true&quot;, &quot;JScript&quot;);
    img_ArtAdd.style.setExpression(&quot;visibility&quot;, &quot;(bArtAddAllowed) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;)

    img_ArtExport.setExpression(&quot;disabled&quot;, &quot;(bPrintToWordAllowed) ? false : true&quot;, &quot;JScript&quot;);
    img_ArtExport.style.setExpression(&quot;visibility&quot;, &quot;(bPrintToWordAllowed) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;)

    if (!(document.all(&quot;img_SrTools&quot;) == null)) {
        img_SrTools.setExpression(&quot;disabled&quot;, &quot;(bSrToolsEnabled) ? false : true&quot;, &quot;JScript&quot;);
        img_SrTools.style.setExpression(&quot;visibility&quot;, &quot;(bSrToolsEnabled) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;);
    }
    if (!(document.all(&quot;img_ArtTools&quot;) == null)) {
        img_ArtTools.setExpression(&quot;disabled&quot;, &quot;(bArtToolsEnabled &amp;&amp; oEditDOMRoot.hasChildNodes()) ? false : true&quot;, &quot;JScript&quot;);
        img_ArtTools.style.setExpression(&quot;visibility&quot;, &quot;(bArtToolsEnabled &amp;&amp; oEditDOMRoot.hasChildNodes()) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;);
    }

    img_ArtValidate.setExpression(&quot;disabled&quot;, &quot;(srTegija &amp;&amp; oEditDOMRoot.hasChildNodes()) ? false : true&quot;, &quot;JScript&quot;);
    img_ArtValidate.style.setExpression(&quot;visibility&quot;, &quot;(srTegija &amp;&amp; oEditDOMRoot.hasChildNodes()) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;)

    &#x2F;&#x2F;salvestamise ja kustutamise võimalused on artiklipõhjased
    &#x2F;&#x2F;ning pannakse paika xmlChanged-is oEditDOMRoot.hasChildNodes() alusel
    img_ArtSave.setExpression(&quot;disabled&quot;, &quot;(bArtSaveAllowed) ? false : true&quot;, &quot;JScript&quot;);
    img_ArtSave.style.setExpression(&quot;visibility&quot;, &quot;(bArtSaveAllowed) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;)

    img_ArtDelete.setExpression(&quot;disabled&quot;, &quot;(bArtDelAllowed) ? false : true&quot;, &quot;JScript&quot;);
    img_ArtDelete.style.setExpression(&quot;visibility&quot;, &quot;(bArtDelAllowed) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;);
    img_ArtDelete.setExpression(&quot;src&quot;, &quot;(sFromVolume == sDeldVolId) ? &#x27;graphics&#x2F;backtolist 16-16.ico&#x27; : &#x27;graphics&#x2F;delart 16-16.ico&#x27;&quot;, &quot;JScript&quot;)

    td_UndoRedoNumbers.style.setExpression(&quot;visibility&quot;, &quot;(oEditDOMRoot.hasChildNodes()) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;)

    &#x2F;&#x2F;disabled ja src sõltuvad neil olukorrast
    img_Undo.style.setExpression(&quot;visibility&quot;, &quot;(oEditDOMRoot.hasChildNodes()) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;);
    img_Redo.style.setExpression(&quot;visibility&quot;, &quot;(oEditDOMRoot.hasChildNodes()) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;)

    xsl1Edit.style.setExpression(&quot;visibility&quot;, &quot;(oEditDOMRoot.hasChildNodes()) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;);
    xsl2Edit.style.setExpression(&quot;visibility&quot;, &quot;(oEditDOMRoot.hasChildNodes()) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;);
    xsl3Edit.style.setExpression(&quot;visibility&quot;, &quot;(oEditDOMRoot.hasChildNodes()) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;)

    xsl1Edit.style.setExpression(&quot;backgroundColor&quot;, &quot;(oXslEdit === oXsl1) ? &#x27;silver&#x27; : &#x27;seashell&#x27;&quot;, &quot;JScript&quot;);
    xsl2Edit.style.setExpression(&quot;backgroundColor&quot;, &quot;(oXslEdit === oXsl2) ? &#x27;silver&#x27; : &#x27;seashell&#x27;&quot;, &quot;JScript&quot;);
    xsl3Edit.style.setExpression(&quot;backgroundColor&quot;, &quot;(oXslEdit === oXsl3) ? &#x27;silver&#x27; : &#x27;seashell&#x27;&quot;, &quot;JScript&quot;)

    &#x2F;&#x2F;esimene ja viimane artikkel jäävad SP-st välja
    img_readFirst.style.setExpression(&quot;display&quot;, &quot;(dic_desc == &#x27;sp_&#x27;) ? &#x27;none&#x27; : &#x27;&#x27;&quot;, &quot;JScript&quot;);
    img_readLast.style.setExpression(&quot;display&quot;, &quot;(dic_desc == &#x27;sp_&#x27;) ? &#x27;none&#x27; : &#x27;&#x27;&quot;, &quot;JScript&quot;);
    if ((dic_desc == &quot;sp_&quot;)) {
        img_readFirst.parentElement.style.width = 1;
        img_readLast.parentElement.style.width = 1;
    }
    &#x2F;&#x2F;kinni&#x2F;lahti nupp on esialgu ainult &#x27;sp_&#x27;
    img_ExpandCollapse.style.setExpression(&quot;display&quot;, &quot;(dic_desc == &#x27;sp_&#x27; &amp;&amp; oEditDOMRoot.hasChildNodes()) ? &#x27;&#x27; : &#x27;none&#x27;&quot;, &quot;JScript&quot;);
    if ((dic_desc == &quot;sp_&quot;)) {
        img_ExpandCollapse.setExpression(&quot;src&quot;, &quot;(oEditDOMRoot.selectSingleNode(&#x27;.&#x2F;&#x2F;*[@p:edO = \&quot;0\&quot;]&#x27;)) ? &#x27;graphics&#x2F;112_Plus_Orange_16x16_72.png&#x27; : &#x27;graphics&#x2F;112_Minus_Orange_16x16_72.png&#x27;&quot;, &quot;JScript&quot;);
    }

    &#x2F;&#x2F;Vaates
    img_AlignLeft.style.setExpression(&quot;visibility&quot;, &quot;(oEditDOMRoot.hasChildNodes()) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;);
    img_AlignCenter.style.setExpression(&quot;visibility&quot;, &quot;(oEditDOMRoot.hasChildNodes()) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;);
    img_AlignRight.style.setExpression(&quot;visibility&quot;, &quot;(oEditDOMRoot.hasChildNodes()) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;);
    img_AlignJustify.style.setExpression(&quot;visibility&quot;, &quot;(oEditDOMRoot.hasChildNodes()) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;);
    img_ArtPrint.style.setExpression(&quot;visibility&quot;, &quot;(oEditDOMRoot.hasChildNodes()) ? &#x27;visible&#x27; : &#x27;hidden&#x27;&quot;, &quot;JScript&quot;)

} &#x2F;&#x2F;PaneEkspressioonid


&#x2F;**
* 
*
* @method GetQueryParams
* @param {String} qryMethod
* @returns {Object} oPrmDom
*&#x2F;
function GetQueryParams(qryMethod) {

    var withCase, withSymbols;
    var ft, fa;

    withSymbols = 0;
    if (inp_UseSymbols.checked) {
        withSymbols = 1;
    } else {
        if (inp_UseFakult.checked) {
            withSymbols = -1;
        }
    }

    withCase = 1;
    if (inp_UseCase.checked) {
        withCase = 0;
    }

    if (withSymbols &lt; 1) {
        ft = jsTrim(inp_ElemText.value);
        fa = jsTrim(inp_AttrText.value);
    } else {
        ft = inp_ElemText.value;
        fa = inp_AttrText.value;
    }

    &#x2F;&#x2F;Otsitav element (atribuut) ja sSeldItemId, sSeldElemValue, sSeldAttrValue saadakse järgmiselt:
    &#x2F;&#x2F;
    &#x2F;&#x2F;ChooseElement -&gt; ShowElemsMenu -&gt; SwitchElemsMenu -&gt; ClickElemsMenu -&gt;
    &#x2F;&#x2F;SetSelectedInfo -&gt; HideDivMenu
    &#x2F;&#x2F;
    &#x2F;&#x2F;div_ElemsMenu ja div_AttrsMenu &lt;tr&gt;:
    &#x2F;&#x2F;class = &#x27;mi&#x27;; id = sFullPath; value = &#x27;qname|name|URI|IsElement|kirjeldav&#x27;

    var aElemInfo, aAttrInfo, sNodeTest, qt, qtMySql, seldQn, artRada, elemRada, evPath;
    var otsitavInfo;
    var tarr, i, rb;
    aElemInfo = sSeldElemValue.split(&quot;|&quot;);
    seldQn = aElemInfo[0]

    &#x2F;&#x2F;qt: .&#x2F;&#x2F;text(), self::node(), text()
    qt = sel_queryType.options(sel_queryType.selectedIndex).id;
    if (qt == &quot;.&#x2F;&#x2F;text()&quot;) {
        qtMySql = &quot;&#x2F;&#x2F;text()&quot;;
    } else if (qt == &quot;self::node()&quot;) {
        qtMySql = &quot;&#x2F;&#x2F;text()&quot;;
    } else if (qt == &quot;text()&quot;) {
        qtMySql = &quot;&#x2F;text()&quot;;
    }

    &#x2F;&#x2F;sNodeTest algab artiklist: &quot;q:A&#x2F;...&quot; jne
    if (sSeldAttrValue != &quot;&quot;) {
        sNodeTest = jsMid(sSeldItemId, 0, sSeldItemId.lastIndexOf(&quot;&#x2F;&quot;));
    } else {
        sNodeTest = sSeldItemId;
    }

    &#x2F;&#x2F;sNodeTest algab artiklist: &quot;q:A&#x2F;...&quot; jne
    artRada = qn_art;
    evPath = sNodeTest;
    if (sNodeTest == artRada) { &#x2F;&#x2F;A
        elemRada = &quot;&quot;;
    } else {
        if (inp_UseGlobal.checked) {
            elemRada = &quot;.&#x2F;&#x2F;&quot; + seldQn;
            if (dic_desc == &#x27;ss1&#x27; &amp;&amp; seldQn == qn_ms) {
                &#x2F;&#x2F; name() ja local-name() ei kehti MySql XPath-is
                elemRada = &quot;.&#x2F;&#x2F;*[self::s:m or self::s:tul or self::s:mm or self::s:rv]&quot;;
            }
            evPath = elemRada;
        } else {
            elemRada = jsMid(sNodeTest, sNodeTest.indexOf(&quot;&#x2F;&quot;) + 1); &#x2F;&#x2F;&#x27;q:A&#x2F;...;
        }
    }

    if (aElemInfo[3] == &quot;1&quot;) { &#x2F;&#x2F;&#x27;&quot;päris&quot; elemendid, mitte koondpäringud
        if (sNodeTest == artRada) {
            otsitavInfo = artRada;
        } else {
            otsitavInfo = elemRada;
        }
    } else {
        &#x2F;&#x2F;        otsitavInfo = jsMid(sNodeTest, 4); &#x2F;&#x2F;q:A&#x2F;...;
        otsitavInfo = &quot;&#x27;salvestatud päring&#x27;&quot;;
    }

    if (sSeldAttrValue != &quot;&quot;) {
        sQryInfo = &quot;[&quot; + aElemInfo[4] + &quot; (&quot; + otsitavInfo + &quot;) [ &#x27;&quot; + ft + &quot;&#x27; (↔: &quot; + ft.length + &quot;)][&quot; + jsMid(sSeldItemId, sSeldItemId.lastIndexOf(&quot;&#x2F;&quot;) + 1) + &quot;: &#x27;&quot; + fa + &quot;&#x27;]]&quot;;
    } else {
        sQryInfo = &quot;[&quot; + aElemInfo[4] + &quot; (&quot; + otsitavInfo + &quot;) [ &#x27;&quot; + ft + &quot;&#x27; (↔: &quot; + ft.length + &quot;)]]&quot;;
    }
    if (!inp_UseSymbols.checked) {
        if (inp_UseCase.checked) {
            sQryInfo = sQryInfo + &quot;, &quot; + CASE_INSENSITIVE + &quot;, &quot; + SYMS_EXCLUDED;
        } else {
            sQryInfo = sQryInfo + &quot;, &quot; + CASE_SENSITIVE + &quot;, &quot; + SYMS_EXCLUDED;
        }
    } else {
        if (inp_UseCase.checked) {
            sQryInfo = sQryInfo + &quot;, &quot; + CASE_INSENSITIVE + &quot;, &quot; + SYMS_INCLUDED;
        } else {
            sQryInfo = sQryInfo + &quot;, &quot; + CASE_SENSITIVE + &quot;, &quot; + SYMS_INCLUDED;
        }
    }
    if (inp_UseGlobal.checked) {
        sQryInfo = sQryInfo + &quot;, &quot; + GLOBAL_WORD;
    } else {
        sQryInfo = sQryInfo + &quot;, &quot; + LOCAL_WORD;
    }


    showDbgVar(&quot;sSeldElemValue&quot;, sSeldElemValue, &quot;GetQueryParams&quot;, &quot;gqpAlgus&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;sSeldAttrValue&quot;, sSeldAttrValue, &quot;GetQueryParams&quot;, &quot;gqpAlgus&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;qt&quot;, qt, &quot;GetQueryParams&quot;, &quot;gqpAlgus&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;qtMySql&quot;, qtMySql, &quot;GetQueryParams&quot;, &quot;gqpAlgus&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;sNodeTest&quot;, sNodeTest, &quot;GetQueryParams&quot;, &quot;gqpAlgus&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;seldQn&quot;, seldQn, &quot;GetQueryParams&quot;, &quot;gqpAlgus&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;sQryInfo&quot;, sQryInfo, &quot;GetQueryParams&quot;, &quot;gqpAlgus&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;artRada&quot;, artRada, &quot;GetQueryParams&quot;, &quot;gqpAlgus&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;elemRada&quot;, elemRada, &quot;GetQueryParams&quot;, &quot;gqpAlgus&quot;, &quot; &quot;, new Date())


    &#x2F;&#x2F;&quot;päris&quot; elemendid, valitud artikkel ning otsitakse kas tühja v olematut artiklit
    if (aElemInfo[3] == &quot;1&quot; &amp;&amp; sNodeTest == artRada &amp;&amp; (ft == &quot;&quot; || ft == &quot;=NULL&quot;)) {
        return null;
    }

    var attXmlPred, attSqlPred, attPtrn, attSubst, mySqlAttCond, qM;
    attXmlPred = &quot;&quot;;
    attSqlPred = &quot;&quot;;
    attPtrn = &quot;&quot;;
    attSubst = &quot;&quot;;
    mySqlAttCond = &quot;&quot;;

    qM = qryMethod;

    var seldQnDecl, hasSeldText;
    hasSeldText = false;
    &#x2F;&#x2F;value = &#x27;qname|name|URI|IsElement|kirjeldav&#x27;
    if (aElemInfo[3] == &quot;1&quot;) {
        seldQnDecl = oSchRootElems.itemByQName(aElemInfo[1], aElemInfo[2]);
        if (seldQnDecl.type.itemType == SOMITEM_COMPLEXTYPE) {
            if (seldQnDecl.type.contentType == SCHEMACONTENTTYPE_TEXTONLY || seldQnDecl.type.contentType == SCHEMACONTENTTYPE_MIXED) {
                hasSeldText = true;
            }
        } else {
            hasSeldText = true;
        }
    }

    if (sSeldAttrValue != &quot;&quot;) {
        &#x2F;&#x2F;qname|name|URI|IsElement|kirjeldav;
        aAttrInfo = sSeldAttrValue.split(&quot;|&quot;);

        var mySqlMsAttNimi;
        if (seldQn == qn_ms) {
            if (aAttrInfo[0] == &quot;xml:lang&quot;) {
                mySqlMsAttNimi = &quot;ms_lang&quot;;
            } else {
                mySqlMsAttNimi = &quot;ms_att_&quot; + aAttrInfo[1];
            }
        }

        var rexBinary, attLikePtrn, atribuutValNimi;
        rexBinary = &quot;&quot;;
        if (withCase == 1) {
            rexBinary = &quot;BINARY &quot;;
        }
        attLikePtrn = getMySqlLikePtrn(fa);
        atribuutValNimi = &quot;val&quot;;
        &#x2F;&#x2F; atribuutide väärtused on kas numbrid (@i) või mallid või @mvtl; ehk siis kõik need kaovad &#x27;_nos&#x27; teisendustel
        &#x2F;&#x2F; seega on atribuutide puhul järgnev välja kommenteeritud
        &#x2F;&#x2F;        if ((withSymbols &lt; 1)) {
        &#x2F;&#x2F;            atribuutValNimi = &quot;val_nos&quot;;
        &#x2F;&#x2F;        }

        if (fa == &quot;*&quot;) {
            attXmlPred = &quot;[@&quot; + aAttrInfo[0] + &quot;]&quot;;
            attSqlPred = attXmlPred;
            if (seldQn == qn_ms &amp;&amp; !(inp_UseGlobal.checked &amp;&amp; dic_desc == &#x27;ss1&#x27;)) {
                mySqlAttCond = &quot; AND msid.&quot; + mySqlMsAttNimi + &quot; IS NOT NULL&quot;;
            } else {
                mySqlAttCond = &quot; AND atribuudid_&quot; + dic_desc + &quot;.nimi = BINARY &#x27;&quot; + aAttrInfo[0] + &quot;&#x27;&quot; + &quot; AND atribuudid_&quot; + dic_desc + &quot;.elG = elemendid_&quot; + dic_desc + &quot;.elG&quot;;
            }
        } else if (fa == &quot;&quot;) {
            attXmlPred = &quot;[@&quot; + aAttrInfo[0] + &quot; = &#x27;&#x27;]&quot;;
            attSqlPred = attXmlPred;
            if (seldQn == qn_ms &amp;&amp; !(inp_UseGlobal.checked &amp;&amp; dic_desc == &#x27;ss1&#x27;)) {
                mySqlAttCond = &quot; AND msid.&quot; + mySqlMsAttNimi + &quot; = &#x27;&#x27;&quot;;
            } else {
                mySqlAttCond = &quot; AND atribuudid_&quot; + dic_desc + &quot;.nimi = BINARY &#x27;&quot; + aAttrInfo[0] + &quot;&#x27;&quot; + &quot; AND atribuudid_&quot; + dic_desc + &quot;.&quot; + atribuutValNimi + &quot; = &#x27;&#x27;&quot; + &quot; AND atribuudid_&quot; + dic_desc + &quot;.elG = elemendid_&quot; + dic_desc + &quot;.elG&quot;;
            }
        } else if (fa == &quot;=NULL&quot;) {
            attXmlPred = &quot;[not(@&quot; + aAttrInfo[0] + &quot;)]&quot;;
            attSqlPred = attXmlPred;
            if (seldQn == qn_ms &amp;&amp; !(inp_UseGlobal.checked &amp;&amp; dic_desc == &#x27;ss1&#x27;)) {
                mySqlAttCond = &quot; AND msid.&quot; + mySqlMsAttNimi + &quot; IS NULL&quot;;
            } else {
                hasSeldText = false; &#x2F;&#x2F;las otsib ExtractValue kaudu;
            }
        } else {
            &#x2F;&#x2F;            if ((withSymbols &lt; 1)) {
            &#x2F;&#x2F;                if ((CheckForSymbols(fa, &quot;*?0123456789 &quot;))) { &#x2F;&#x2F;&#x27;2. parm VÕIB OLLA;
            &#x2F;&#x2F;                    rb = alert(CONT_QUERY_Q, vbQuestion, QUERY_WORD + &quot;: @&quot; + fa);
            &#x2F;&#x2F;                    return null;
            &#x2F;&#x2F;                }
            &#x2F;&#x2F;            }

            attPtrn = jsReplace(fa, &quot;&amp;amp;&quot;, &quot;&amp;&quot;);
            attPtrn = getSrPn2(attPtrn, &quot;XML&quot;);
            if (withCase == 0) {
                attPtrn = &quot;(?i)&quot; + attPtrn;
            }
            &#x2F;&#x2F;&quot;attPtrn&quot; läheb XML funktsiooni parameetrina, seega peab &#x27; asendama;
            attPtrn = jsReplace(attPtrn, &quot;&#x27;&quot;, &quot;\x27&quot;);
            &#x2F;&#x2F;            if ((withSymbols &lt; 1)) {
            &#x2F;&#x2F;                attSubst = &quot;&amp;\\w+;|[^\\p{L}\\d\\s]&quot;;
            &#x2F;&#x2F;            }
            attXmlPred = &quot;[al_p:srch2(@&quot; + aAttrInfo[0] + &quot;, &#x27;&quot; + attPtrn + &quot;&#x27;, &#x27;&quot; + attSubst + &quot;&#x27;) &gt; 0]&quot;;
            attSqlPred = &quot;[@&quot; + aAttrInfo[0] + getXPathPred(fa) + &quot;]&quot;

            if (seldQn == qn_ms &amp;&amp; !(inp_UseGlobal.checked &amp;&amp; dic_desc == &#x27;ss1&#x27;)) {
                mySqlAttCond = &quot; AND msid.&quot; + mySqlMsAttNimi + &quot; LIKE &quot; + rexBinary + attLikePtrn;
            } else {
                if (hasSeldText &amp;&amp; mySqlDataVer == &quot;2&quot;) { &#x2F;&#x2F;&#x27;muul juhul läheb &quot;attSqlPred&quot; kaudu MySql-i;
                    mySqlAttCond = &quot; AND atribuudid_&quot; + dic_desc + &quot;.nimi = BINARY &#x27;&quot; + aAttrInfo[0] + &quot;&#x27;&quot; + &quot; AND atribuudid_&quot; + dic_desc + &quot;.&quot; + atribuutValNimi + &quot; LIKE &quot; + rexBinary + attLikePtrn + &quot; AND atribuudid_&quot; + dic_desc + &quot;.elG = elemendid_&quot; + dic_desc + &quot;.elG&quot;;
                }
            }
        }
    }


    var elpred, srchPtrn, hlPtrn, fakPtrn, mySqlPtrn, pQrySql;
    var art_xpath, elm_xpath, arttingimus


    elpred = &quot;&quot;;
    srchPtrn = &quot;&quot;;
    hlPtrn = &quot;&quot;;

    fakPtrn = &quot;&quot;;
    if (seldQn == qn_ms &amp;&amp; fakult.length &gt; 0 &amp;&amp; withSymbols == -1) {
        fakPtrn = fakult;
    }

    mySqlPtrn = &quot;&quot;;

    pQrySql = &quot;&quot;;

    if (jsTrim(ft) == &quot;=.&quot;) {
        alert(&quot;Not invented!&quot;, vbExclamation);
        return null;
    } else if (jsTrim(ft) == &quot;!=.&quot;) {
        &#x2F;&#x2F;elpred = &quot;[not(.=preceding::&quot; + xmltag + &quot;)]&quot;;
        alert(&quot;Not invented!&quot;, vbExclamation);
        &#x2F;&#x2F;if (hasSeldText) {
        &#x2F;&#x2F;    &#x2F;&#x2F; kui on &#x27;hasSeldText&#x27;, siis &#x27;evPath&#x27; peaks olema kama
        &#x2F;&#x2F;    qM = &quot;MySql&quot;;
        &#x2F;&#x2F;    pQrySql = getSqlQuery(seldQn, ft, hasSeldText, withSymbols, withCase, evPath, elemRada, mySqlAttCond);
        &#x2F;&#x2F;}
        return null;
    } else if (jsLeft(jsTrim(ft), 2) == &quot;§§&quot;) {
        withSymbols = 1;
        withCase = 1;
        qM = &quot;XML&quot;;
        srchPtrn = jsTrim(ft).substr(2);
        srchPtrn = jsReplace(srchPtrn, &quot;\\u&quot;, &quot;\\p{Lu}&quot;); &#x2F;&#x2F;&#x27;suurtähed;
        srchPtrn = jsReplace(srchPtrn, &quot;\\l&quot;, &quot;\\p{Ll}&quot;); &#x2F;&#x2F;&#x27;väiketähed;
        srchPtrn = jsReplace(srchPtrn, &quot;\\k&quot;, &quot;[bcdfghjklmnpqrsšzžtvwx]&quot;); &#x2F;&#x2F;&#x27;eesti konsonandid;
        srchPtrn = jsReplace(srchPtrn, &quot;\\v&quot;, &quot;[aeiouõäöüy]&quot;); &#x2F;&#x2F;&#x27;eesti vokaalid;
        elpred = &quot;[al_p:srch(.) &gt; 0]&quot;;
        if (sNodeTest == artRada) { &#x2F;&#x2F;A;
            elm_xpath = &quot;self::node()&quot;;
            art_xpath = artRada + attXmlPred + &quot;[&quot; + qt + elpred + &quot;]&quot;;
            evPath = artRada + attSqlPred + qtMySql;
        } else {
            arttingimus = elemRada + attXmlPred + &quot;[&quot; + qt + elpred + &quot;]&quot;;
            elm_xpath = arttingimus;
            art_xpath = artRada + &quot;[&quot; + arttingimus + &quot;]&quot;;
            evPath = elemRada + attSqlPred + qtMySql;
        }
        &#x2F;&#x2F;        if ((jsLeft(srchPtrn, 4) == &quot;(?õ)&quot;)) { &#x2F;&#x2F;&#x27;?õ - kirjastiile mitte arvestada;
        &#x2F;&#x2F;            mySqlPtrn = jsMid(srchPtrn, 4);
        &#x2F;&#x2F;        } else {
        &#x2F;&#x2F;            mySqlPtrn = srchPtrn;
        &#x2F;&#x2F;        }
        &#x2F;&#x2F;        hlPtrn = mySqlPtrn;
        &#x2F;&#x2F;        hlPtrn = jsReplace(hlPtrn, &quot;[^&quot;, JR);
        &#x2F;&#x2F;        hlPtrn = jsReplace(hlPtrn, &quot;^&quot;, &quot;\\b&quot;);
        &#x2F;&#x2F;        hlPtrn = jsReplace(hlPtrn, JR, &quot;[^&quot;);
        &#x2F;&#x2F;        hlPtrn = jsReplace(hlPtrn, &quot;$&quot;, &quot;\\b&quot;);
        &#x2F;&#x2F;        &#x2F;&#x2F;    mySqlPtrn = jsReplace(mySqlPtrn, &quot;\&quot;, &quot;\\&quot;)
        &#x2F;&#x2F;        mySqlPtrn = jsReplace(mySqlPtrn, &quot;\\-&quot;, &quot;[.-.]&quot;);
        &#x2F;&#x2F;        mySqlPtrn = jsReplace(mySqlPtrn, &quot;\\(&quot;, &quot;[.(.]&quot;);
        &#x2F;&#x2F;        mySqlPtrn = jsReplace(mySqlPtrn, &quot;\\)&quot;, &quot;[.).]&quot;);
        &#x2F;&#x2F;        mySqlPtrn = jsReplace(mySqlPtrn, &quot;\\[&quot;, &quot;[.[.]&quot;);
        &#x2F;&#x2F;        mySqlPtrn = jsReplace(mySqlPtrn, &quot;\\]&quot;, &quot;[.].]&quot;);
        &#x2F;&#x2F;    substPtrn = &quot;+[a-z]+;&quot;
        &#x2F;&#x2F;    mySqlPtrn = jsMid(srchPtrn, InStr(1, srchPtrn, &quot;)&quot;) + 1)
        &#x2F;&#x2F;    mySqlPtrn = jsReplace(mySqlPtrn, &quot;\&quot;, &quot;\\&quot;)
        &#x2F;&#x2F;    hlPtrn = srchPtrn
        &#x2F;&#x2F;    if(! (seldQn = qn_ms)){ &#x27;qn_ms = default_query tagumine ots
        &#x2F;&#x2F;        mySqlPtrn = jsReplace(mySqlPtrn, &quot;^&quot;, &quot;[[:&lt;:]]&quot;)
        &#x2F;&#x2F;        mySqlPtrn = jsReplace(mySqlPtrn, &quot;$&quot;, &quot;[[:&gt;:]]&quot;)
        &#x2F;&#x2F;        hlPtrn = jsReplace(hlPtrn, &quot;^&quot;, &quot;\b&quot;)
        &#x2F;&#x2F;        hlPtrn = jsReplace(hlPtrn, &quot;$&quot;, &quot;\b&quot;)
        &#x2F;&#x2F;    }
    } else if (jsLeft(jsTrim(ft), 1) == &quot;§&quot;) {
        elpred = &quot;[&quot; + jsTrim(ft).substr(1) + &quot;]&quot;;
        if ((sNodeTest == artRada)) { &#x2F;&#x2F;A;
            elm_xpath = &quot;self::node()&quot;;
            art_xpath = artRada + attXmlPred + elpred;
        } else {
            arttingimus = elemRada + attXmlPred + elpred;
            elm_xpath = arttingimus;
            art_xpath = artRada + &quot;[&quot; + arttingimus + &quot;]&quot;;
        }
        &#x2F;&#x2F;MySQL &quot;extractValue&quot; tegutseb juurika tasemel (ehk siis &quot;A&quot;);
        evPath = evPath + attSqlPred + elpred + qtMySql;
        &#x2F;&#x2F;•The :: operator == ! supported in combination with node types such as the following;
        if ((elpred.indexOf(&quot;::comment()&quot;) &gt; -1 || elpred.indexOf(&quot;::text()&quot;) &gt; -1 || elpred.indexOf(&quot;::processing-instruction()&quot;) &gt; -1 || elpred.indexOf(&quot;::node()&quot;) &gt; -1)) {
            qM = &quot;XML&quot;;
        }
        &#x2F;&#x2F;axes ! supported in MySQL ExtractValue;
        if ((elpred.indexOf(&quot;following-sibling::&quot;) &gt; -1 || elpred.indexOf(&quot;following::&quot;) &gt; -1 || elpred.indexOf(&quot;preceding-sibling::&quot;) &gt; -1 || elpred.indexOf(&quot;preceding::&quot;) &gt; -1)) {
            qM = &quot;XML&quot;;
        }
        &#x2F;&#x2F;functions ! supported in MySQL ExtractValue;
        if ((elpred.indexOf(&quot;id(&quot;) &gt; -1 || elpred.indexOf(&quot;lang(&quot;) &gt; -1 || elpred.indexOf(&quot;local-name(&quot;) &gt; -1 || elpred.indexOf(&quot;name(&quot;) &gt; -1 || elpred.indexOf(&quot;namespace-uri(&quot;) &gt; -1 || elpred.indexOf(&quot;normalize-space(&quot;) &gt; -1 || elpred.indexOf(&quot;starts-with(&quot;) &gt; -1 || elpred.indexOf(&quot;string(&quot;) &gt; -1 || elpred.indexOf(&quot;substring-after(&quot;) &gt; -1 || elpred.indexOf(&quot;substring-before(&quot;) &gt; -1 || elpred.indexOf(&quot;translate(&quot;) &gt; -1)) {
            qM = &quot;XML&quot;;
        }
        &#x2F;&#x2F;ka Perl funktsioonid tuleb siit välja arvata (srch, srch2);
        if ((elpred.indexOf(&quot;al_p:srch&quot;) &gt; -1)) {
            qM = &quot;XML&quot;;
        }
        &#x2F;&#x2F;kui XPath tingimuse SEES on on veel mingi tingimus ja sisemist tingimust rahuldab rohkem kui 1 juhus,;
        &#x2F;&#x2F;select * from vsl where extractvalue(art,&quot;z:A[z:P&#x2F;z:mg[z:m[not(@z:zs)] &amp;&amp; z:etg&#x2F;z:etgg&#x2F;z:keel = &#x27;ld&#x27;]]&#x2F;&#x2F;text()&quot;) != &#x27;&#x27; &amp;&amp; vol_nr&gt;0;;
        &#x2F;&#x2F;select * from vsl where extractvalue(art,&quot;z:A&#x2F;z:P&#x2F;z:mg[z:m[not(@z:zs)] &amp;&amp; z:etg&#x2F;z:etgg&#x2F;z:keel = &#x27;ld&#x27;]&#x2F;&#x2F;text()&quot;) != &#x27;&#x27; &amp;&amp; vol_nr&gt;0;;
        &#x2F;&#x2F;MySQL ei suuda seda leida. Senikaua - kui selgusetu - olgu alati &quot;XML&quot;;
        qM = &quot;XML&quot;;
        withCase = 1;
        withSymbols = 1;
        &#x2F;&#x2F; et kas elemendil on teksti ette näthud v mitte (hasSeldText)
        &#x2F;&#x2F; kui &#x27;false&#x27;, siis läheb alati ExtractValue kaudu
        hasSeldText = false;
        pQrySql = getSqlQuery(seldQn, ft, hasSeldText, withSymbols, withCase, evPath, elemRada, mySqlAttCond);
    } else {
        &#x2F;&#x2F;serveris otsib &#x27;srch&#x27; tectContent&#x27; abil, selles aga &#x27;&amp;amp;&#x27; -&gt; &#x27;&amp;&#x27;;
        srchPtrn = jsReplace(ft, &quot;&amp;amp;&quot;, &quot;&amp;&quot;);
        srchPtrn = getSrPn2(srchPtrn, &quot;XML&quot;);
        hlPtrn = srchPtrn &#x2F;&#x2F;hlPtrn: ainult MySql meetodi jaoks värvimisel;
        hlPtrn = jsReplace(hlPtrn, &quot;^&quot;, &quot;\\b&quot;);
        hlPtrn = jsReplace(hlPtrn, &quot;$&quot;, &quot;\\b&quot;);

        var qtTing;
        if (ft == &quot;*&quot;) {
            withSymbols = 1; &#x2F;&#x2F; XML: vahet pole; mysql: art_alt ja val_nos on tühjad. Vale tulemus
            elpred = &quot;&quot;;
            qtTing = &quot;&quot;;
            evPath = evPath + attSqlPred + qtMySql;
        } else if (ft == &quot;&quot;) {
            withSymbols = 1; &#x2F;&#x2F; XML: vahet pole; mysql: art_alt ja val_nos on tühjad. Vale tulemus
            elpred = &quot;[. = &#x27;&#x27;]&quot;;
            qtTing = elpred;
            evPath = evPath + attSqlPred + elpred + qtMySql;
        } else if (ft == &quot;=NULL&quot;) { &#x2F;&#x2F;&#x27;A korral ei täideta, vt ülal;
            seldQn = artRada;
            hasSeldText = false;  &#x2F;&#x2F;otsitav element muutus &lt;A&gt;, sellel pole mysql tabelites teksti ega atribuute;
            withSymbols = 1;
            withCase = 1;
            &#x2F;&#x2F;        elpred = &quot;[not(&quot; + elemRada + &quot;)]&quot; &#x27; see vist ei käivitunud MySql XML-i &quot;not()&quot; iseärasuste tõttu
            elpred = &quot;[count(&quot; + elemRada + &quot;) = 0]&quot;;
            qtTing = elpred;
            evPath = artRada + elpred + &quot;&#x2F;&#x2F;text()&quot;;  &#x2F;&#x2F;&#x27;sõltumata &quot;qtMySql&quot; - ist
            attXmlPred = &quot;&quot;; &#x2F;&#x2F;&#x27;ei ole kasutatav atr tingimus, kui otsime elementi, mida pole;
            mySqlAttCond = &quot;&quot;;
        } else {
            if (withSymbols &lt; 1) {
                if (CheckForSymbols(ft, &quot;*? &quot;)) { &#x2F;&#x2F;&#x27;2. parm VÕIB OLLA;
                    rb = alert(CONT_QUERY_Q + &#x27;\n&#x27; + QUERY_WORD + &quot;: &lt;&quot; + ft + &quot;&gt;&quot;);
                    return null;
                }
            }

            elpred = &quot;[al_p:srch(.) &gt; 0]&quot;;
            qtTing = &quot;[&quot; + qt + elpred + &quot;]&quot;;
            evPath = evPath + attSqlPred + qtMySql;
        }

        if (seldQn == artRada) { &#x2F;&#x2F;A;
            elm_xpath = &quot;self::node()&quot;;
            art_xpath = artRada + attXmlPred + qtTing;
        } else {
            arttingimus = elemRada + attXmlPred + qtTing;
            elm_xpath = arttingimus;
            art_xpath = artRada + &quot;[&quot; + arttingimus + &quot;]&quot;;
        }

        &#x2F;&#x2F;value = &#x27;qname|name|URI|IsElement|kirjeldav&#x27;;
        if (aElemInfo[3] == &quot;1&quot;) {
            if (inp_UseGlobal.checked &amp;&amp; dic_desc == &#x27;ss1&#x27; &amp;&amp; seldQn == qn_ms) {
                &#x2F;&#x2F; pQrySql = getSqlQuery(&quot;x:yyyyy&quot;, ft, false, withSymbols, withCase, evPath, elemRada, mySqlAttCond);
                &#x2F;&#x2F; *[self::s:m or self::s:tul or self::s:mm or self::s:rv]
                pQrySql = getSqlQuery(&quot;s:m;s:tul;s:mm;s:rv&quot;, ft, hasSeldText, withSymbols, withCase, evPath, elemRada, mySqlAttCond);
            } else {
                pQrySql = getSqlQuery(seldQn, ft, hasSeldText, withSymbols, withCase, evPath, elemRada, mySqlAttCond);
            }
        }

        &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;        &#x2F;&#x2F; kui küsida gruppe, siis päringutulemuste tabelis oleks vaja näha ka grupi atribuute:
        &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;        &#x2F;&#x2F; teksti omavate väljade korral käib päring vaikimisi MySQL kaudu, gruppide korral XML kaudu
        &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;        if (!hasSeldText) {
        &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;            qM = &quot;XML&quot;;
        &#x2F;&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;        }

    }

    if (aElemInfo[3] != &quot;1&quot;) { &#x2F;&#x2F; koond- v valmispäringud
        qM = aElemInfo[5];
        if (qM == &quot;XML&quot;) {
            sNodeTest = sNodeTest.replace(&#x2F;\[%s\]&#x2F;g, elpred);
            sNodeTest = sNodeTest.replace(&#x2F;\[%t\]&#x2F;g, ft);
            arttingimus = sNodeTest.substr(4);
            art_xpath = artRada + &quot;[&quot; + arttingimus + &quot;]&quot;;
            elm_xpath = &quot;self::node()&quot;;
&#x2F;&#x2F;        } else {
&#x2F;&#x2F;            mySqlPtrn = getMySqlLikePtrn(ft); &#x2F;&#x2F; koos ülakomadega
&#x2F;&#x2F;            var sqlMsCond = mySqlPtrn, sqlMsField = &quot;msid.ms&quot;, sqlVolCond = &quot;&gt; 0&quot;;
&#x2F;&#x2F;            if (withCase == 1) {
&#x2F;&#x2F;                sqlMsCond = &quot;BINARY &quot; + sqlMsCond;
&#x2F;&#x2F;            }
&#x2F;&#x2F;            if (withSymbols &lt; 1) {
&#x2F;&#x2F;                sqlMsField = &quot;msid.ms_nos&quot;;
&#x2F;&#x2F;            }
&#x2F;&#x2F;            var volId = sel_Vol.options(sel_Vol.selectedIndex).id;
&#x2F;&#x2F;            if (volId != sAllVolId) {
&#x2F;&#x2F;                sqlVolCond = &quot;= &quot; + volId.substr(3, 1);
&#x2F;&#x2F;            }
&#x2F;&#x2F;            pQrySql = sNodeTest;
&#x2F;&#x2F;            pQrySql = pQrySql.replace(&#x2F;\[%t\]&#x2F;g, sqlMsCond);
&#x2F;&#x2F;            pQrySql = pQrySql.replace(&#x2F;\[%msVäli%\]&#x2F;g, sqlMsField);
&#x2F;&#x2F;            pQrySql = pQrySql.replace(&#x2F;\[%köiteTing%\]&#x2F;g, sqlVolCond);
        }
    }

    showDbgVar(&quot;attXmlPred&quot;, attXmlPred, &quot;GetQueryParams&quot;, &quot;gqpLõpp&quot;, &quot; &quot;, new Date())

    showDbgVar(&quot;elpred&quot;, elpred, &quot;GetQueryParams&quot;, &quot;gqpLõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;arttingimus&quot;, arttingimus, &quot;GetQueryParams&quot;, &quot;gqpLõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;art_xpath&quot;, art_xpath, &quot;GetQueryParams&quot;, &quot;gqpLõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;elm_xpath&quot;, elm_xpath, &quot;GetQueryParams&quot;, &quot;gqpLõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;srchPtrn&quot;, srchPtrn, &quot;GetQueryParams&quot;, &quot;gqpLõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;fakPtrn&quot;, fakPtrn, &quot;GetQueryParams&quot;, &quot;gqpLõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;hlPtrn&quot;, hlPtrn, &quot;GetQueryParams&quot;, &quot;gqpLõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;mySqlPtrn&quot;, mySqlPtrn, &quot;GetQueryParams&quot;, &quot;gqpLõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;evPath&quot;, evPath, &quot;GetQueryParams&quot;, &quot;gqpLõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;qM&quot;, qM, &quot;GetQueryParams&quot;, &quot;gqpLõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;pQrySql&quot;, pQrySql, &quot;GetQueryParams&quot;, &quot;gqpLõpp&quot;, &quot; &quot;, new Date())


    var sPrmDomXml, oPrmDom;
    sPrmDomXml = &quot;&lt;prm&gt;&quot; +
                &quot;&lt;cmd&gt;&lt;&#x2F;cmd&gt;&quot; +
                &quot;&lt;vol&gt;&lt;&#x2F;vol&gt;&quot; +
                &quot;&lt;nfo&gt;&lt;&#x2F;nfo&gt;&quot; +
                &quot;&lt;axp&gt;&lt;&#x2F;axp&gt;&quot; +
                &quot;&lt;exp&gt;&lt;&#x2F;exp&gt;&quot; +
                &quot;&lt;wC&gt;&lt;&#x2F;wC&gt;&quot; +
                &quot;&lt;wS&gt;&lt;&#x2F;wS&gt;&quot; +
                &quot;&lt;evP&gt;&lt;&#x2F;evP&gt;&quot; +
                &quot;&lt;qn&gt;&lt;&#x2F;qn&gt;&quot; +
                &quot;&lt;fSrP&gt;&lt;&#x2F;fSrP&gt;&quot; +
                &quot;&lt;pFakPtrn&gt;&lt;&#x2F;pFakPtrn&gt;&quot; +
                &quot;&lt;fMsqlP&gt;&lt;&#x2F;fMsqlP&gt;&quot; +
                &quot;&lt;hlP&gt;&lt;&#x2F;hlP&gt;&quot; +
                &quot;&lt;qM&gt;&lt;&#x2F;qM&gt;&quot; +
                &quot;&lt;pQrySql&gt;&lt;&#x2F;pQrySql&gt;&quot; +
               &quot;&lt;&#x2F;prm&gt;&quot;;

    oPrmDom = IDD(&quot;String&quot;, sPrmDomXml, false, false, null);
    if ((oPrmDom.parseError.errorCode == 0)) {
        &#x2F;&#x2F;cmd ja vol täidetakse &#x27;btnRunQuery&#x27;-is;
        oPrmDom.documentElement.selectSingleNode(&quot;nfo&quot;).text = sQryInfo;
        oPrmDom.documentElement.selectSingleNode(&quot;axp&quot;).text = art_xpath;
        oPrmDom.documentElement.selectSingleNode(&quot;exp&quot;).text = elm_xpath;
        oPrmDom.documentElement.selectSingleNode(&quot;wC&quot;).text = withCase;
        oPrmDom.documentElement.selectSingleNode(&quot;wS&quot;).text = withSymbols;
        oPrmDom.documentElement.selectSingleNode(&quot;evP&quot;).text = evPath;
        oPrmDom.documentElement.selectSingleNode(&quot;qn&quot;).text = seldQn;
        oPrmDom.documentElement.selectSingleNode(&quot;fSrP&quot;).text = srchPtrn;
        oPrmDom.documentElement.selectSingleNode(&quot;pFakPtrn&quot;).text = fakPtrn;
        oPrmDom.documentElement.selectSingleNode(&quot;fMsqlP&quot;).text = mySqlPtrn;
        oPrmDom.documentElement.selectSingleNode(&quot;hlP&quot;).text = escape(hlPtrn);
        oPrmDom.documentElement.selectSingleNode(&quot;qM&quot;).text = qM;
        oPrmDom.documentElement.selectSingleNode(&quot;pQrySql&quot;).text = pQrySql;
    }

    return oPrmDom;
} &#x2F;&#x2F;GetQueryParams


&#x2F;**
* 
*
* @method getSqlQuery
* @param {Object} qn (a la jsMid(default_query, default_query.lastIndexOf(&quot;&#x2F;&quot;) + 1); )
* @param {String} txt
* @param {Boolean} onTeksti
* @param {Int} wsym
* @param {Int} wcase
* @param {String} extvalpath
* @param {String} elRada 
* @param {String} msAttCond
* @returns {String} 
*&#x2F;
function getSqlQuery(qn, txt, onTeksti, wsym, wcase, extvalpath, elRada, msAttCond) {
    var rexBinary, volId, volCond, ret;
    rexBinary = &quot;&quot;;
    if (wcase == 1) {
        rexBinary = &quot;BINARY &quot;;
    }
    volId = sel_Vol.options(sel_Vol.selectedIndex).id;
    volCond = dic_desc + &quot;.vol_nr = &quot; + jsMid(volId, 3, 1);
    if (volId == sAllVolId) {
        volCond = dic_desc + &quot;.vol_nr &gt; 0&quot;;
    }

    &#x2F;&#x2F;MySQL LIKE on tegelikult string võrdlemise funktsioon: expr LIKE pat
    &#x2F;&#x2F;&quot;lihtne&quot; regexp
    var mySqlLikePtrn = getMySqlLikePtrn(txt)

    var mySqlPtrn = getSrPn2(txt, &quot;MySql&quot;);
    &#x2F;&#x2F;need kuradi ^ või [:&lt;:] EI OLE MySQL-is üks ja sama stringi alguse korral!
    mySqlPtrn = jsReplace(mySqlPtrn, &quot;^&quot;, &quot;(^|[[:&lt;:]])&quot;);
    mySqlPtrn = jsReplace(mySqlPtrn, &quot;$&quot;, &quot;($|[[:&gt;:]])&quot;);

    ret = &quot;&quot;;
    if (qn == (qn_ms)) {
        var msTekstTing;
        if ((txt == &quot;*&quot;)) {
            msTekstTing = &quot;&quot;;
        } else {
            msTekstTing = &quot;msid.ms LIKE &quot; + rexBinary + mySqlLikePtrn;
            &#x2F;&#x2F;withSymbols: 0-sümboliteta; -1-sümboliteta ja fak tekstiga; 1-sümbolitega;
            if ((wsym &lt; 1)) {
                msTekstTing = &quot;msid.ms_nos LIKE &quot; + rexBinary + mySqlLikePtrn;
                if ((fakult.length &gt; 0 &amp;&amp; wsym == -1)) {
                    msTekstTing = msTekstTing + &quot; OR msid.ms_nos_alt LIKE &quot; + rexBinary + mySqlLikePtrn;
                }
            }
            msTekstTing = &quot; AND (&quot; + msTekstTing + &quot;)&quot;;
        }
        ret = &quot;SELECT &quot; + dic_desc + &quot;.md AS md, &quot; + &quot;msid.ms AS l, &quot; +
            &quot;msid.ms_att_i AS ms_att_i, msid.ms_att_liik AS ms_att_liik, &quot; +
            &quot;msid.ms_att_ps AS ms_att_ps, msid.ms_att_tyyp AS ms_att_tyyp, msid.ms_att_mliik AS ms_att_mliik, &quot; +
            &quot;msid.ms_att_k AS ms_att_k, msid.ms_att_mm AS ms_att_mm, msid.ms_att_st AS ms_att_st, &quot; +
            &quot;msid.ms_att_vm AS ms_att_vm, msid.ms_att_all AS ms_att_all, msid.ms_att_uus AS ms_att_uus, &quot; +
            &quot;msid.ms_att_zs AS ms_att_zs, msid.ms_att_u AS ms_att_u, msid.ms_att_em AS ms_att_em, &quot; +
            dic_desc + &quot;.G AS G, &quot; + dic_desc + &quot;.art AS art, &quot; +
            dic_desc + &quot;.K AS K, &quot; + dic_desc + &quot;.KL AS KL, &quot; +
            dic_desc + &quot;.T AS T, &quot; + dic_desc + &quot;.TA AS TA, &quot; + dic_desc + &quot;.TL AS TL, &quot; +
            dic_desc + &quot;.PT AS PT, &quot; + dic_desc + &quot;.PTA AS PTA, &quot; +
            dic_desc + &quot;.vol_nr AS vol_nr &quot; + &quot;FROM msid, &quot; + dic_desc +
            &quot; WHERE (&quot; + dic_desc + &quot;.G = msid.G&quot; +
            &quot; AND msid.dic_code = &#x27;&quot; + dic_desc + &quot;&#x27;&quot; + msTekstTing + msAttCond + &quot; AND &quot; + volCond + &quot;)&quot; +
            &quot; ORDER BY &quot; + dic_desc + &quot;.ms_att_OO&quot;;
    } else {
        var elementValNimi, artValNimi, elementTing, fromTing;
        elementValNimi = &quot;val&quot;;
        artValNimi = &quot;art&quot;;
        if (wsym &lt; 1) {
            elementValNimi = &quot;val_nos&quot;;
            artValNimi = &quot;art_alt&quot;;
        }
        if (onTeksti &amp;&amp; mySqlDataVer == &quot;2&quot;) {
            var ix, qryElemendid = qn.split(&quot;;&quot;);
            elementTing = &quot;&quot;;
            for (ix = 0; ix &lt; qryElemendid.length; ix++) {
                if (elementTing.length &gt; 0) {
                    elementTing += &quot; OR &quot;;
                }
                elementTing += &quot;elemendid_&quot; + dic_desc + &quot;.nimi = BINARY &#x27;&quot; + qryElemendid[ix] + &quot;&#x27;&quot;;
            }
            if (qryElemendid.length &gt; 1) {
                elementTing = &quot;(&quot; + elementTing + &quot;)&quot;;
            }
            if (txt == &quot;*&quot;) {
            } else {
                &#x2F;&#x2F;siin peaks midagi optimiseerima, nt päring sl=&#x27;*&#x27;;
                elementTing = elementTing + &quot; AND elemendid_&quot; + dic_desc + &quot;.&quot; + elementValNimi + &quot; LIKE &quot; + rexBinary + mySqlLikePtrn;
            }
            if (!(elRada.substr(0, 3) == &quot;.&#x2F;&#x2F;&quot; || elRada == &quot;&quot;)) { &#x2F;&#x2F;&#x27;on lokaalne; &quot;.&#x2F;&#x2F;&quot; korral on globaalne, &quot;&quot; korral on &#x27;art&#x27;;
                elementTing = elementTing + &quot; AND elemendid_&quot; + dic_desc + &quot;.rada = BINARY &#x27;&quot; + elRada + &quot;&#x27;&quot;;
            }
            elementTing = &quot; AND (&quot; + elementTing + msAttCond + &quot;)&quot;;
            fromTing = &quot;&quot;;
            if (msAttCond.indexOf(&quot;atribuudid_&quot; + dic_desc) &gt; -1) {
                &#x2F;&#x2F;1 = 1;
                if (msAttCond.indexOf(&quot;select &quot; + dic_desc, 1) &lt; 0) {
                    fromTing = &quot;, atribuudid_&quot; + dic_desc;
                }
            }
            ret = &quot;SELECT &quot; + dic_desc + &quot;.md AS md, &quot; + &quot;elemendid_&quot; + dic_desc + &quot;.val AS l, elemendid_&quot; + dic_desc + &quot;.elG AS elG, &quot; +
                dic_desc + &quot;.G AS G, &quot; + dic_desc + &quot;.art AS art, &quot; +
                dic_desc + &quot;.K AS K, &quot; + dic_desc + &quot;.KL AS KL, &quot; +
                dic_desc + &quot;.T AS T, &quot; + dic_desc + &quot;.TA AS TA, &quot; + dic_desc + &quot;.TL AS TL, &quot; +
                dic_desc + &quot;.PT AS PT, &quot; + dic_desc + &quot;.PTA AS PTA, &quot; +
                dic_desc + &quot;.vol_nr AS vol_nr &quot; +
                &quot;FROM &quot; + dic_desc + &quot;, elemendid_&quot; + dic_desc + fromTing +
                &quot; WHERE (&quot; + dic_desc + &quot;.G = elemendid_&quot; + dic_desc + &quot;.G&quot; + elementTing +
                &quot; AND &quot; + volCond + &quot;)&quot; +
                &quot; ORDER BY &quot; + dic_desc + &quot;.ms_att_OO&quot;;
        } else {
            if (txt == &quot;*&quot;) {
                elementTing = &quot; != &#x27;&#x27;&quot;;
            } else if (txt == &quot;=NULL&quot;) {
                elementTing = &quot; != &#x27;&#x27;&quot;;
            } else if (txt.substr(0, 1) == &quot;§&quot;) {
                elementTing = &quot; != &#x27;&#x27;&quot;;
            } else {
                elementTing = &quot; regexp &quot; + rexBinary + &quot;&#x27;&quot; + mySqlPtrn + &quot;&#x27;&quot;;
            }
            &#x2F;&#x2F;&#x27;extvalpath: nt &quot;.&#x2F;&#x2F;s:etp&#x2F;&#x2F;text()&quot;
            ret = &quot;SELECT &quot; + dic_desc + &quot;.md AS md, &quot; +
                &quot;ExtractValue(&quot; + dic_desc + &quot;.art, \&quot;&quot; + extvalpath + &quot;\&quot;) AS l, &quot; +
                dic_desc + &quot;.G AS G, &quot; + dic_desc + &quot;.art AS art, &quot; +
                dic_desc + &quot;.K AS K, &quot; + dic_desc + &quot;.KL AS KL, &quot; +
                dic_desc + &quot;.T AS T, &quot; + dic_desc + &quot;.TA AS TA, &quot; + dic_desc + &quot;.TL AS TL, &quot; +
                dic_desc + &quot;.PT AS PT, &quot; + dic_desc + &quot;.PTA AS PTA, &quot; +
                dic_desc + &quot;.vol_nr AS vol_nr &quot; + &quot;FROM &quot; + dic_desc +
                &quot; WHERE (ExtractValue(&quot; + dic_desc + &quot;.&quot; + artValNimi + &quot;, \&quot;&quot; + extvalpath + &quot;\&quot;)&quot; + elementTing +
                &quot; AND &quot; + volCond + &quot;)&quot; +
                &quot; ORDER BY &quot; + dic_desc + &quot;.ms_att_OO&quot;;
        }
    }

    return ret;
} &#x2F;&#x2F;getSqlQuery



&#x2F;**
* 
*
* @method getMySqlLikePtrn
* @param {String} inp
* @returns {String} 
*&#x2F;
function getMySqlLikePtrn(inp) {
    var ret, escCh, escCl;
    ret = inp;

    &#x2F;&#x2F;MySql LIKE bug:
    &#x2F;&#x2F;select * from msid where dic_code=&#x27;ss_&#x27; &amp;&amp; vol_nr&gt;0;
    &#x2F;&#x2F; select * from msid where dic_code=&#x27;ss_&#x27; &amp;&amp; vol_nr&gt;0 &amp;&amp; ms like &#x27;%\\\\%&#x27;;
    &#x2F;&#x2F; select * from msid where dic_code=&#x27;ss_&#x27; &amp;&amp; vol_nr&gt;0 &amp;&amp; locate(&#x27;\\&#x27;, ms)&gt;0;
    &#x2F;&#x2F; select * from msid where dic_code=&#x27;ss_&#x27; &amp;&amp; vol_nr&gt;0 &amp;&amp; ms like &#x27;%\\tõde&#x27;;
    &#x2F;&#x2F; select * from msid where dic_code=&#x27;ss_&#x27; &amp;&amp; vol_nr&gt;0 &amp;&amp; ms like &#x27;%\\kirjandus&#x27;;
    &#x2F;&#x2F; select * from msid where dic_code=&#x27;ss_&#x27; &amp;&amp; vol_nr&gt;0 &amp;&amp; ms like &#x27;%€\%&#x27; escape &#x27;€&#x27;;

    if ((ret.indexOf(&quot;\\&quot;) &gt; -1)) {
        escCh = &quot;¡&quot;;
        escCl = &quot; ESCAPE &#x27;¡&#x27;&quot;;
    } else {
        escCh = &quot;\\&quot;;
        escCl = &quot;&quot;;
    }
    &#x2F;&#x2F; märksõnad &lt;m&gt;
    &#x2F;&#x2F; ss_ (sama puuk mis allpool?: (msid.ms LIKE &#x27;%¡\kon%&#x27; ESCAPE &#x27;¡&#x27;) annab nii kaldkriipsu kui ka &#x27;kon&#x27;)
    ret = jsReplace(ret, &quot;\\\\&quot;, &quot;\uE003&quot;);
    &#x2F;&#x2F; ss1
    ret = jsReplace(ret, &quot;\\*&quot;, &quot;\uE001&quot;);
    &#x2F;&#x2F; ss_, fin
    ret = jsReplace(ret, &quot;\\?&quot;, &quot;\uE002&quot;);
    &#x2F;&#x2F; qs_, evs
    ret = jsReplace(ret, &quot;_&quot;, &quot;\\_&quot;);
    &#x2F;&#x2F; qs_
    ret = jsReplace(ret, &quot;&#x27;&quot;, escCh + &quot;&#x27;&quot;);
    &#x2F;&#x2F; evs (puuk?: (msid.ms LIKE &#x27;%\%m%&#x27;) annab justnagu &#x27;%&#x27; ning &#x27;m&#x27;)
    ret = jsReplace(ret, &quot;%&quot;, escCh + &quot;%&quot;);
    ret = jsReplace(ret, &quot;?&quot;, &quot;_&quot;);
    ret = jsReplace(ret, &quot;*&quot;, &quot;%&quot;);
    ret = jsReplace(ret, &quot;\uE001&quot;, &quot;*&quot;);
    ret = jsReplace(ret, &quot;\uE002&quot;, &quot;?&quot;);
    ret = jsReplace(ret, &quot;\uE003&quot;, escCh + &quot;\\&quot;);
    if ((ret.indexOf(&quot;&#x27;&quot;) &gt; -1)) {
        ret = &quot;\&quot;&quot; + ret + &quot;\&quot;&quot;;
    } else {
        ret = &quot;&#x27;&quot; + ret + &quot;&#x27;&quot;;
    }
    ret = ret + escCl

    return ret;
} &#x2F;&#x2F;getMySqlLikePtrn


&#x2F;**
* 
*
* @method GCV
* @param {String} sInpStr
* @param {String} lisa
* @param {Int} kuhu
* @returns {String} 
*&#x2F;
function GCV(sInpStr, lisa, kuhu) {
    var sGCV, i, tarr;
    sGCV = &quot;&quot;

    if ((sInpStr == &quot;&#x27;&quot;)) {
        if ((kuhu == 0)) {
            sGCV = &quot;\&quot;&quot; + lisa + &quot;&#x27;\&quot;&quot;;
        } else {
            sGCV = &quot;\&quot;&#x27;&quot; + lisa + &quot;\&quot;&quot;;
        }
    } else if ((sInpStr.indexOf(&quot;&#x27;&quot;) &gt; -1)) {
        tarr = sInpStr.split(&quot;&#x27;&quot;);
        for (i = 0; i &lt; tarr.length; i++) {
            if (!(tarr[i] == &quot;&quot;)) {
                sGCV = sGCV + &quot;,&#x27;&quot; + tarr[i] + &quot;&#x27;&quot;;
            }

            if ((i &lt; tarr.length - 1)) {
                sGCV = sGCV + &quot;,\&quot;&#x27;\&quot;&quot;;
            }
        }
        if (!(lisa == &quot;&quot;)) {
            if ((kuhu == 0)) {
                sGCV = &quot;concat(&#x27;&quot; + lisa + &quot;&#x27;, &quot; + jsMid(sGCV, 1) + &quot;)&quot;;
            } else {
                sGCV = &quot;concat(&quot; + jsMid(sGCV, 1) + &quot;, &#x27;&quot; + lisa + &quot;&#x27;)&quot;;
            }
        } else {
            sGCV = &quot;concat(&quot; + jsMid(sGCV, 1) + &quot;)&quot;;
        }
    } else {
        if ((kuhu == 0)) {
            sGCV = &quot;&#x27;&quot; + lisa + sInpStr + &quot;&#x27;&quot;;
        } else {
            sGCV = &quot;&#x27;&quot; + sInpStr + lisa + &quot;&#x27;&quot;;
        }
    }
    return sGCV;
} &#x2F;&#x2F;GCV

&#x2F;**
* 
*
* @method getXPathPred
* @param {String} inp
* @returns {String} 
*&#x2F;
function getXPathPred(inp) {
    var getXPathPred;
    var s, v, regEx, jnr
    regEx = &#x2F;[\*\?]&#x2F;;

    s = asendaMetad(inp);

    v = &quot;&quot;;
    jnr = 0;
    if (regEx.test(s)) {
        var result = regEx.exec(s);
        while (result != null) {
            jnr = jnr + 1;
            if ((v.length &gt; 0)) {
                v = v + &quot; AND &quot;;
            }
            if ((result.index &gt; 0)) {
                if ((jnr == 1)) {
                    v = v + &quot;contains(concat(&#x27;~~~&#x27;,.),&quot; + gcv2(&quot;~~~&quot; + jsMid(s, 0, result.index)) + &quot;)&quot;;
                } else {
                    v = v + &quot;contains(.,&quot; + gcv2(jsMid(s, 0, result.index)) + &quot;)&quot;;
                }
            }
            s = s.substr(result.lastIndex);
            result = regEx.exec(s);
        }
        if (s.length &gt; 0) {
            if (v.length &gt; 0) {
                v = v + &quot; AND &quot;;
            }
            v = v + &quot;contains(concat(.,&#x27;~~~&#x27;),&quot; + gcv2(s + &quot;~~~&quot;) + &quot;)&quot;;
        }
        getXPathPred = v;
    } else {
        getXPathPred = &quot;[.=&quot; + gcv2(s) + &quot;]&quot;;
    }
    return getXPathPred;
} &#x2F;&#x2F;getXPathPred


&#x2F;**
* 
*
* @method asendaMetad
* @param {String} jupp
* @returns {String} 
*&#x2F;
function asendaMetad(jupp) {
    var s;
    s = jupp;
    s = jsReplace(s, &quot;\\\\&quot;, &quot;\uE003&quot;);
    s = jsReplace(s, &quot;\\*&quot;, &quot;\uE001&quot;);
    s = jsReplace(s, &quot;\\?&quot;, &quot;\uE002&quot;);
    return s;
} &#x2F;&#x2F;asendaMetad


&#x2F;**
* 
*
* @method taastaMetad
* @param {String} jupp
* @returns {String} 
*&#x2F;
function taastaMetad(jupp) {
    var s;
    s = jupp;
    s = jsReplace(s, &quot;\uE001&quot;, &quot;*&quot;);
    s = jsReplace(s, &quot;\uE002&quot;, &quot;?&quot;);
    s = jsReplace(s, &quot;\uE003&quot;, &quot;\\\\&quot;);
    return s;
} &#x2F;&#x2F;taastaMetad


&#x2F;**
* 
*
* @method gcv2
* @param {String} jupp
* @returns {String} 
*&#x2F;
function gcv2(jupp) {
    var gcv2;
    if ((jupp == &quot;&#x27;&quot;)) {
        gcv2 = &quot;\&quot;&#x27;\&quot;&quot;;
    } else if ((jupp == &quot;\&quot;&quot;)) {
        gcv2 = &quot;&#x27;\&quot;&#x27;&quot;;
    } else {
        var regEx, tykk;
        regEx = &#x2F;[&quot;&#x27;]&#x2F;g;
        var s, v, m;
        s = jupp;
        if (regEx.test(jupp)) {
            v = &quot;concat(&quot;;
            var result = regEx.exec(s);
            while (result != null) {
                if (!(v == &quot;concat(&quot;)) {
                    v = v + &quot;,&quot;;
                }
                tykk = taastaMetad(s.substr(0, result.index)); &#x2F;&#x2F;kui &#x27; on kohe alguses siis tuleb &#x27;&#x27;;
                if (tykk.length &gt; 0) {
                    v = v + &quot;&#x27;&quot; + tykk + &quot;&#x27;,&quot;;
                }
                if ((result[0] == &quot;&#x27;&quot;)) {
                    v = v + &quot;\&quot;&#x27;\&quot;&quot;;
                } else {
                    v = v + &quot;&#x27;\&quot;&#x27;&quot;;
                }
                s = s.substr(result.index);
                result = regEx.exec(s);
            }
            if (s.length &gt; 0) {
                v = v + &quot;,&#x27;&quot; + taastaMetad(s) + &quot;&#x27;&quot;;
            }
            v = v + &quot;)&quot;;
            gcv2 = v;
        } else {
            gcv2 = &quot;&#x27;&quot; + taastaMetad(s) + &quot;&#x27;&quot;;
        }
    }
    return gcv2;
} &#x2F;&#x2F;gcv2

&#x2F;**
* 
*
* @method btnRunQuery
*&#x2F;
function btnRunQuery() {
    &#x2F;&#x2F;päringu juurde minemisel oleks katkestamist vaja
    if (salvestaJaKatkesta()) {
        return;
    }

    var oPrmDom, qryMethod;

    qryMethod = &quot;MySql&quot;;
    if (window.event.srcElement.id == &quot;inp_RunQueryXML&quot;) {
        qryMethod = &quot;XML&quot;;
    }

    oPrmDom = GetQueryParams(qryMethod);
    if (!oPrmDom) {
        return;
    }

    sCmdId = &quot;ClientRead&quot;;
    oPrmDom.documentElement.selectSingleNode(&quot;cmd&quot;).text = sCmdId;

    &#x2F;&#x2F;&quot;${DIC_DESC}2&quot;, &quot;${DIC_DESC}All&quot;
    if ((oPrmDom.documentElement.selectSingleNode(&quot;vol&quot;).text == &quot;&quot;)) {
        &#x2F;&#x2F;id=&#x27;${DIC_DESC}${volNr}&#x27;;
        oPrmDom.documentElement.selectSingleNode(&quot;vol&quot;).text = sel_Vol.options(sel_Vol.selectedIndex).id;
    }

    StartOperation(oPrmDom)

} &#x2F;&#x2F;btnRunQuery


&#x2F;**
* 
*
* @method koostamiseLopp
*&#x2F;
function koostamiseLopp() {
    var itmElem, gspq, refnode, muutused

    muutused = &quot;KL märge&quot;
    itmElem = oEditDOMRoot.firstChild.selectSingleNode(DICPR + &quot;:K&quot;);
    if (!(itmElem.text == sUsrName)) {
        muutused = muutused + &quot; (&lt;K&gt; &#x27;&quot; + itmElem.text + &quot;&#x27; -&gt; &#x27;&quot; + sUsrName + &quot;&#x27;)&quot;;
        itmElem.text = sUsrName;
    }
    updMuudatused(&quot;S&quot;, muutused);

    itmElem = oEditDOMRoot.firstChild.selectSingleNode(DICPR + &quot;:KL&quot;);
    if ((itmElem == null)) {
        &#x2F;&#x2F;GetSchemaPosQuery: teeb oStruDom - ist päringu following-sibling nimede kohta;
        gspq = GetSchemaPosQuery(oEditDOMRoot.firstChild, DICPR + &quot;:KL&quot;);
        refnode = oEditDOMRoot.firstChild.selectSingleNode(gspq);
        itmElem = oEditDOMRoot.firstChild.insertBefore(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:KL&quot;, DICURI), refnode);
    }
    itmElem.text = GetXSDDateTime(new Date());

    imgArtSaveClick()

} &#x2F;&#x2F;koostamiseLopp


&#x2F;**
* 
*
* @method remKoostamiseLopp
*&#x2F;
function remKoostamiseLopp() {
    var klElem = oEditDOMRoot.firstChild.selectSingleNode(DICPR + &quot;:KL&quot;);
    if (!(klElem == null)) {
        klElem.parentNode.removeChild(klElem);
        updMuudatused(&quot;S&quot;, &quot;KL märke eemaldamine&quot;);
        imgArtSaveClick();
    }
} &#x2F;&#x2F;remKoostamiseLopp



&#x2F;**
* 
*
* @method signEntry
*&#x2F;
function signEntry() {
    var gspq, refnode, itmElem;

    itmElem = oEditDOMRoot.firstChild.selectSingleNode(DICPR + &quot;:PT&quot;);
    if ((itmElem == null)) {
        &#x2F;&#x2F;GetSchemaPosQuery: teeb oStruDom - ist päringu following-sibling nimede kohta;
        gspq = GetSchemaPosQuery(oEditDOMRoot.firstChild, DICPR + &quot;:PT&quot;);
        refnode = oEditDOMRoot.firstChild.selectSingleNode(gspq);
        itmElem = oEditDOMRoot.firstChild.insertBefore(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:PT&quot;, DICURI), refnode);
    }
    itmElem.text = sUsrName;

    itmElem = oEditDOMRoot.firstChild.selectSingleNode(DICPR + &quot;:PTA&quot;);
    if ((itmElem == null)) {
        &#x2F;&#x2F;GetSchemaPosQuery: teeb oStruDom - ist päringu following-sibling nimede kohta;
        gspq = GetSchemaPosQuery(oEditDOMRoot.firstChild, DICPR + &quot;:PTA&quot;);
        refnode = oEditDOMRoot.firstChild.selectSingleNode(gspq);
        itmElem = oEditDOMRoot.firstChild.insertBefore(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:PTA&quot;, DICURI), refnode);
    }
    itmElem.text = GetXSDDateTime(new Date());
    updMuudatused(&quot;S&quot;, &quot;PT märge&quot;);

    imgArtSaveClick();

} &#x2F;&#x2F;signEntry


&#x2F;**
* 
*
* @method remSignEntry
*&#x2F;
function remSignEntry() {
    var signElems
    signElems = oEditDOMRoot.firstChild.selectNodes(DICPR + &quot;:PT | &quot; + DICPR + &quot;:PTA&quot;)

    if ((signElems.length &gt; 0)) {
        signElems.removeAll();
        updMuudatused(&quot;S&quot;, &quot;PT märke eemaldamine&quot;);
        imgArtSaveClick();
    }

} &#x2F;&#x2F;remSignEntry


&#x2F;**
* 
*
* @method completeEntryLatvian
*&#x2F;
function completeEntryLatvian() {
    var itmElem = oEditDOMRoot.firstChild.selectSingleNode(DICPR + &quot;:lTL[@&quot; + DICPR + &quot;:nimi = &#x27;&quot; + sUsrName + &quot;&#x27;]&quot;), newAttr;
    if (!itmElem) {
        &#x2F;&#x2F;GetSchemaPosQuery: teeb oStruDom - ist päringu following-sibling nimede kohta;
        var gspq = GetSchemaPosQuery(oEditDOMRoot.firstChild, DICPR + &quot;:lTL&quot;);
        var refNode = oEditDOMRoot.firstChild.selectSingleNode(gspq);
        itmElem = oEditDOMRoot.firstChild.insertBefore(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:lTL&quot;, DICURI), refNode);
        newAttr = itmElem.attributes.setNamedItem(oEditDOM.createNode(NODE_ATTRIBUTE, DICPR + &quot;:nimi&quot;, DICURI));
        newAttr.value = sUsrName;
    }
    newAttr = itmElem.attributes.setNamedItem(oEditDOM.createNode(NODE_ATTRIBUTE, DICPR + &quot;:aeg&quot;, DICURI));
    newAttr.value = GetXSDDateTime(new Date());
    updMuudatused(&quot;S&quot;, &quot;lTL lisamine&quot;);
    imgArtSaveClick();
} &#x2F;&#x2F; completeEntryLatvian


&#x2F;**
* 
*
* @method remCompleteEntryLatvian
*&#x2F;
function remCompleteEntryLatvian() {
    var itmElem = oEditDOMRoot.firstChild.selectSingleNode(DICPR + &quot;:lTL[@&quot; + DICPR + &quot;:nimi = &#x27;&quot; + sUsrName + &quot;&#x27;]&quot;);
    if (itmElem) {
        itmElem.parentNode.removeChild(itmElem);
        updMuudatused(&quot;S&quot;, &quot;lTL eemaldamine&quot;);
        imgArtSaveClick();
    }
} &#x2F;&#x2F;remCompleteEntryLatvian


&#x2F;**
* 
*
* @method completeEntryEstonian
*&#x2F;
function completeEntryEstonian() {
    var itmElem = oEditDOMRoot.firstChild.selectSingleNode(DICPR + &quot;:eTL[@&quot; + DICPR + &quot;:nimi = &#x27;&quot; + sUsrName + &quot;&#x27;]&quot;), newAttr;
    if (!itmElem) {
        &#x2F;&#x2F;GetSchemaPosQuery: teeb oStruDom - ist päringu following-sibling nimede kohta;
        var gspq = GetSchemaPosQuery(oEditDOMRoot.firstChild, DICPR + &quot;:eTL&quot;);
        var refNode = oEditDOMRoot.firstChild.selectSingleNode(gspq);
        itmElem = oEditDOMRoot.firstChild.insertBefore(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:eTL&quot;, DICURI), refNode);
        newAttr = itmElem.attributes.setNamedItem(oEditDOM.createNode(NODE_ATTRIBUTE, DICPR + &quot;:nimi&quot;, DICURI));
        newAttr.value = sUsrName;
    }
    newAttr = itmElem.attributes.setNamedItem(oEditDOM.createNode(NODE_ATTRIBUTE, DICPR + &quot;:aeg&quot;, DICURI));
    newAttr.value = GetXSDDateTime(new Date());
    updMuudatused(&quot;S&quot;, &quot;eTL lisamine&quot;);
    imgArtSaveClick();
} &#x2F;&#x2F; completeEntryEstonian


&#x2F;**
* 
*
* @method remCompleteEntryEstonian
*&#x2F;
function remCompleteEntryEstonian() {
    var itmElem = oEditDOMRoot.firstChild.selectSingleNode(DICPR + &quot;:eTL[@&quot; + DICPR + &quot;:nimi = &#x27;&quot; + sUsrName + &quot;&#x27;]&quot;);
    if (itmElem) {
        itmElem.parentNode.removeChild(itmElem);
        updMuudatused(&quot;S&quot;, &quot;eTL eemaldamine&quot;);
        imgArtSaveClick();
    }
} &#x2F;&#x2F;remCompleteEntryEstonian


&#x2F;**
* 
*
* @method completeEntry
*&#x2F;
function completeEntry() {

    var itmElem = oEditDOMRoot.firstChild.selectSingleNode(DICPR + &quot;:TL&quot;);

    if (!itmElem) {
        &#x2F;&#x2F;GetSchemaPosQuery: teeb oStruDom - ist päringu following-sibling nimede kohta;
        var gspq = GetSchemaPosQuery(oEditDOMRoot.firstChild, DICPR + &quot;:TL&quot;);
        var refnode = oEditDOMRoot.firstChild.selectSingleNode(gspq);
        itmElem = oEditDOMRoot.firstChild.insertBefore(oEditDOM.createNode(NODE_ELEMENT, DICPR + &quot;:TL&quot;, DICURI), refnode);
    }

    if (dic_desc == &#x27;psv&#x27;) {
        var TLTekst = itmElem.text;
        if (TLTekst.length &gt; 0) {
            var f = false;
            var TLd = TLTekst.split(&#x27;; &#x27;);
            for (var ixTL in TLd) {
                var TL = TLd[ixTL].split(&#x27;, &#x27;);
                if (TL[0] == sUsrName) {
                    f = true;
                    TL[1] = GetXSDDateTime(new Date());
                    TLd[ixTL] = TL.join(&#x27;, &#x27;);
                }
            }
            if (!f) {
                TLd.unshift(sUsrName + &quot;, &quot; + GetXSDDateTime(new Date()));
            }
            itmElem.text = TLd.join(&#x27;; &#x27;);
        }
        else {
            itmElem.text = sUsrName + &quot;, &quot; + GetXSDDateTime(new Date());
        }
    }
    else
        itmElem.text = GetXSDDateTime(new Date());

    updMuudatused(&quot;S&quot;, &quot;TL märge&quot;);
    imgArtSaveClick();

} &#x2F;&#x2F;completeEntry


&#x2F;**
* 
*
* @method remCompleteEntry
*&#x2F;
function remCompleteEntry() {

    var tlElem = oEditDOMRoot.firstChild.selectSingleNode(DICPR + &quot;:TL&quot;);

    if (tlElem) {
        if (dic_desc == &#x27;psv&#x27;) {
            var TLTekst = tlElem.text;
            var TLd = TLTekst.split(&#x27;; &#x27;);
            var newTLd = new Array();
            for (var ixTL in TLd) {
                var TL = TLd[ixTL].split(&#x27;, &#x27;);
                if (TL[0] != sUsrName) {
                    newTLd.unshift(TL[0] + &#x27;, &#x27; + TL[1]);
                }
            }
            if (newTLd.length &gt; 0)
                tlElem.text = newTLd.join(&#x27;; &#x27;);
            else
                tlElem.parentNode.removeChild(tlElem);
        }
        else {
            tlElem.parentNode.removeChild(tlElem);
        }
        updMuudatused(&quot;S&quot;, &quot;TL märke eemaldamine&quot;);
        imgArtSaveClick();
    }
} &#x2F;&#x2F;remCompleteEntry


&#x2F;**
* 
*
* @method kustutaArtikkel
*&#x2F;
function kustutaArtikkel() {
    var destVol, orgVolFile, sqlVol;
    if (sFromVolume == sDeldVolId) {
        sCmdId = &quot;ClientRestore&quot;;
        if (dic_vols_count &gt; 1) {
            orgVolFile = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&quot;).getAttribute(DICPR + &quot;:KF&quot;);
            if (!orgVolFile) {
                orgVolFile = prompt(&quot;Sisesta köite number!&quot;);
                if (orgVolFile == &quot;&quot; || parseInt(orgVolFile) &lt; 1 || parseInt(orgVolFile) &gt; dic_vols_count) {
                    return;
                } else {
                    orgVolFile = dic_desc + orgVolFile;
                }
            }
            destVol = orgVolFile;
        } else {
            destVol = dic_desc + &quot;1&quot;;
        }
        sqlVol = destVol;
    } else {
        sCmdId = &quot;ClientDelete&quot;;
        destVol = sDeldVolId;
        sqlVol = sFromVolume;
    }
    sQryInfo = sMSortVal

    var artGuid, qM, seldQn, srchPtrn, homonyymsed, art_xpath, elm_xpath, sql;
    artGuid = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + qn_guid).text;
    qM = &quot;MySql&quot;;
    seldQn = qn_ms;  &#x2F;&#x2F;pärast otsitakse nn homonüümseid märksõnu, st millised veel sama märksõnaga on;
    srchPtrn = &quot;^&quot; + sMSortVal + &quot;$&quot;;
    homonyymsed = &quot;&quot;;
    if (!(oXslEdit == oXsl1)) {
        homonyymsed = jsMid(first_default, first_default.indexOf(&quot;&#x2F;&quot;) + 1) + &quot;[. = &quot; + GCV(sMarkSona, &quot;&quot;, 2);
        sql = &quot;SELECT &quot; + dic_desc + &quot;.md AS md, &quot; + &quot;msid.ms AS l, &quot; + &quot;msid.ms_att_i AS ms_att_i, &quot; + &quot;msid.ms_att_liik AS ms_att_liik, &quot; + &quot;msid.ms_att_ps AS ms_att_ps, &quot; + &quot;msid.ms_att_tyyp AS ms_att_tyyp, &quot; + &quot;msid.ms_att_mliik AS ms_att_mliik, &quot; + &quot;msid.ms_att_k AS ms_att_k, &quot; + &quot;msid.ms_att_mm AS ms_att_mm, &quot; + &quot;msid.ms_att_st AS ms_att_st, &quot; + &quot;msid.ms_att_vm AS ms_att_vm, &quot; + &quot;msid.ms_att_all AS ms_att_all, &quot; + &quot;msid.ms_att_uus AS ms_att_uus, &quot; + &quot;msid.ms_att_zs AS ms_att_zs, &quot; + dic_desc + &quot;.G AS G, &quot; + dic_desc + &quot;.art AS art, &quot; + dic_desc + &quot;.K AS K, &quot; + dic_desc + &quot;.T AS T, &quot; + dic_desc + &quot;.TA AS TA, &quot; + dic_desc + &quot;.PT AS PT, &quot; + dic_desc + &quot;.vol_nr AS vol_nr &quot; + &quot;FROM msid, &quot; + dic_desc + &quot; &quot; + &quot;WHERE (&quot; + dic_desc + &quot;.G = msid.G &quot; + &quot;AND msid.dic_code = &#x27;&quot; + dic_desc + &quot;&#x27; &quot; + &quot;AND (msid.ms = \&quot;&quot; + sMarkSona + &quot;\&quot;&quot;;
        homonyymsed = homonyymsed + &quot;]&quot;;
        sql = sql + &quot;) &quot; + &quot;AND msid.vol_nr = &quot; + jsMid(sqlVol, 3, 1);
        sql = sql + &quot;) &quot;; &#x2F;&#x2F;&#x27;WHERE tingimuse lõpp;
        sql = sql + &quot;ORDER BY &quot; + dic_desc + &quot;.ms_att_OO&quot;;
        elm_xpath = homonyymsed;
        homonyymsed = DICPR + &quot;:A[&quot; + homonyymsed + &quot;]&quot;;
        art_xpath = homonyymsed;
    }

    showDbgVar(&quot;sCmdId&quot;, sCmdId, &quot;kustutaArtikkel&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;sQryInfo&quot;, sQryInfo, &quot;kustutaArtikkel&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;art_xpath&quot;, art_xpath, &quot;kustutaArtikkel&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;elm_xpath&quot;, elm_xpath, &quot;kustutaArtikkel&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;srchPtrn&quot;, srchPtrn, &quot;kustutaArtikkel&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;sql&quot;, sql, &quot;kustutaArtikkel&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;destVol&quot;, destVol, &quot;kustutaArtikkel&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date());
    showDbgVar(&quot;qM&quot;, qM, &quot;kustutaArtikkel&quot;, &quot;lõpp&quot;, &quot; &quot;, new Date())

    var sPrmDomXml, oPrmDom;
    sPrmDomXml = &quot;&lt;prm&gt;&quot; +
                    &quot;&lt;cmd&gt;&quot; + sCmdId + &quot;&lt;&#x2F;cmd&gt;&quot; +
                    &quot;&lt;vol&gt;&quot; + sFromVolume + &quot;&lt;&#x2F;vol&gt;&quot; +
                    &quot;&lt;nfo&gt;&quot; + sQryInfo + &quot;&lt;&#x2F;nfo&gt;&quot; +
                    &quot;&lt;axp&gt;&quot; + art_xpath + &quot;&lt;&#x2F;axp&gt;&quot; +
                    &quot;&lt;exp&gt;&quot; + elm_xpath + &quot;&lt;&#x2F;exp&gt;&quot; +
                    &quot;&lt;wC&gt;0&lt;&#x2F;wC&gt;&quot; +
                    &quot;&lt;wS&gt;1&lt;&#x2F;wS&gt;&quot; +
                    &quot;&lt;fSrP&gt;&quot; + srchPtrn + &quot;&lt;&#x2F;fSrP&gt;&quot; +
                    &quot;&lt;G&gt;&quot; + artGuid + &quot;&lt;&#x2F;G&gt;&quot; +
                    &quot;&lt;sql&gt;&quot; + sql + &quot;&lt;&#x2F;sql&gt;&quot; +
                    &quot;&lt;dV&gt;&quot; + destVol + &quot;&lt;&#x2F;dV&gt;&quot; +
                    &quot;&lt;qn&gt;&quot; + seldQn + &quot;&lt;&#x2F;qn&gt;&quot; +
                    &quot;&lt;qM&gt;&quot; + qM + &quot;&lt;&#x2F;qM&gt;&quot; +
                 &quot;&lt;&#x2F;prm&gt;&quot;;

    oPrmDom = IDD(&quot;String&quot;, sPrmDomXml, false, false, null);
    if ((oPrmDom.parseError.errorCode != 0)) {
        ShowXMLParseError(oPrmDom);
        return;
    }

    StartOperation(oPrmDom);
} &#x2F;&#x2F;kustutaArtikkel


&#x2F;**
* 
*
* @method imgArtDeleteClick
*&#x2F;
function imgArtDeleteClick() {
    if (!(oEditDOMRoot.hasChildNodes())) {
        return;
    }

    &#x2F;&#x2F;DEL_WORD
    var nRetBtn = window.confirm(jsReplace(DEL_ART_Q, &quot;[%s]&quot;, sMSortVal));
    if ((nRetBtn != true)) {
        return;
    }

    kustutaArtikkel()

} &#x2F;&#x2F;imgArtDeleteClick


&#x2F;**
* 
*
* @method StartOperation
* @param {Object} oPrmDom
*&#x2F;
function StartOperation(oPrmDom) {
    var cmdId;
    cmdId = oPrmDom.documentElement.selectSingleNode(&quot;cmd&quot;).text

    var axpNode, art_xpath
    axpNode = oPrmDom.documentElement.selectSingleNode(&quot;axp&quot;);
    if (!(axpNode == null)) {
        art_xpath = axpNode.text;
        if (!(art_xpath == &quot;&quot;)) {
            if (!(CheckXPath(art_xpath))) {
                return;
            }
        }
    }

    &#x2F;&#x2F;esimeseks tuleb siis &quot;app_lang&quot;, siis &quot;dic_desc&quot;
    var nNode
    nNode = oPrmDom.documentElement.insertBefore(oPrmDom.createNode(NODE_ELEMENT, &quot;dic_desc&quot;, &quot;&quot;), oPrmDom.documentElement.firstChild);
    nNode.text = dic_desc
    nNode = oPrmDom.documentElement.insertBefore(oPrmDom.createNode(NODE_ELEMENT, &quot;app_lang&quot;, &quot;&quot;), oPrmDom.documentElement.firstChild);
    nNode.text = sAppLang
    nNode = oPrmDom.documentElement.appendChild(oPrmDom.createNode(NODE_ELEMENT, &quot;un&quot;, &quot;&quot;));
    nNode.text = sUsrName

    spnMsgDelete();
    window.status = &quot;&quot;;
    inp_RunQuery.disabled = true;
    if (!(document.body.all(&quot;inp_RunQueryXML&quot;) == null)) {
        inp_RunQueryXML.disabled = true;
    }

    &#x2F;&#x2F;07. juuni 2011
    img_ArtAdd.style.visibility = &quot;hidden&quot;;
    img_ArtExport.style.visibility = &quot;hidden&quot;; &#x2F;&#x2F;&#x27;Word väljatrükk;
    if (!(document.body.all(&quot;img_SrTools&quot;) == null)) {
        img_SrTools.style.visibility = &quot;hidden&quot;;
    }
    if (!(document.body.all(&quot;img_readFirst&quot;) == null)) {
        img_readFirst.style.visibility = &quot;hidden&quot;;
    }
    if (!(document.body.all(&quot;img_readPrev&quot;) == null)) {
        img_readPrev.style.visibility = &quot;hidden&quot;;
    }
    if (!(document.body.all(&quot;img_readNext&quot;) == null)) {
        img_readNext.style.visibility = &quot;hidden&quot;;
    }
    if (!(document.body.all(&quot;img_readLast&quot;) == null)) {
        img_readLast.style.visibility = &quot;hidden&quot;;
    }
    if (!(document.body.all(&quot;img_artHistory&quot;) == null)) {
        img_artHistory.style.visibility = &quot;hidden&quot;;
    }
    img_ArtSave.style.visibility = &quot;hidden&quot;;
    img_ArtDelete.style.visibility = &quot;hidden&quot;;
    &#x2F;&#x2F;07. juuni 2011 - lõpp

    dtOpStart = new Date();
    statusAnim.style.visibility = &quot;visible&quot;;
    QueryResponseAsync(oPrmDom);
} &#x2F;&#x2F;StartOperation


&#x2F;**
* 
*
* @method CheckXPath
* @param {String} sXPath
* @returns {Boolean}
*&#x2F;
function CheckXPath(sXPath) {
    &#x2F;&#x2F;rex = new RegExp(&quot;(al_p:[\\w\\d]+\\(.+?\\)(\\s*(&lt;|&lt;=|&gt;|&gt;=|=|!=)\\s*\\d+))&quot;, &quot;g&quot;);
    var rex = &#x2F;(al_p:[\w\d]+\(.+?\)(\s*(&lt;|&lt;=|&gt;|&gt;=|=|!=)\s*\d+))&#x2F;g;
    var xpthNew = sXPath.replace(rex, &quot;. = 0&quot;);

    try {
        var testNodes = oEditDOMRoot.selectNodes(xpthNew);
    }
    catch (e) {
        alert(e.name + &quot; 0x&quot; + hex(e.number, true) + &quot;: &#x27;&quot; + e.description + &quot;&#x27;\n&quot; + sXPath + &quot;\n&quot; + xpthNew);
        return false;
    }
    return true;
} &#x2F;&#x2F;CheckXPath

&#x2F;**
* 
*
* @method ShowXPathError
* @param {Object} objErr
*&#x2F;
function ShowXPathError(objErr) {
    var errText;
    errText = ERROR_WORD + &quot;: &quot; + objErr.Source + &#x27;\r\n&#x27; + &quot;Number: 0x&quot; + Hex(objErr.number) + &quot; (&quot; + objErr.number + &quot;)&quot; + &#x27;\r\n\r\n&#x27; + objErr.Description;
    alert(errText, jsvbCritical, XPATH_ERR);
} &#x2F;&#x2F;ShowXPathError


&#x2F;**
* 
*
* @method asyncCompleted
* @param {Object} objXMLDom
*&#x2F;
function asyncCompleted(objXMLDom) {
    ParseSrvInfo(objXMLDom);
    StopOperation();
} &#x2F;&#x2F;asyncCompleted


&#x2F;**
* 
*
* @method ParseSrvInfo
* @param {Object} oRespDom
*&#x2F;
function ParseSrvInfo(oRespDom) {
    &#x2F;&#x2F;sta, cnt, vol[, q:A], [&quot;AppSuccess&quot;|&quot;AppFailure&quot;|], statusText, status, responseText
    var sta, cnt, vol, qM, appSta, statusText, status, responseText;
    statusText = oRespDom.documentElement.selectSingleNode(&quot;statusText&quot;).text;
    status = parseInt(oRespDom.documentElement.selectSingleNode(&quot;status&quot;).text);
    responseText = oRespDom.documentElement.selectSingleNode(&quot;responseText&quot;).text;

    var qInfoStr, printSr;

    if (statusText == &quot;OK&quot;) {
        appSta = oRespDom.documentElement.selectSingleNode(&quot;appSta&quot;).text;
        if (appSta == &quot;AppSuccess&quot;) {
            sta = oRespDom.documentElement.selectSingleNode(&quot;sta&quot;).text;
            cnt = oRespDom.documentElement.selectSingleNode(&quot;cnt&quot;).text;
            &#x2F;&#x2F;cnt = cnt.replace(&quot; &quot;, &quot;&quot;);
            cnt = parseInt(cnt);
            vol = oRespDom.documentElement.selectSingleNode(&quot;vol&quot;).text;
            qM = oRespDom.documentElement.selectSingleNode(&quot;qM&quot;).text;
            if (sta == &quot;Success&quot;) {
                if (sCmdId == &quot;ClientRead&quot; || sCmdId == &quot;BrowseRead&quot; || sCmdId == &quot;prevNextRead&quot; || sCmdId == &quot;msSarnased&quot; || sCmdId == &quot;tyhjadViited&quot;) {
                    if (cnt == 0) {
                        ShowStatusInfo(ART_NOT_FOUND + &quot; [&quot; + qM + &quot;]&quot;);
                    } else if (cnt == 1) {
                        sel_Vol.options(vol).selected = true;
                        sFromVolume = vol;
                        FillArtFrames(oRespDom.documentElement.selectSingleNode(DICPR + &quot;:A&quot;), true);
                        divFrameEdit.scrollTop = 0;
                        divFrameView.scrollTop = 0;
                        document.frames(&quot;frame_Images&quot;).window.scrollTo(0, 0);
                        if (document.all(&quot;frame_Browse&quot;).style.zIndex == -1)
                            bringZIndexToFront(&quot;div_appSisu&quot;);
                        ShowStatusInfo(ART_ONE_FOUND + &quot; [&quot; + qM + &quot;]&quot;);
                    } else if (cnt &gt; 1 || cnt == -1) {
                        oBrowseNode = oRespDom.documentElement.selectSingleNode(&quot;outDOM&quot;);
                        filterBy = &quot;&quot;;
                        FillBrowseFrame(oBrowseNode);
                        bringZIndexToFront(&quot;frame_Browse&quot;);
                        ShowStatusInfo(jsReplace(ART_MANY_FOUND, &quot;[%s]&quot;, jsFormatNumber(cnt, 0, -2, -2, -2)) + &quot; [&quot; + qM + &quot;]&quot;);
                    }
                } else if (sCmdId == &quot;srvXmlValidate&quot;) {
                    oBrowseNode = oRespDom.documentElement.selectSingleNode(&quot;outDOM&quot;);
                    filterBy = &quot;&quot;;
                    FillBrowseFrame(oBrowseNode);
                    bringZIndexToFront(&quot;frame_Browse&quot;);
                    ShowStatusInfo(&quot;Vigaseid artikleid: &quot; + cnt + &quot; tk [&quot; + qM + &quot;]&quot;);
                } else if (sCmdId == &quot;SaveList&quot;) {
                    ExportToExcel(oRespDom.documentElement.selectSingleNode(&quot;outDOM&quot;));
                    ShowStatusInfo(jsReplace(EXPORT_OK, &quot;[%s]&quot;, jsFormatNumber(cnt, 0, -2, -2, -2)));
                } else if (sCmdId == &quot;ImportRead&quot;) {
                    if (cnt == 0) {
                        ShowStatusInfo(ART_NOT_FOUND);
                    } else if (cnt == 1) {
                        &#x2F;&#x2F;     sel_Vol.options(vol).selected = true
                        var gspq, refnode, importedArt;
                        &#x2F;&#x2F;GetSchemaPosQuery: teeb oStruDom - ist päringu following-sibling nimede kohta;
                        gspq = GetSchemaPosQuery(oEditDOMRoot.firstChild, DICPR + &quot;:I&quot;);
                        refnode = oEditDOMRoot.firstChild.selectSingleNode(gspq);
                        importedArt = oRespDom.documentElement.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + DICPR + &quot;:I&quot;);
                        oEditDOMRoot.firstChild.insertBefore(importedArt, refnode);
                        oEditAll(&quot;ifrdiv&quot;).setAttribute(&quot;xmlChanged&quot;, 2);
                        if (dic_desc == &quot;evs&quot;) {
                            var domCopy;
                            domCopy = oEditDOM.cloneNode(true);
                            TeisendaDOM(domCopy);
                            oViewAll(&quot;ifrviewdiv&quot;).innerHTML = domCopy.transformNode(oXslView);
                        } else {
                            oViewAll(&quot;ifrviewdiv&quot;).innerHTML = oEditDOM.transformNode(oXslView);
                        }
                        ShowStatusInfo(ART_ONE_FOUND);
                    }
                } else if (sCmdId == &quot;ClientWrite&quot;) {
                    if (cnt == 1) {
                        &#x2F;&#x2F;tühjad elemendid on  kustutatud;
                        FillArtFrames(oRespDom.documentElement.selectSingleNode(DICPR + &quot;:A[1]&quot;), false);
                        ShowStatusInfo(SAVE_OK + &quot; [&quot; + qM + &quot;]&quot;);
                        &#x2F;&#x2F;homonüümsete kontrolli korral võib tulemusena tulla mitu artiklit,;
                        &#x2F;&#x2F;ka &#x27;sQryInfo&#x27; tuleb uuesti võtta;
                    } else if (cnt &gt; 1) {
                        bArtModified = false;
                        oBrowseNode = oRespDom.documentElement.selectSingleNode(&quot;outDOM&quot;);
                        sQryInfo = oBrowseNode.getAttribute(&quot;qinfo&quot;);
                        filterBy = &quot;&quot;;
                        FillBrowseFrame(oBrowseNode);
                        bringZIndexToFront(&quot;frame_Browse&quot;);
                        ShowStatusInfo(jsReplace(ART_MANY_FOUND, &quot;[%s]&quot;, jsFormatNumber(cnt, 0, -2, -2, -2)) + &quot; [&quot; + qM + &quot;]&quot;);
                    } else if (cnt == 0) {
                        &#x2F;&#x2F; homonüümsete kontrollil läks midagi metsa
                        FillArtFrames(oRespDom.documentElement.selectSingleNode(DICPR + &quot;:A[1]&quot;), false);
                        ShowStatusInfo(&quot;Homonüümsete kontroll = 0!&quot; + &quot; [&quot; + qM + &quot;]&quot;);
                    }
                } else if (sCmdId == &quot;ClientAdd&quot;) {
                    if ((cnt == 1)) {
                        FillArtFrames(oRespDom.documentElement.selectSingleNode(DICPR + &quot;:A[1]&quot;), true);
                        bringZIndexToFront(&quot;div_appSisu&quot;);
                        ShowStatusInfo(ADD_OK + &quot; [&quot; + qM + &quot;]&quot;);
                        sFromVolume = vol;
                        &#x2F;&#x2F;homonüümsete kontrolli korral võib tulemusena tulla mitu artiklit,;
                        &#x2F;&#x2F;ka &#x27;sQryInfo&#x27; tuleb uuesti võtta;
                    } else if ((cnt &gt; 1)) {
                        oBrowseNode = oRespDom.documentElement.selectSingleNode(&quot;outDOM&quot;);
                        sQryInfo = oBrowseNode.getAttribute(&quot;qinfo&quot;);
                        filterBy = &quot;&quot;;
                        FillBrowseFrame(oBrowseNode);
                        bringZIndexToFront(&quot;frame_Browse&quot;);
                        ShowStatusInfo(jsReplace(ART_MANY_FOUND, &quot;[%s]&quot;, jsFormatNumber(cnt, 0, -2, -2, -2)) + &quot; [&quot; + qM + &quot;]&quot;);
                    }
                } else if (sCmdId == &quot;ClientDelete&quot;) {
                    oEditDOMRoot.removeChild(oEditDOMRoot.firstChild);
                    &#x2F;&#x2F;kui art puudub, on view.xsl tulemusena HTML-is ikkagi 10 BR-i ...;
                    oEditAll(&quot;ifrdiv&quot;).innerHTML = oEditDOM.transformNode(oXslEdit);
                    oViewAll(&quot;ifrviewdiv&quot;).innerHTML = oEditDOM.transformNode(oXslView);
                    &#x2F;&#x2F;0 peaks näitama, et ühtegi homonüümset ei jäänud;
                    if ((cnt == 0)) {
                        ShowStatusInfo(DEL_OK + &quot; [&quot; + qM + &quot;]&quot;);
                        sFromVolume = &quot;&quot;;
                    } else {
                        oBrowseNode = oRespDom.documentElement.selectSingleNode(&quot;outDOM&quot;);
                        sQryInfo = oBrowseNode.getAttribute(&quot;qinfo&quot;);
                        filterBy = &quot;&quot;;
                        FillBrowseFrame(oBrowseNode);
                        bringZIndexToFront(&quot;frame_Browse&quot;);
                        ShowStatusInfo(jsReplace(ART_MANY_FOUND, &quot;[%s]&quot;, jsFormatNumber(cnt, 0, -2, -2, -2)) + &quot; [&quot; + qM + &quot;]&quot;);
                    }
                } else if (sCmdId == &quot;ClientRestore&quot;) {
                    oEditDOMRoot.removeChild(oEditDOMRoot.firstChild);
                    &#x2F;&#x2F;kui art puudub, on view.xsl tulemusena HTML-is ikkagi 10 BR-i ...;
                    oEditAll(&quot;ifrdiv&quot;).innerHTML = oEditDOM.transformNode(oXslEdit);
                    oViewAll(&quot;ifrviewdiv&quot;).innerHTML = oEditDOM.transformNode(oXslView);
                    &#x2F;&#x2F;1 peaks näitama, et sihtköites on 1 homonüümne;
                    if ((cnt == 1)) {
                        ShowStatusInfo(DEL_OK + &quot; [&quot; + qM + &quot;]&quot;);
                        sFromVolume = &quot;&quot;;
                    } else if ((cnt &gt; 1)) {
                        oBrowseNode = oRespDom.documentElement.selectSingleNode(&quot;outDOM&quot;);
                        sQryInfo = oBrowseNode.getAttribute(&quot;qinfo&quot;);
                        filterBy = &quot;&quot;;
                        FillBrowseFrame(oBrowseNode);
                        bringZIndexToFront(&quot;frame_Browse&quot;);
                        ShowStatusInfo(jsReplace(ART_MANY_FOUND, &quot;[%s]&quot;, jsFormatNumber(cnt, 0, -2, -2, -2)) + &quot; [&quot; + qM + &quot;]&quot;);
                    }
                } else if (sCmdId == &quot;ClientPrint&quot;) {
                    if (cnt &gt; 0) {
                        oBrowseNode = oRespDom.documentElement.selectSingleNode(&quot;outDOM&#x2F;&quot; + DICPR + &quot;:sr&quot;);
                        var etw = ExportToWord(nStartPageNumber, bRemoveShaded, sWordFileName, doSpellCheck, oXslView, viewCSS.cssText, spn_msg, oBrowseNode);
                        if (etw &gt; -1) {
                            ShowStatusInfo(jsReplace(EXPORT_OK, &quot;[%s]&quot;, jsFormatNumber(cnt, 0, -2, -2, -2)) + &quot; [&quot; + qM + &quot;]&quot;);
                        }
                    } else {
                        ShowStatusInfo(ART_NOT_FOUND);
                    }
                }
            } else if (sta == &quot;ClientRead_TOOMANY&quot;) { &#x2F;&#x2F;&#x27;ClientRead;
                ShowStatusInfo(ART_TOO_MANY + &quot; (&quot; + jsFormatNumber(cnt, 0, -2, -2, -2) + &quot;)&quot;);
            } else if (sta == &quot;ClientPrint_TOOMANY&quot;) { &#x2F;&#x2F;&#x27;ClientPrint;
                ShowStatusInfo(ART_TOO_MANY + &quot; (&quot; + jsFormatNumber(cnt, 0, -2, -2, -2) + &quot;)&quot;);
            } else if (jsLeft(sta, 24) == &quot;Article already exists (&quot;) { &#x2F;&#x2F;&#x27;ClientAdd;
                ShowStatusInfo(ART_EXISTS);
            } else {
                alert(sta);
                ShowStatusInfo(&quot;&quot;);
            }
        } else {
            alert(&quot;StatusText: &quot; + statusText + &#x27;\r\n&#x27; + &quot;Status: &quot; + status + &#x27;\r\n\r\n&#x27; + &quot;ResponseText: &quot; + responseText + &#x27;\r\n&#x27; + SRVFUNC_ERROR + &quot;: &quot; + appSta);
            ShowStatusInfo(&quot;&quot;);
        }
    } else {
        alert(&quot;Status: &quot; + status + &#x27;\r\n\r\n&#x27; + &quot;ResponseText: &quot; + responseText + &#x27;\r\n\r\n&#x27; + ERROR_WORD + &quot;: &quot; + statusText);
        ShowStatusInfo(&quot;&quot;);
    }
} &#x2F;&#x2F;ParseSrvInfo


&#x2F;**
* Ei tee midagi, kõik on välja kommenteeritud.
*
* @method ExportToExcel
* @param {Object} outDom
*&#x2F;
function ExportToExcel(outDom) {

    &#x2F;&#x2F;window.status = &quot;Writing local file ...&quot;
    &#x2F;&#x2F;var strm
    &#x2F;&#x2F;set strm = new ActiveXObject(&quot;ADODB.Stream&quot;)
    &#x2F;&#x2F;strm.Type = adTypeText
    &#x2F;&#x2F;strm.Charset = &quot;utf-8&quot;
    &#x2F;&#x2F;strm.LineSeparator = adCRLF
    &#x2F;&#x2F;strm.Open()
    &#x2F;&#x2F;strm.WriteText(  &#x2F;&#x2F;    outDom.xml  &#x2F;&#x2F;)
    &#x2F;&#x2F;strm.SaveToFile(&quot;c:&#x2F;EELex&#x2F;Väljatrükid&#x2F;list.xml&quot;, adSaveCreateOverWrite)
    &#x2F;&#x2F;strm.Close()
    &#x2F;&#x2F;set strm = null

    &#x2F;&#x2F;window.status = &quot;Creating Excel object ...&quot;;
    &#x2F;&#x2F;window.onerror=null;
    &#x2F;&#x2F;var oExcel
    &#x2F;&#x2F;oExcel = GetObject(, &quot;Excel.Application&quot;);
    &#x2F;&#x2F;if((err.number != 0)){
    &#x2F;&#x2F;    err.Clear;
    &#x2F;&#x2F;   oExcel = new ActiveXObject(&quot;Excel.Application&quot;);
    &#x2F;&#x2F;}
    &#x2F;&#x2F;if((err.number != 0)){
    &#x2F;&#x2F;    if((err.number == 429)){ &#x2F;&#x2F;ActivevX component cant create object;
    &#x2F;&#x2F;        alert(&quot;Ei saa Excelit luua!&quot;, jsvbCritical, &quot;ExportToExcel: &quot; + err.Source);
    &#x2F;&#x2F;    }else{
    &#x2F;&#x2F;  alert(&quot;Viga Exceli loomises!:&quot; + &#x27;\t&#x27; + &quot;0x&quot; + Hex(err.number)) + &quot; (&quot; + err.number + &quot;)&quot; + &#x27;\r\n\r\n&#x27; +  err.Description,  jsvbCritical, &quot;ExportToExcel: &quot; + err.Source;
    &#x2F;&#x2F;    }
    &#x2F;&#x2F;    err.Clear;
    &#x2F;&#x2F;    return;
    &#x2F;&#x2F;}
    &#x2F;&#x2F;window.detachEvent(&quot;onerror&quot;);
    &#x2F;&#x2F;oExcel.Visible = false

    &#x2F;&#x2F;window.status = &quot;Loading Excel document ...&quot;;
    &#x2F;&#x2F;oExcel.Workbooks.Add;
    &#x2F;&#x2F;var ws
    &#x2F;&#x2F;ws = oExcel.Workbooks[1].Sheets[1];
    &#x2F;&#x2F;ws.Name = &quot;Päringu tulemused&quot;;
    &#x2F;&#x2F;ws.Cells(1, 1).Value = &quot;Köide&quot;;
    &#x2F;&#x2F;ws.Cells(1, 2).Value = &quot;Märksõna&quot;;
    &#x2F;&#x2F;ws.Cells(1, 3).Value = &quot;Leid&quot;;
    &#x2F;&#x2F;ws.Cells(1, 4).Value = &quot;Koostaja&quot;;
    &#x2F;&#x2F;ws.Cells(1, 5).Value = &quot;Toimetaja&quot;;
    &#x2F;&#x2F;ws.Cells(1, 6).Value = &quot;Peatoimetaja&quot;;
    &#x2F;&#x2F;ws.Range(&quot;A1:F1&quot;).Font.Bold = true

    &#x2F;&#x2F;window.status = &quot;Customizing Excel doc ...&quot;;
    &#x2F;&#x2F;var art, arts, i, s
    &#x2F;&#x2F;arts = outDom.selectNodes(&quot;sr&#x2F;A&quot;);
    &#x2F;&#x2F;for i = 1 to arts.length;
    &#x2F;&#x2F;   art = arts(i - 1);
    &#x2F;&#x2F;&#x2F;&#x2F;    s = art.selectSingleNode(&quot;vnr&quot;).text
    &#x2F;&#x2F;&#x2F;&#x2F;    s = &quot;,&quot; + art.selectSingleNode(&quot;md&#x2F;t&quot;).text
    &#x2F;&#x2F;&#x2F;&#x2F;    s = &quot;,&quot; + art.selectSingleNode(&quot;l&#x2F;t&quot;).text
    &#x2F;&#x2F;&#x2F;&#x2F;    s = &quot;,&quot; + art.selectSingleNode(&quot;K&quot;).text
    &#x2F;&#x2F;&#x2F;&#x2F;    s = &quot;,&quot; + art.selectSingleNode(&quot;T&quot;).text
    &#x2F;&#x2F;&#x2F;&#x2F;    s = &quot;,&quot; + art.selectSingleNode(&quot;PT&quot;).text
    &#x2F;&#x2F;&#x2F;&#x2F;    ws.Cells[i].Value = s
    &#x2F;&#x2F;&#x2F;&#x2F;    ws.Range(&quot;A&quot; + i + &quot;:F&quot; + i).Value = s
    &#x2F;&#x2F;    ws.Cells(i + 1, 1).Value = art.selectSingleNode(&quot;vnr&quot;).text;
    &#x2F;&#x2F;    ws.Cells(i + 1, 2).Value = art.selectSingleNode(&quot;md&#x2F;t&quot;).text;
    &#x2F;&#x2F;    ws.Cells(i + 1, 3).Value = art.selectSingleNode(&quot;l&#x2F;t&quot;).text;
    &#x2F;&#x2F;    ws.Cells(i + 1, 4).Value = art.selectSingleNode(&quot;K&quot;).text;
    &#x2F;&#x2F;    ws.Cells(i + 1, 5).Value = art.selectSingleNode(&quot;T&quot;).text;
    &#x2F;&#x2F;    ws.Cells(i + 1, 6).Value = art.selectSingleNode(&quot;PT&quot;).text;
    &#x2F;&#x2F;&#x2F;&#x2F;    if(((i Mod 1000) = 0)){
    &#x2F;&#x2F;&#x2F;&#x2F;        spn_msg.innerText = i
    &#x2F;&#x2F;&#x2F;&#x2F;    }
    &#x2F;&#x2F;next;
    &#x2F;&#x2F;oExcel.Visible = true

} &#x2F;&#x2F;ExportToExcel


&#x2F;**
* 
*
* @method ShowStatusInfo
* @param {String} sExtraInfo
*&#x2F;
function ShowStatusInfo(sExtraInfo) {
    var nStatusQILen, sStatusQI;
    nStatusQILen = 80;
    if ((sQryInfo.length &gt; nStatusQILen)) {
        sStatusQI = jsLeft(sQryInfo, nStatusQILen) + &quot; ...&quot;;
    } else {
        sStatusQI = sQryInfo;
    }
    sStatusQI = jsReplace(sStatusQI, &quot;&amp;lt;&quot;, &quot;&lt;&quot;);
    sStatusQI = jsReplace(sStatusQI, &quot;&amp;gt;&quot;, &quot;&gt;&quot;);
    window.status = sStatusQI + &quot;: &quot; + sExtraInfo;
} &#x2F;&#x2F;ShowStatusInfo


&#x2F;**
* 
*
* @method StopOperation
*&#x2F;
function StopOperation() {
    inp_RunQuery.disabled = false;
    if (!(document.body.all(&quot;inp_RunQueryXML&quot;) == null)) {
        inp_RunQueryXML.disabled = false;
    }

    &#x2F;&#x2F;07. juuni 2011
    img_ArtAdd.style.visibility = &quot;visible&quot;;
    img_ArtExport.style.visibility = &quot;visible&quot;; &#x2F;&#x2F;&#x27;Word väljatrükk;
    if (!(document.body.all(&quot;img_SrTools&quot;) == null)) {
        img_SrTools.style.visibility = &quot;visible&quot;;
    }
    if (!(document.body.all(&quot;img_readFirst&quot;) == null)) {
        img_readFirst.style.visibility = &quot;visible&quot;;
    }
    if (!(document.body.all(&quot;img_readPrev&quot;) == null)) {
        img_readPrev.style.visibility = &quot;visible&quot;;
    }
    if (!(document.body.all(&quot;img_readNext&quot;) == null)) {
        img_readNext.style.visibility = &quot;visible&quot;;
    }
    if (!(document.body.all(&quot;img_readLast&quot;) == null)) {
        img_readLast.style.visibility = &quot;visible&quot;;
    }
    if (!(document.body.all(&quot;img_artHistory&quot;) == null)) {
        img_artHistory.style.visibility = &quot;visible&quot;;
    }
    &#x2F;&#x2F;10. juuli 2011: paneEkspressioonid juures sätitakse vastavalt &#x27;bArtSaveAllowed&#x27; ja &#x27;bArtDelAllowed&#x27;
    if ((bArtSaveAllowed)) {
        img_ArtSave.style.visibility = &quot;visible&quot;;
    }
    if ((bArtDelAllowed)) {
        img_ArtDelete.style.visibility = &quot;visible&quot;;
    }
    &#x2F;&#x2F;07. juuni 2011 - lõpp

    statusAnim.style.visibility = &quot;hidden&quot;;
    var interval = (new Date().getTime() - dtOpStart.getTime());
    var seconds = Math.floor(interval &#x2F; 1000);
    window.status = window.status + &quot;; (&quot; + Math.floor(seconds &#x2F; 60) + &quot;m, &quot; + (seconds % 60) + &quot;s)&quot;;
} &#x2F;&#x2F;StopOperation


&#x2F;&#x2F;-----------------------------------------------------------------------------------
&#x2F;&#x2F;-----------------------------------------------------------------------------------
&#x2F;&#x2F;-----------------------------------------------------------------------------------
&#x2F;&#x2F;-----------------------------------------------------------------------------------

&#x2F;**
* 
*
* @method FillBrowseFrame
* @param {Object} oOutDomNode
*&#x2F;
function FillBrowseFrame(oOutDomNode) {
    nBrRowIndex = -1;

    &#x2F;&#x2F;The frames collection
    &#x2F;&#x2F;provides access to the contents of an IFRAME.
    &#x2F;&#x2F;sColor = document.frames(&quot;sFrameName&quot;).document.body.style.backgroundColor

    browseDoc.open(&quot;text&#x2F;html&quot;, &quot;replace&quot;);
    if (oOutDomNode) { &#x2F;&#x2F;oOutDomNode: srvfuncs &#x27;outDOM&#x27;
        browseDoc.write(oOutDomNode.transformNode(oXslBrowse));
    }
    browseDoc.close;

    var veerg, myImg;
    if (browseSortBy) {
        veerg = browseDoc.all(browseSortBy);
        myImg = browseDoc.createElement(&quot;IMG&quot;);
        myImg.id = &quot;srtImg&quot;;
        myImg.width = 25;
        myImg.height = 11;
        if ((browseSortOrder == &quot;ascending&quot;)) {
            myImg.src = &quot;graphics&#x2F;sort_up.gif&quot;;
        } else {
            myImg.src = &quot;graphics&#x2F;sort_down.gif&quot;;
        }
        veerg.insertAdjacentElement(&quot;beforeEnd&quot;, myImg);
    }
    if (filterBy) {
        veerg = browseDoc.all(filterBy);
        myImg = veerg.all(&quot;filterImg&quot;);
        myImg.src = &quot;graphics&#x2F;plus.ico&quot;;
        myImg.title = WORD_All;
    }

    &#x2F;&#x2F;You can access the IFRAME object&#x27;s properties, but ! its contents,
    &#x2F;&#x2F;through the object model of the page where the IFRAME object resides
    if (oOutDomNode) {
        browseDoc.onclick = browseTableClick;
        browseDoc.onkeyup = bodyOnKeyUp;
    }
} &#x2F;&#x2F;FillBrowseFrame


&#x2F;**
* 
*
* @method browseTableClick
*&#x2F;
function browseTableClick() {
    var oSrc = frame_Browse.event.srcElement;
    var oRow;
    var i, unStr, tarr;
    var sPrmDomXml, oPrmDom;

    var brTbl = browseDoc.getElementById(&quot;browseTable&quot;);

    if (!(oSrc.tagName == &quot;SPAN&quot; || oSrc.tagName == &quot;TH&quot; || oSrc.tagName == &quot;IMG&quot;)) {
        if (oSrc.parentElement.className == &quot;_md&quot;) {
            oSrc = oSrc.parentElement;
        }
    }

    if (oSrc.tagName == &quot;SPAN&quot; &amp;&amp; oSrc.className == &quot;_md&quot;) {
        if (nBrRowIndex &gt; -1) {
            brTbl.rows(nBrRowIndex).style.backgroundColor = &quot;&quot;;
        }
        oRow = oSrc.parentElement.parentElement;
        nBrRowIndex = oRow.rowIndex;
        brTbl.rows(nBrRowIndex).style.backgroundColor = &quot;silver&quot;

        &#x2F;&#x2F;@vf, &#x27;||&#x27;, G;
        tarr = oSrc.value.split(&quot;||&quot;);

        sCmdId = &quot;BrowseRead&quot;;
        &#x2F;&#x2F; nt vsl &#x27;C&amp;F&#x27;: innerText ei kõlba
        sQryInfo = oSrc.innerHTML;

        var qM;
        qM = &quot;MySql&quot;;
        if (frame_Browse.event.ctrlLeft) {
            qM = &quot;XML&quot;;
        }

        sPrmDomXml = &quot;&lt;prm&gt;&quot; +
                &quot;&lt;cmd&gt;&quot; + sCmdId + &quot;&lt;&#x2F;cmd&gt;&quot; +
                &quot;&lt;vol&gt;&quot; + tarr[0] + &quot;&lt;&#x2F;vol&gt;&quot; +
                &quot;&lt;nfo&gt;&quot; + sQryInfo + &quot;&lt;&#x2F;nfo&gt;&quot; +
                &quot;&lt;G&gt;&quot; + tarr[1] + &quot;&lt;&#x2F;G&gt;&quot; +
                &quot;&lt;qM&gt;&quot; + qM + &quot;&lt;&#x2F;qM&gt;&quot; +
               &quot;&lt;&#x2F;prm&gt;&quot;;

        oPrmDom = IDD(&quot;String&quot;, sPrmDomXml, false, false, null);
        if (oPrmDom.parseError.errorCode != 0) {
            ShowXMLParseError(oPrmDom);
            return;
        }
        StartOperation(oPrmDom);
    } else if ((oSrc.tagName == &quot;TD&quot; &amp;&amp; oSrc.className == &quot;_koondParing&quot;) || (oSrc.tagName == &quot;SPAN&quot; &amp;&amp; oSrc.className == &quot;_xsmall2&quot;)) {
        if (asuKoht.indexOf(&quot;&#x2F;__shs_test&#x2F;&quot;) &lt; 0) {
            if (oSrc.tagName == &quot;TD&quot;) {
                oRow = oSrc.parentElement;
            } else {
                oRow = oSrc.parentElement.parentElement;
            }
            var mTekst = oRow.cells(2).innerText;
            var selectedDics = oRow.cells(3).innerText;
            if (selectedDics) {
                selectedDics = &#x27;;&#x27; + dic_desc + &#x27;;&#x27; + selectedDics.replace(&#x2F;, &#x2F;g, &#x27;;&#x27;) + &#x27;;&#x27;;
                var search = &quot;cmd=otsi&amp;ms=&quot; + encodeURIComponent(RemoveSymbols(mTekst, &#x27; &#x27;)) + &quot;&amp;dics=&quot; + selectedDics;
                &#x2F;&#x2F; eelex.eki.ee või eelex.dyn.eki.ee
                window.open(&quot;http:&#x2F;&#x2F;&quot; + location.hostname + &quot;&#x2F;run&#x2F;SL&#x2F;Koond&#x2F;Koond.html?&quot; + search, &quot;_koondParing&quot;, &quot;&quot;, false);
            }
        }
    } else if (oSrc.tagName == &quot;TH&quot;) {
        var leiudNode, sortNode;
        leiudNode = oXslBrowse.documentElement.selectSingleNode(&quot;xsl:template[@match = &#x27;outDOM&#x27;]&#x2F;html&#x2F;body&#x2F;div[@id = &#x27;browseTableDiv&#x27;]&#x2F;table[@id = &#x27;browseTable&#x27;]&#x2F;tbody&#x2F;xsl:for-each&quot;);
        if (oSrc.id == browseSortBy) {
            if (browseSortOrder == &quot;ascending&quot;) {
                browseSortOrder = &quot;descending&quot;;
            } else {
                browseSortOrder = &quot;ascending&quot;;
            }
        } else {
            browseSortBy = oSrc.id;
            browseSortOrder = &quot;ascending&quot;;
        }
        sortNode = leiudNode.selectSingleNode(&quot;xsl:sort&quot;);
        if (browseSortBy == &quot;&quot;) { &#x2F;&#x2F;&#x27;jnr;
            if (sortNode) {
                leiudNode.removeChild(sortNode);
            }
        } else {
            if (!sortNode) {
                sortNode = leiudNode.insertBefore(oXslBrowse.createNode(NODE_ELEMENT, NS_XSL_PR + &quot;:sort&quot;, NS_XSL), leiudNode.firstChild);
            }
            var rex, mdNodes, lNodes;
            if (browseSortBy == &quot;..&#x2F;md&quot;) {
                &#x2F;&#x2F;oBrowseNode : &lt;outDOM&gt;;
                &#x2F;&#x2F;            if((oBrowseNode.selectSingleNode(&quot;sr&#x2F;A&#x2F;md&#x2F;@p&quot;) == null)){
                mdNodes = oBrowseNode.selectNodes(&quot;sr&#x2F;A&#x2F;md&quot;);
                var mdNode, mdValT;
                for (i = 0; i &lt; mdNodes.length; i++) {
                    mdNode = mdNodes[i];
                    mdValT = mdNode.text;
                    rex = &#x2F;(&amp;\w+;)&#x2F;g;
                    mdValT = mdValT.replace(rex, &quot;&quot;);
                    mdValT = RemoveSymbols(mdValT, &#x27; &#x27;);
                    rex = &#x2F;(\s+$)&#x2F;g;
                    mdValT = mdValT.replace(rex, &quot;&quot;);
                    if (frame_Browse.event.ctrlLeft) {
                        mdNode.setAttribute(&quot;p&quot;, jsStrReverse(mdValT));
                    } else {
                        mdNode.setAttribute(&quot;p&quot;, mdValT);
                    }
                }
                &#x2F;&#x2F;            }
                sortNode.setAttribute(&quot;select&quot;, &quot;..&#x2F;md&#x2F;@p&quot;);
            } else if (browseSortBy == &quot;t&quot;) {
                &#x2F;&#x2F;oBrowseNode : &lt;outDOM&gt;;
                &#x2F;&#x2F;            if((oBrowseNode.selectSingleNode(&quot;sr&#x2F;A&#x2F;l&#x2F;t&#x2F;@p&quot;) == null)){
                var lNode, lValT;
                lNodes = oBrowseNode.selectNodes(&quot;sr&#x2F;A&#x2F;l&#x2F;t&quot;);
                for (i = 0; i &lt; lNodes.length; i++) {
                    lNode = lNodes[i];
                    lValT = lNode.text;
                    rex = &#x2F;(&amp;\w+;)&#x2F;g;
                    lValT = lValT.replace(rex, &quot;&quot;);
                    lValT = RemoveSymbols(lValT, &#x27; &#x27;);
                    rex = &#x2F;(\s+$)&#x2F;g;
                    lValT = lValT.replace(rex, &quot;&quot;);
                    if ((frame_Browse.event.ctrlLeft)) {
                        lNode.setAttribute(&quot;p&quot;, jsStrReverse(lValT));
                    } else {
                        lNode.setAttribute(&quot;p&quot;, lValT);
                    }
                }
                &#x2F;&#x2F;            }
                sortNode.setAttribute(&quot;select&quot;, &quot;t&#x2F;@p&quot;);
            } else {
                sortNode.setAttribute(&quot;select&quot;, browseSortBy);
            }
            sortNode.setAttribute(&quot;order&quot;, browseSortOrder);
        }
        FillBrowseFrame(oBrowseNode);
    } else if (oSrc.tagName == &quot;IMG&quot; &amp;&amp; oSrc.id == &quot;filterImg&quot;) {
        var leid, filtritav;
        unStr = JR;
        if (oSrc.parentElement.id == filterBy) {
            lNodes = oBrowseNode.selectNodes(&quot;sr&#x2F;A&#x2F;l&quot;);
            for (i = 0; i &lt; lNodes.length; i++) {
                leid = lNodes[i];
                leid.setAttribute(&quot;show&quot;, &quot;true&quot;);
            }
            filterBy = &quot;&quot;;
        } else {
            lNodes = oBrowseNode.selectNodes(&quot;sr&#x2F;A&#x2F;l&quot;);
            for (i = 0; i &lt; lNodes.length; i++) {
                leid = lNodes[i];
                filtritav = leid.selectSingleNode(oSrc.parentElement.id).text;
                if (unStr.indexOf(JR + filtritav + JR) &gt; -1) {
                    leid.setAttribute(&quot;show&quot;, &quot;false&quot;);
                } else {
                    unStr = unStr + filtritav + JR;
                    leid.setAttribute(&quot;show&quot;, &quot;true&quot;);
                }
            }
            filterBy = oSrc.parentElement.id;
        }
        FillBrowseFrame(oBrowseNode);
    } else if (oSrc.tagName == &quot;IMG&quot; &amp;&amp; oSrc.id == &quot;changeTable&quot;) {
        if (oBrowseNode) { &#x2F;&#x2F;oOutDomNode: srvfuncs &#x27;outDOM&#x27;
            &#x2F;&#x2F;            if (brTbl.getAttribute(&quot;soors&quot;) == &quot;fromServer&quot;) {
            &#x2F;&#x2F;                changeTable();
            &#x2F;&#x2F;            }
            &#x2F;&#x2F;            else {
            &#x2F;&#x2F;                FillBrowseFrame(oBrowseNode);
            &#x2F;&#x2F;            }

            var thisQm = oBrowseNode.selectSingleNode(&quot;r&#x2F;qM&quot;).text;
            if (thisQm.indexOf(&quot;MySQL&quot;) &gt; -1) {
                alert(&quot;Tabeli muutmiseks peab päring olema tehtud XML viisil.\n\n(Vajuta &#x27;xml&#x27; nuppu)&quot;);
                return;
            }

            var brTblCols = document.getElementById(&quot;div_BrTableCols&quot;);
            var skeemiJupp = document.getElementById(&quot;div_skeemiJupp&quot;);
            skeemiJupp.innerHTML = &quot;&quot;;

            &#x2F;&#x2F;div_ElemsMenu ja div_AttrsMenu &lt;tr&gt;:
            &#x2F;&#x2F;class = &#x27;mi&#x27;; id = sFullPath; value = &#x27;qname|name|URI|IsElement|kirjeldav&#x27;
            var aElemInfo = sSeldElemValue.split(&quot;|&quot;);
            var seldQn = aElemInfo[0];

            &#x2F;&#x2F;sNodeTest algab artiklist: &quot;q:A&#x2F;...&quot; jne
            var sNodeTest;
            if (sSeldAttrValue != &quot;&quot;) {
                sNodeTest = jsMid(sSeldItemId, 0, sSeldItemId.lastIndexOf(&quot;&#x2F;&quot;));
            } else {
                sNodeTest = sSeldItemId;
            }
            if (yldStruDom.documentElement.getAttribute(&quot;pr_sd:ver&quot;) == &quot;2.0&quot;) {
                var yldStruNode = yldStruDom.documentElement.selectSingleNode(sNodeTest);
                if (yldStruNode.selectNodes(&quot;*&quot;).length &gt; 0) {
                    var ul = document.createElement(&quot;ul&quot;);
                    ul.style.marginLeft = &quot;6mm&quot;;
                    skeemiJupp.appendChild(ul);

                    var minOcc = yldStruNode.getAttribute(&quot;pr_sd:minOcc&quot;);
                    var maxOcc = yldStruNode.getAttribute(&quot;pr_sd:maxOcc&quot;);
                    if (maxOcc == 2000000000) {
                        maxOcc = String.fromCharCode(0x221E);
                    }
                    var tekst = &quot;[&quot; + minOcc + &quot;, &quot; + maxOcc + &quot;] - &amp;lt;&quot; + yldStruNode.nodeName + &quot;&amp;gt;&quot;;
                    var nimeAttr = yldStruNode.getAttribute(&quot;pr_sd:nimi&quot;);
                    if (nimeAttr) {
                        var kirjeldavad = nimeAttr.split(&quot;;&quot;);
                        var kirjeldav = kirjeldavad[appKeeled[sAppLang]];
                        tekst += &quot; = &quot; + kirjeldav;
                    }

                    var li = document.createElement(&quot;li&quot;);
                    li.innerHTML = tekst;
                    ul.appendChild(li);

                    lisaHarud(yldStruNode, li, &quot;&quot;);

                    brTblCols.style.pixelLeft = 512;
                    brTblCols.style.pixelTop = 128;
                    brTblCols.style.display = &quot;&quot;;
                }
                else {
                    alert(&quot;Tabeli muutmiseks peab päring olema tehtud mingist grupist, elemendi pealt, millel on mingi struktuur!&quot;);
                    return;
                }
            }
            else {
                alert(&quot;Skeemi genereerimine tegemata!&quot;);
                return;
            }
        }
    } else if (oSrc.tagName == &quot;IMG&quot; &amp;&amp; oSrc.id == &quot;copyTable&quot;) {
        if (brTbl) {
            var ctlRng = browseDoc.body.createControlRange();
            ctlRng.add(brTbl);
            ctlRng.select();
            ctlRng.execCommand(&quot;Copy&quot;);
        }
    }
} &#x2F;&#x2F;browseTableClick


&#x2F;**
* 
*
* @method lisaHarud
* @param {Object} yNode
* @param {Object} liNode
* @param {String} ulId
*&#x2F;
function lisaHarud(yNode, liNode, ulId) {
    var harud = yNode.selectNodes(&quot;*&quot;);
    for (var haruJnr = 0; haruJnr &lt; harud.length; haruJnr++) {
        var ul = document.createElement(&quot;ul&quot;);
        ul.style.marginLeft = &quot;6mm&quot;;
        liNode.appendChild(ul);

        var li = document.createElement(&quot;li&quot;);
        var inserted = ul.appendChild(li);
        var uusId = &quot;&quot;;
        if (ulId.length &gt; 0) {
            uusId = ulId + &quot;&#x2F;&quot; + harud[haruJnr].nodeName;
        }
        else {
            uusId = harud[haruJnr].nodeName;
        }

        var chk = document.createElement(&quot;input&quot;);
        chk.type = &quot;checkbox&quot;;
        chk.id = uusId;
        inserted = li.appendChild(chk);

        var minOcc = harud[haruJnr].getAttribute(&quot;pr_sd:minOcc&quot;);
        var maxOcc = harud[haruJnr].getAttribute(&quot;pr_sd:maxOcc&quot;);
        if (maxOcc == 2000000000) {
            maxOcc = String.fromCharCode(0x221E); &#x2F;&#x2F; lõpmatus
        }

        var tekst = &quot;[&quot; + minOcc + &quot;, &quot; + maxOcc + &quot;] - &amp;lt;&quot; + harud[haruJnr].nodeName + &quot;&amp;gt;&quot;;
        var nimeAttr = harud[haruJnr].getAttribute(&quot;pr_sd:nimi&quot;);
        if (nimeAttr) {
            var kirjeldavad = nimeAttr.split(&quot;;&quot;);
            var kirjeldav = kirjeldavad[appKeeled[sAppLang]];
            tekst += &quot; = &quot; + kirjeldav;
        }

        var lbl = document.createElement(&quot;label&quot;);
        lbl.htmlFor = uusId;
        lbl.innerHTML = tekst;
        inserted = li.appendChild(lbl);

        lisaHarud(harud[haruJnr], li, uusId);
    }
} &#x2F;&#x2F; lisaHarud


&#x2F;**
* 
*
* @method veerudOkClick
*&#x2F;
function veerudOkClick() {
    var brTblCols = document.getElementById(&quot;div_BrTableCols&quot;);
    brTblCols.style.display = &quot;none&quot;;

    var xslBrowse3 = IDD(&quot;File&quot;, &quot;xsl&#x2F;browse3.xsl&quot;, true, false, null);
    if (xslBrowse3.parseError.errorCode != 0) {
        ShowXMLParseError(xslBrowse3);
        return;
    }
    xslBrowse3.setProperty(&quot;AllowDocumentFunction&quot;, true);
    xslBrowse3.setProperty(&quot;AllowXsltScript&quot;, true);
    xslBrowse3.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
    xslBrowse3.setProperty(&quot;SelectionNamespaces&quot;, sXmlNsList);

    xslBrowse3.documentElement.setAttribute(&quot;xmlns:pref&quot;, DICURI);
    xslBrowse3.documentElement.setAttribute(&quot;xmlns:&quot; + DICPR, DICURI);

    var skeemiJupp = document.getElementById(&quot;div_skeemiJupp&quot;);
    var linnukesed = skeemiJupp.getElementsByTagName(&quot;input&quot;);

    &#x2F;&#x2F; Define a regular expression for repeated words.
    &#x2F;&#x2F; Regex rx = new Regex(@&quot;\b(?&lt;word&gt;\w+)\s+(\k&lt;word&gt;)\b&quot;,
    &#x2F;&#x2F;          RegexOptions.Compiled | RegexOptions.IgnoreCase);
    &#x2F;&#x2F; &#x2F;\b([a-z]+) \1\b&#x2F;gi

    var ptrn = &quot;&quot;, reksStr = &quot;^&quot;, yhine, mitu = 0, mitu2 = 0, ixL, yksik, linnuke;
    for (ixL = 0; ixL &lt; linnukesed.length; ixL++) {
        linnuke = linnukesed[ixL];
        if (linnuke.type == &quot;checkbox&quot;) {
            if (linnuke.checked) {
                ptrn += &quot; &quot; + linnuke.id;
                mitu++;
                if (mitu == 1) {
                    reksStr += &quot;(\\s([\\w:]+\\&#x2F;)+)[\\w:\\&#x2F;]*&quot;;
                }
                else {
                    reksStr += &quot;\\1[\\w:\\&#x2F;]*&quot;;
                }
            }
        }
    }
    reksStr += &quot;$&quot;;
    var reks = new RegExp(reksStr);

    &#x2F;&#x2F;    var reks = &#x2F;(((^|\s)[a-z\:]+\&#x2F;)+)(.*?)\1{1}&#x2F;g;
    &#x2F;&#x2F; var reks = &#x2F;^(\s([a-z\:]+\&#x2F;)+)[a-z\:\&#x2F;]*\1{1}&#x2F;g;

    &#x2F;&#x2F; \w - Equivalent to [A-Za-z0-9_]
    &#x2F;&#x2F;    var reks = new RegExp(&quot;^((\\s([\\w:]+\\&#x2F;)+)[\\w:\\&#x2F;]*){&quot; + (mitu - 1) + &quot;}\\2([\\w:\\&#x2F;]*)$&quot;);
    &#x2F;&#x2F;    var reks = new RegExp(&quot;^(\\s([\\w:]+\\&#x2F;)+[\\w:\\&#x2F;]+){&quot; + (mitu - 1) + &quot;}\\1&quot;);

    &#x2F;&#x2F; If the global flag is set for a regular expression, 
    &#x2F;&#x2F; exec searches the string beginning at the position indicated by the value of lastIndex. 
    &#x2F;&#x2F;
    &#x2F;&#x2F; If the global flag is not set, 
    &#x2F;&#x2F; exec ignores the value of lastIndex and searches from the beginning of the string.
    var result = reks.exec(ptrn);
    if (result) {
        yhine = jsTrim(result[1]);
        if (yhine.substr(yhine.length - 1, 1) == &quot;&#x2F;&quot;) {
            yhine = yhine.substr(0, yhine.length - 1);
        }
    }

    var veerud = &quot;&lt;xsl:variable name=&#x27;veerud&#x27; xmlns:xsl=&#x27;&quot; + NS_XSL + &quot;&#x27;&gt;&quot;;
    veerud += &quot;&lt;veerg&gt;Märksõna(d)&lt;&#x2F;veerg&gt;&quot;;

    var sisu = &quot;&lt;xsl:for-each select=\&quot;l&#x2F;t&#x2F;*\&quot; xmlns:xsl=&#x27;&quot; + NS_XSL + &quot;&#x27;&gt;&quot;;
    if (yhine) {
        sisu += &quot;&lt;xsl:for-each select=\&quot;&quot; + yhine + &quot;\&quot;&gt;&quot;;
    }
    sisu += &quot;&lt;xsl:element name=\&quot;tr\&quot;&gt;&quot;;

    sisu += &quot;&lt;xsl:element name=\&quot;td\&quot;&gt;&quot; +
        &quot;&lt;xsl:element name=\&quot;span\&quot;&gt;&quot; +
        &quot;&lt;xsl:attribute name=\&quot;class\&quot;&gt;_md&lt;&#x2F;xsl:attribute&gt;&quot; +
        &quot;&lt;xsl:attribute name=\&quot;value\&quot;&gt;&quot; +
            &quot;&lt;xsl:value-of select=\&quot;concat($vf, &#x27;||&#x27;, $G)\&quot; &#x2F;&gt;&quot; +
        &quot;&lt;&#x2F;xsl:attribute&gt;&quot; +
        &quot;&lt;xsl:value-of select=\&quot;al:RS(string($md))\&quot; disable-output-escaping=\&quot;yes\&quot; &#x2F;&gt;&quot; +
        &quot;&lt;&#x2F;xsl:element&gt;&quot; +
    &quot;&lt;&#x2F;xsl:element&gt;&quot;;

    for (ixL = 0; ixL &lt; linnukesed.length; ixL++) {
        linnuke = linnukesed[ixL];
        if (linnuke.type == &quot;checkbox&quot;) {
            if (linnuke.checked) {

                mitu2++;
                yksik = linnuke.id;

                var tekst = linnuke.parentElement.getElementsByTagName(&quot;label&quot;)[0].innerText;
                var kirjeldav;
                if (tekst.indexOf(&quot; = &quot;) &gt; -1) {
                    kirjeldav = tekst.substr(tekst.indexOf(&quot; = &quot;) + 3);
                }
                else {
                    kirjeldav = yksik.substr(yksik.lastIndexOf(&quot;&#x2F;&quot;) + 1);
                }
                veerud += &quot;&lt;veerg&gt;&quot; + kirjeldav + &quot;&lt;&#x2F;veerg&gt;&quot;;

                if (yhine) {
                    yksik = linnuke.id.substr(yhine.length + 1);
                }
                if (mitu2 &lt; mitu) {
                    sisu += &quot;&lt;xsl:element name=\&quot;td\&quot;&gt;&quot; +
                                &quot;&lt;xsl:for-each select=\&quot;&quot; + yksik + &quot;\&quot;&gt;&quot; +
                                    &quot;&lt;xsl:if test=\&quot;position() &amp;gt; 1\&quot;&gt;&quot; +
                                        &quot;&lt;xsl:text&gt; :: &lt;&#x2F;xsl:text&gt;&quot; +
                                    &quot;&lt;&#x2F;xsl:if&gt;&quot; +
                                    &quot;&lt;xsl:value-of select=\&quot;al:RS(.)\&quot; disable-output-escaping=\&quot;yes\&quot; &#x2F;&gt;&quot; +
                                    &quot;&lt;xsl:for-each select=\&quot;@*[local-name() = &#x27;i&#x27;]\&quot;&gt;&quot; +
                                      &quot;&lt;xsl:call-template name=\&quot;att2\&quot;&gt;&lt;&#x2F;xsl:call-template&gt;&quot; +
                                    &quot;&lt;&#x2F;xsl:for-each&gt;&quot; +
                                &quot;&lt;&#x2F;xsl:for-each&gt;&quot; +
                        &quot;&lt;&#x2F;xsl:element&gt;&quot;;
                }
                else {
                    &#x2F;&#x2F;                    sisu += &quot;&lt;xsl:for-each select=\&quot;&quot; + yksik + &quot;\&quot;&gt;&quot; +
                    &#x2F;&#x2F;                        &quot;&lt;xsl:element name=\&quot;td\&quot;&gt;&quot; +
                    &#x2F;&#x2F;                        &quot;&lt;xsl:value-of select=\&quot;al:RS(.)\&quot; disable-output-escaping=\&quot;yes\&quot; &#x2F;&gt;&quot; +
                    &#x2F;&#x2F;                        &quot;&lt;&#x2F;xsl:element&gt;&quot; +
                    &#x2F;&#x2F;                    &quot;&lt;&#x2F;xsl:for-each&gt;&quot;;
                    sisu += &quot;&lt;xsl:element name=\&quot;td\&quot;&gt;&quot; +
                                &quot;&lt;xsl:for-each select=\&quot;&quot; + yksik + &quot;\&quot;&gt;&quot; +
                                    &quot;&lt;xsl:if test=\&quot;position() &amp;gt; 1\&quot;&gt;&quot; +
                                        &quot;&lt;xsl:text&gt; :: &lt;&#x2F;xsl:text&gt;&quot; +
                                    &quot;&lt;&#x2F;xsl:if&gt;&quot; +
                                    &quot;&lt;xsl:value-of select=\&quot;al:RS(.)\&quot; disable-output-escaping=\&quot;yes\&quot; &#x2F;&gt;&quot; +
                                    &quot;&lt;xsl:for-each select=\&quot;@*[local-name() = &#x27;i&#x27;]\&quot;&gt;&quot; +
                                      &quot;&lt;xsl:call-template name=\&quot;att2\&quot;&gt;&lt;&#x2F;xsl:call-template&gt;&quot; +
                                    &quot;&lt;&#x2F;xsl:for-each&gt;&quot; +
                                &quot;&lt;&#x2F;xsl:for-each&gt;&quot; +
                        &quot;&lt;&#x2F;xsl:element&gt;&quot;;
                }
            }
        }
    }
    veerud += &quot;&lt;&#x2F;xsl:variable&gt;&quot;;

    sisu += &quot;&lt;&#x2F;xsl:element&gt;&quot;; &#x2F;&#x2F; &lt;tr&gt;

    if (yhine) {
        sisu += &quot;&lt;&#x2F;xsl:for-each&gt;&quot;; &#x2F;&#x2F; &#x27;ühine&#x27;
    }
    sisu += &quot;&lt;&#x2F;xsl:for-each&gt;&quot;; &#x2F;&#x2F; l&#x2F;t&#x2F;*

    var veerudVar = xslBrowse3.documentElement.selectSingleNode(&quot;xsl:variable[@name = &#x27;veerud&#x27;]&quot;);
    var tempDom = IDD(&quot;String&quot;, veerud, false, false, null);
    if (tempDom.parseError.errorCode == 0) {
        veerudVar.parentNode.replaceChild(tempDom.documentElement, veerudVar);
    }
    else {
        alert(tempDom.parseError.reason);
        return;
    }
    var veerudSisu = xslBrowse3.documentElement.selectSingleNode(&quot;.&#x2F;&#x2F;tbody[@id = &#x27;browseTableTBody&#x27;]&#x2F;&#x2F;xsl:for-each[@select = &#x27;l&#x2F;t&#x2F;*&#x27;]&quot;);
    if (!veerudSisu) {
        return;
    }

    tempDom = IDD(&quot;String&quot;, sisu, false, false, null);
    if (tempDom.parseError.errorCode == 0) {
        veerudSisu.parentNode.replaceChild(tempDom.documentElement, veerudSisu);
    }
    else {
        alert(tempDom.parseError.reason);
        return;
    }

    browseDoc.open(&quot;text&#x2F;html&quot;, &quot;replace&quot;);
    browseDoc.write(oBrowseNode.transformNode(xslBrowse3));
    browseDoc.close;

    nBrRowIndex = -1;
    browseDoc.onclick = browseTable3Click;
} &#x2F;&#x2F; veerudOkClick



&#x2F;**
* 
*
* @method veerudCancelClick
*&#x2F;
function veerudCancelClick() {
    var brTblCols = document.getElementById(&quot;div_BrTableCols&quot;);
    brTblCols.style.display = &quot;none&quot;;
} &#x2F;&#x2F; veerudCancelClick


&#x2F;**
* 
*
* @method browseTable3Click
*&#x2F;
function browseTable3Click() {
    var oSrc = frame_Browse.event.srcElement;
    var oRow;
    var i, unStr, tarr;
    var sPrmDomXml, oPrmDom;

    var brTbl = browseDoc.getElementById(&quot;browseTable&quot;);

    if (!(oSrc.tagName == &quot;SPAN&quot; || oSrc.tagName == &quot;TH&quot; || oSrc.tagName == &quot;IMG&quot;)) {
        if (oSrc.parentElement.className == &quot;_md&quot;) {
            oSrc = oSrc.parentElement;
        }
    }

    if (oSrc.tagName == &quot;SPAN&quot; &amp;&amp; oSrc.className == &quot;_md&quot;) {
        if (nBrRowIndex &gt; -1) {
            brTbl.rows(nBrRowIndex).style.backgroundColor = &quot;&quot;;
        }
        oRow = oSrc.parentElement.parentElement;
        nBrRowIndex = oRow.rowIndex;
        brTbl.rows(nBrRowIndex).style.backgroundColor = &quot;silver&quot;

        &#x2F;&#x2F;@vf, &#x27;||&#x27;, G;
        tarr = oSrc.value.split(&quot;||&quot;);

        sCmdId = &quot;BrowseRead&quot;;
        &#x2F;&#x2F; nt vsl &#x27;C&amp;F&#x27;: innerText ei kõlba
        sQryInfo = oSrc.innerHTML;

        var qM = &quot;MySql&quot;;
        if (frame_Browse.event.ctrlLeft) {
            qM = &quot;XML&quot;;
        }

        sPrmDomXml = &quot;&lt;prm&gt;&quot; +
                &quot;&lt;cmd&gt;&quot; + sCmdId + &quot;&lt;&#x2F;cmd&gt;&quot; +
                &quot;&lt;vol&gt;&quot; + tarr[0] + &quot;&lt;&#x2F;vol&gt;&quot; +
                &quot;&lt;nfo&gt;&quot; + sQryInfo + &quot;&lt;&#x2F;nfo&gt;&quot; +
                &quot;&lt;G&gt;&quot; + tarr[1] + &quot;&lt;&#x2F;G&gt;&quot; +
                &quot;&lt;qM&gt;&quot; + qM + &quot;&lt;&#x2F;qM&gt;&quot; +
               &quot;&lt;&#x2F;prm&gt;&quot;;

        oPrmDom = IDD(&quot;String&quot;, sPrmDomXml, false, false, null);
        if (oPrmDom.parseError.errorCode != 0) {
            ShowXMLParseError(oPrmDom);
            return;
        }
        StartOperation(oPrmDom);
    } else if (oSrc.tagName == &quot;IMG&quot; &amp;&amp; oSrc.id == &quot;changeTable&quot;) {
        FillBrowseFrame(oBrowseNode);
    } else if (oSrc.tagName == &quot;IMG&quot; &amp;&amp; oSrc.id == &quot;copyTable&quot;) {
        if (brTbl) {
            var ctlRng = browseDoc.body.createControlRange();
            ctlRng.add(brTbl);
            ctlRng.select();
            ctlRng.execCommand(&quot;Copy&quot;);
        }
    }
} &#x2F;&#x2F;browseTable3Click



&#x2F;**
* 
*
* @method FillArtFrames
* @param {Object} oArtNode
* @param {Boolean} delURHistory
*&#x2F;
function FillArtFrames(oArtNode, delURHistory) {

    &#x2F;&#x2F;lisatakse tühjad tekstinoodid &quot;&quot; elementidele, millel pole alamelemente ega teksti
    AddEmptyTexts(oArtNode);

    var avatavad, avatav, kinniLahtid, kinniLahti, edOAttr, avatud;

    &#x2F;&#x2F;xml võrdlemiseks muudatuste kindlakstegemisel, &#x27;oArtNode&#x27; algab &lt;A&gt;
    oOrgArtNode = oArtNode.cloneNode(true);
    avatavad = oOrgArtNode.selectNodes(&quot;.&#x2F;&#x2F;*&#x2F;@&quot; + DICPR + &quot;:edO&quot;);
    avatavad.removeAll();

    artMuudatused = &quot;&quot;;
    if ((delURHistory)) {
        urfragment = oEditDOM.createDocumentFragment();
        urindex = -1;
        urlast = urindex;

        if (!(yldStruDom == null)) {
            &#x2F;&#x2F;Sõnapered: &quot;maa&quot; ja &quot;töö&quot;: üle 30000 märgi;
            if ((oArtNode.xml.length &gt; 10240)) {
                avatud = &quot;0&quot;;
            } else {
                avatud = &quot;1&quot;;
            }
            edOAttr = oArtNode.ownerDocument.createNode(NODE_ATTRIBUTE, DICPR + &quot;:edO&quot;, DICURI);
            avatavad = yldStruDom.documentElement.selectNodes(&quot;.&#x2F;&#x2F;*[@&quot; + DICPR + &quot;:edO]&quot;);
            for (i = 0; i &lt; avatavad.length; i++) {
                avatav = avatavad[i];
                kinniLahtid = oArtNode.selectNodes(&quot;.&#x2F;&#x2F;&quot; + avatav.nodeName);
                for (j = 0; j &lt; kinniLahtid.length; j++) {
                    kinniLahti = kinniLahtid[j];
                    &#x2F;&#x2F;see siga ei tööta prefiksiga ..., vähemasti järgneva XSLt teisenduse jaoks;
                    &#x2F;&#x2F;neid on küll, nt @O salvestamisel;
                    &#x2F;&#x2F;ilmselt salvestamisel ikkagi käheb kõik korda ...;
                    &#x2F;&#x2F;kinniLahti.setAttribute(DICPR + &quot;:edO&quot;, &quot;0&quot;);
                    edOAttr.value = avatud;
                    kinniLahti.attributes.setNamedItem(edOAttr.cloneNode(true));
                }
            }
        }
    }

    if ((oEditDOMRoot.hasChildNodes())) {
        oEditDOMRoot.replaceChild(oArtNode, oEditDOMRoot.firstChild);
    } else {
        oEditDOMRoot.appendChild(oArtNode);
    }

    artOrgString = getXmlString(oEditDOM);

    var oM1Node = oEditDOMRoot.selectSingleNode(first_default);
    sOrgMarkSona = oM1Node.text;
    sOrgHomnr = oM1Node.getAttribute(qn_homnr);
    if (sOrgHomnr == null)
        sOrgHomnr = &#x27;&#x27;;

    var ptElem, pt, tlElem, tElem, t = &#x27;&#x27;, tlTekst = &#x27;&#x27;, klElem, kElem, k;
    ptElem = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + DICPR + &quot;:PT&quot;);
    if (ptElem) {
        pt = ptElem.text;
    } else {
        pt = &quot;&quot;;
    }

    tElem = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + qn_toimetaja);
    if (tElem) {
        t = tElem.text;
    }

    tlElem = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + DICPR + &quot;:TL&quot;);
    if (tlElem) {
        tlTekst = tlElem.text;
        if (dic_desc != &#x27;psv&#x27;) {
            if (t.length &gt; 0) {
                tlTekst = t + &quot;, &quot; + tlTekst;
            }
        }
    }
    if (dic_desc == &#x27;elt&#x27;) {
        tlTekst = &quot;&quot;;
        tlElem = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + DICPR + &quot;:lTL&quot;);
        if (tlElem) {
            tlTekst += tlElem.getAttribute(DICPR + &quot;:nimi&quot;) + &quot;, &quot; + tlElem.getAttribute(DICPR + &quot;:aeg&quot;);
        }
        tlElem = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + DICPR + &quot;:eTL&quot;);
        if (tlElem) {
            if (tlTekst) {
                tlTekst += &quot;; &quot;;
            }
            tlTekst += tlElem.getAttribute(DICPR + &quot;:nimi&quot;) + &quot;, &quot; + tlElem.getAttribute(DICPR + &quot;:aeg&quot;);
        }
    }

    klElem = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + DICPR + &quot;:KL&quot;);
    if (klElem) {
        kElem = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + qn_autor);
        k = kElem.text;
    } else {
        k = &quot;&quot;;
    }

    var msgSisu = &quot;&quot;;
    if (k) {
        msgSisu = &quot;&lt;img src=&#x27;graphics&#x2F;msgbox_info_16_16.ico&#x27;&gt;&lt;span style=&#x27;color:green;&#x27;&gt; &quot; + jsReplace(ENTRY_STARTED, &quot;[%s]&quot;, k) + &quot;&lt;&#x2F;span&gt;&quot;;
    }
    if (tlTekst) {
        msgSisu = &quot;&lt;img src=&#x27;graphics&#x2F;msgbox_info_16_16.ico&#x27;&gt;&lt;span style=&#x27;color:blue;&#x27;&gt; Artiklile on lisatud toimetamise lõpu märge: &quot; + tlTekst + &quot;&lt;&#x2F;span&gt;&quot;;
    }
    if (pt) {
        msgSisu = &quot;&lt;img src=&#x27;graphics&#x2F;msgbox_info_16_16.ico&#x27;&gt;&lt;span style=&#x27;color:red;&#x27;&gt; &quot; + jsReplace(ENTRY_SIGNED, &quot;[%s]&quot;, pt) + &quot;&lt;&#x2F;span&gt;&quot;;
    }

    spn_msg.innerHTML = msgSisu;

    bArtSaveAllowed = false;
    bArtDelAllowed = false;

    if ((pt != &quot;&quot;)) {
        if (sUsrName == pt &amp;&amp; bArtSignAllowed) { &#x2F;&#x2F;bArtSignAllowed: srtegija ja ptd hulgas;
            bArtSaveAllowed = true;
            bArtDelAllowed = true;
        }
    } else {
        &#x2F;&#x2F; 09. sept 11: toimetajad saavad üle kirjutada artikleid, millele on märgitud juurde toimetamise lõpp
        &#x2F;&#x2F; nt PSV: Liivi Hollman lisab juurde videod Jelena lõpuni toimetatud artiklitele
        if ((srTegija)) {
            if (dic_desc == &quot;psv&quot;) {
                bArtSaveAllowed = true;
                bArtDelAllowed = true;
            }
            else {
                if (tlTekst != &#x27;&#x27;) {
                    if (sUsrName == t) {
                        bArtSaveAllowed = true;
                        bArtDelAllowed = true;
                    }
                }
                else {
                    bArtSaveAllowed = true;
                    bArtDelAllowed = true;
                }
            }
        }
    }

    div_ArtToolsMenu.innerHTML = &quot;&quot;;
    if (srTegija) {
        if (!(document.all(&quot;img_ArtTools&quot;) == null)) {
            lisa_KL_TL_PT();
            lisaVeelArtToolse();
            if (!(div_ArtToolsMenu.innerHTML == &quot;&quot;)) {
                bArtToolsEnabled = true;
            } else {
                bArtToolsEnabled = false;
            }
        }
        if ((zeus.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1)) {
            bArtSaveAllowed = true;
            bArtDelAllowed = true;
        }
    }

    &#x2F;&#x2F;&#x27;16. juuni 2011
    &#x2F;&#x2F;var tyhi
    &#x2F;&#x2F;set tyhi = oEditDOMRoot.selectSingleNode(&quot;.&#x2F;&#x2F;text()[. = &#x27;&#x27;]&quot;)
    &#x2F;&#x2F;if(! (tyhi == null)){
    &#x2F;&#x2F;    &#x27;kui see on kunagi lisatud tähelepanu juthimiseks, siis olgu juba
    &#x2F;&#x2F;    tyhi.text = &quot;???----------------------------------------------------------------------???&quot;
    &#x2F;&#x2F;}

    oClicked = null;

    vaatedRefresh(2);

    fillImgFrame();

    if (!(document.all(&quot;img_artHistory&quot;) == null)) {
        var tblAjalugu, rida, veerg, artGuid;
        tblAjalugu = div_ArtHistoryMenu.all(&quot;tbl_ArtHistoryMenu&quot;);
        if ((tblAjalugu.rows.length == 100)) {
            tblAjalugu.deleteRow(tblAjalugu.rows.length - 1);
        }
        rida = tblAjalugu.insertRow(0);
        rida.className = &quot;mi&quot;;
        artGuid = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + qn_guid).text;
        rida.id = artGuid;
        rida.setAttribute(&quot;v&quot;, sFromVolume); &#x2F;&#x2F;&#x27;&quot;ief1&quot; jne;
        veerg = rida.insertCell();
        veerg.style.width = &quot;50%&quot;;
        veerg.innerHTML = sOrgMarkSona;
        veerg = rida.insertCell();
        veerg.innerHTML = new Date();
    }

} &#x2F;&#x2F;FillArtFrames


&#x2F;**
* 
*
* @method fillImgFrame
*&#x2F;
function fillImgFrame() {
    var brdStyle, fiBodyHTML;
    brdStyle = &quot;2px solid black&quot;

    fiBodyHTML = &quot;&quot;

    &#x2F;&#x2F;class=&#x27;myText&#x27; kirjutatakse allpool html-i
    &#x2F;&#x2F;
    if ((dic_desc == &quot;od_&quot;)) {
        var tmen, tmet;
        tmen = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + DICPR + &quot;:P&#x2F;&quot; + DICPR + &quot;:tmen&quot;).text;
        tmet = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + DICPR + &quot;:P&#x2F;&quot; + DICPR + &quot;:tmet&quot;).text;
        &#x2F;&#x2F;2013: mõttekriips &quot;en dash&quot;;
        fiBodyHTML = &quot;&lt;p style=&#x27;font-family:\&quot;Arial\&quot;;font-weight:bold;font-size:large;&#x27;&gt;&quot; + &quot;&lt;i&gt;&quot; + sMSortVal + &quot;: &quot; + tmen + &quot;&lt;&#x2F;i&gt; &quot; + String.fromCharCode(0x2013) + &quot; &quot; + tmet + &quot; &lt;span id=&#x27;addPic&#x27; class=&#x27;myText&#x27; title=&#x27;Lisa&#x27; style=&#x27;font-size:small;&#x27;&gt;&amp;#xa0;Lisa pilt&amp;#xa0;&lt;&#x2F;span&gt;&quot; + &quot;&lt;&#x2F;p&gt;&quot;;
    } else {
        fiBodyHTML = &quot;&lt;p style=&#x27;font-family:\&quot;Arial\&quot;;font-weight:bold;font-size:large;&#x27;&gt;&quot; + sMSortVal + &quot;: &lt;span id=&#x27;addPic&#x27; class=&#x27;myText&#x27; title=&#x27;Lisa&#x27; style=&#x27;font-size:small;&#x27;&gt;&amp;#xa0;Lisa pilt&amp;#xa0;&lt;&#x2F;span&gt;&quot; + &quot;&lt;&#x2F;p&gt;&quot;;
    }


    var pildid, pilt, pf, imgId, olemas, mitu

    &#x2F;&#x2F;A&#x2F;P&#x2F;plt - Oxford-Duden, Liivi-saksa järgi
    &#x2F;&#x2F;
    pildid = oEditDOMRoot.selectNodes(DICPR + &quot;:A&#x2F;&quot; + DICPR + &quot;:P&#x2F;&quot; + DICPR + &quot;:plt&quot;);
    olemas = true;
    mitu = document.frames(&quot;frame_Images&quot;).document.body.all.tags(&quot;DIV&quot;).length

    for (i = 0; i &lt; pildid.length; i++) {
        pilt = pildid[i];
        pf = pilt.selectSingleNode(DICPR + &quot;:pf&quot;).text; &#x2F;&#x2F;&#x27;od_: &#x27;011_med.jpg&#x27;;
        imgId = jsMid(pf, 0, pf.lastIndexOf(&quot;_&quot;)); &#x2F;&#x2F;&#x27;od_: &#x27;011&#x27;;
        if ((document.frames(&quot;frame_Images&quot;).document.body.all(imgId) == null)) {
            olemas = false;
        }
        fiBodyHTML = fiBodyHTML + &quot;&lt;div id=&#x27;&quot; + imgId + &quot;&#x27;&gt;&quot; + &quot;&lt;span id=&#x27;chPic&#x27; class=&#x27;myText&#x27; title=&#x27;Muuda&#x27;&gt;Fail: &quot; + pf + &quot;&lt;&#x2F;span&gt; &quot; + &quot;&lt;span id=&#x27;rmvPic&#x27; class=&#x27;myText&#x27; title=&#x27;Eemalda&#x27; style=&#x27;color:red;&#x27;&gt;Eemalda&lt;&#x2F;span&gt;&quot; + &quot;&lt;br&#x2F;&gt;&quot; + &quot;&lt;img title=&#x27;&quot; + pf + &quot;&#x27; src=&#x27;__sr&#x2F;&quot; + dic_desc + &quot;&#x2F;pictures&#x2F;&quot; + pf + &quot;&#x27;&quot; + &quot;style=&#x27;border:&quot; + brdStyle + &quot;;&#x27;&gt;&quot; + &quot;&lt;&#x2F;img&gt;&quot; + &quot;&lt;&#x2F;div&gt;&quot; + &quot;&lt;br&#x2F;&gt;&quot;;
    }

    if ((pildid.length == 0)) {
        olemas = false;
    } else {
        if ((pildid.length != mitu)) {
            olemas = false;
        }
    }

    if (!(olemas)) {
        var imagesDoc, fiDocHTML;
        imagesDoc = document.frames(&quot;frame_Images&quot;).document.open(&quot;text&#x2F;html&quot;, &quot;replace&quot;);
        fiDocHTML = &quot;&lt;html&gt;&quot; + &quot;&lt;head&gt;&quot; + &quot;&lt;META HTTP-EQUIV=\&quot;Content-Type\&quot; CONTENT=\&quot;text&#x2F;html; charset=utf-8\&quot;&#x2F;&gt;&quot; + &quot;&lt;style type=\&quot;text&#x2F;css\&quot;&gt;&quot; + &quot;.myText {background-color:silver;cursor:hand;}&quot; + &quot;&lt;&#x2F;style&gt;&quot; + &quot;&lt;&#x2F;head&gt;&quot; + &quot;&lt;body&gt;&quot; + fiBodyHTML + &quot;&lt;&#x2F;body&gt;&quot; + &quot;&lt;&#x2F;html&gt;&quot;

        imagesDoc.write(fiDocHTML);

        imagesDoc.close;

        frame_Images.document.body.onclick = fiOnClick;
        frame_Images.document.body.ondblclick = showLargePicture;
    }

} &#x2F;&#x2F;fillImgFrame


&#x2F;**
* 
*
* @method imgImagesClick
*&#x2F;
function imgImagesClick() {
    bringZIndexToFront(&quot;frame_Images&quot;);
} &#x2F;&#x2F;imgImagesClick


&#x2F;**
* 
*
* @method bringZIndexToFront
* @param {String} ziName
*&#x2F;
function bringZIndexToFront(ziName) {

    document.all(ziName).style.zIndex = -1

    var ziNames, tarr, t2, i;
    ziNames = &quot;div_appSisu,-2;frame_Browse,-3;frame_dbgPrint,-4;frame_Images,-5&quot;;
    tarr = ziNames.split(&quot;;&quot;);
    for (i = 0; i &lt; tarr.length; i++) {
        t2 = tarr[i].split(&quot;,&quot;);
        if ((t2[0] != ziName)) {
            document.all(t2[0]).style.zIndex = parseInt(t2[1]);
        }
    }
} &#x2F;&#x2F;bringZIndexToFront


&#x2F;**
* 
*
* @method DeleteEmptys
* @param {Object} deleteFrom
*&#x2F;
function DeleteEmptys(deleteFrom) {
    var oEmptyNodes
    oEmptyNodes = deleteFrom.selectNodes(&quot;.&#x2F;&#x2F;*[normalize-space(.) = &#x27;&#x27; or normalize-space(.) = &#x27;-???-&#x27;]&quot;);
    oEmptyNodes.removeAll
    oEmptyNodes = deleteFrom.selectNodes(&quot;.&#x2F;&#x2F;*[not(text() or *)]&quot;);
    oEmptyNodes.removeAll
    oEmptyNodes = deleteFrom.selectNodes(&quot;.&#x2F;&#x2F;@*[. = &#x27;&#x27; or . = &#x27;-???-&#x27;][not(local-name() = &#x27;mm&#x27; or local-name() = &#x27;mlm&#x27;)]&quot;);
    oEmptyNodes.removeAll;
} &#x2F;&#x2F;DeleteEmptys


&#x2F;**
* 
*
* @method GetXSDDateTime
* @param {Object} dNow või String?
*&#x2F;
function GetXSDDateTime(dNow) {
    var y4 = dNow.getFullYear();
    var mo2 = (dNow.getMonth() &lt; 9 ? &#x27;0&#x27; : &#x27;&#x27;) + (dNow.getMonth() + 1);
    var d2 = (dNow.getDate() &lt; 10 ? &#x27;0&#x27; : &#x27;&#x27;) + (dNow.getDate());
    var h2 = (dNow.getHours() &lt; 10 ? &#x27;0&#x27; : &#x27;&#x27;) + (dNow.getHours());
    var mi2 = (dNow.getMinutes() &lt; 10 ? &#x27;0&#x27; : &#x27;&#x27;) + (dNow.getMinutes());
    var s2 = (dNow.getSeconds() &lt; 10 ? &#x27;0&#x27; : &#x27;&#x27;) + (dNow.getSeconds());
    var sDateTime = y4 + &#x27;-&#x27; + mo2 + &#x27;-&#x27; + d2 + &#x27;T&#x27; + h2 + &#x27;:&#x27; + mi2 + &#x27;:&#x27; + s2;
    return sDateTime;
} &#x2F;&#x2F;GetXSDDateTime


&#x2F;**
* 
*
* @method XMLChildTagsCount
* @param {Object} thisnode
* @param {String} thisname
*&#x2F;
function XMLChildTagsCount(thisnode, thisname) {
    return parseInt(thisnode.selectNodes(thisname).length);
} &#x2F;&#x2F;XMLChildTagsCount


&#x2F;**
* 
*
* @method GetSchemaPosQuery
* @param {Object} seldElement
* @param {String} newElemQName
* @returns {String}
*&#x2F;
function GetSchemaPosQuery(seldElement, newElemQName) {
    var GetSchemaPosQuery;
    var sPr, sUri, sBN, i, snPr, snQN;
    i = newElemQName.indexOf(&quot;:&quot;);
    if ((i &gt; 0)) {
        sPr = jsMid(newElemQName, 0, i);
        sBN = jsMid(newElemQName, i + 1);
    } else {
        sPr = &quot;&quot;;
        sBN = newElemQName;
    }
    sUri = oXmlNsm.getURI(sPr);

    var seldElementDecl, elFound, oParticle, nextpred;
    seldElementDecl = oXmlSc.getDeclaration(seldElement);

    var oXmlFrDom, aAnyNames;

    if ((seldElementDecl.type.itemType == SOMITEM_COMPLEXTYPE)) {
        if ((seldElementDecl.type.contentType &gt; SCHEMACONTENTTYPE_TEXTONLY)) {
            if ((seldElementDecl.type.contentModel.particles.length &gt; 0)) {
                if ((seldElementDecl.type.contentModel.itemType == SOMITEM_SEQUENCE)) {
                    if ((seldElementDecl.type.contentModel.particles[0].itemType == SOMITEM_ANY)) {
                        oXmlFrDom = IDD(&quot;file&quot;, &quot;xml&#x2F;&quot; + dic_desc + &quot;&#x2F;aa_&quot; + unName(seldElement.nodeName) + &quot;.xml&quot;, false, false, null);
                        if ((oXmlFrDom.parseError.errorCode != 0)) {
                            GetSchemaPosQuery = &quot;Suvaline&quot;;
                        } else {
                            aAnyNames = oXmlFrDom.documentElement.text.split(&quot;|&quot;);
                            elFound = false;
                            nextpred = &quot;&quot;;
                            for (i = 0; i &lt; aAnyNames.length; i++) {
                                if ((elFound)) {
                                    nextpred = nextpred + &quot; or name() = &#x27;&quot; + aAnyNames[i] + &quot;&#x27;&quot;;
                                }
                                if ((aAnyNames[i] == newElemQName)) {
                                    elFound = true;
                                }
                            }
                            if (!(nextpred == &quot;&quot;)) {
                                GetSchemaPosQuery = &quot;*[&quot; + jsMid(nextpred, 4) + &quot;][1]&quot;;
                            } else {
                                GetSchemaPosQuery = &quot;&#x2F;..&quot;; &#x2F;&#x2F;&#x27;empty nodeset;
                            }
                        }
                    } else {
                        elFound = false;
                        nextpred = &quot;&quot;;
                        var partiklid = seldElementDecl.type.contentModel.particles;
                        for (i = 0; i &lt; partiklid.length; i++) {
                            oParticle = partiklid[i];
                            if (elFound) {
                                snPr = oXmlNsm.getPrefixes(oParticle.namespaceURI)[0];
                                if (!(snPr == &quot;&quot;)) {
                                    snQN = snPr + &quot;:&quot; + oParticle.name;
                                } else {
                                    snQN = oParticle.name;
                                }
                                nextpred = nextpred + &quot; or name() = &#x27;&quot; + snQN + &quot;&#x27;&quot;;
                            }
                            if ((oParticle.name == sBN &amp;&amp; oParticle.namespaceURI == sUri)) {
                                elFound = true;
                            }
                        }
                        if (!(nextpred == &quot;&quot;)) {
                            GetSchemaPosQuery = &quot;*[&quot; + jsMid(nextpred, 4) + &quot;][1]&quot;;
                        } else {
                            if ((elFound)) {
                                GetSchemaPosQuery = &quot;&#x2F;..&quot;; &#x2F;&#x2F;&#x27;empty nodeset;
                            } else {
                                GetSchemaPosQuery = &quot;Ei saa&quot;;
                            }
                        }
                    }
                } else { &#x2F;&#x2F; if ((seldElementDecl.type.contentModel.itemType == SOMITEM_SEQUENCE)) { &#x2F;&#x2F;no nt choice v all;
                    GetSchemaPosQuery = &quot;Suvaline&quot;;
                }
            } else { &#x2F;&#x2F; if ((seldElementDecl.type.contentModel.particles.length &gt; 0)) {
                GetSchemaPosQuery = &quot;Ei saa&quot;;
            }
        } else { &#x2F;&#x2F; if ((seldElementDecl.type.contentType &gt; SCHEMACONTENTTYPE_TEXTONLY)) {
            GetSchemaPosQuery = &quot;Ei saa&quot;;
        }
    } else { &#x2F;&#x2F; if ((seldElementDecl.type.itemType == SOMITEM_COMPLEXTYPE)) {
        GetSchemaPosQuery = &quot;Ei saa&quot;;
    }
    return GetSchemaPosQuery;
} &#x2F;&#x2F;GetSchemaPosQuery


&#x2F;**
* 
*
* @method imgRecordClick
*&#x2F;
function imgRecordClick() {
    bringZIndexToFront(&quot;div_appSisu&quot;);
} &#x2F;&#x2F;imgRecordClick


&#x2F;**
* 
*
* @method imgBrowseClick
*&#x2F;
function imgBrowseClick() {
    if ((salvestaJaKatkesta())) {
        return;
    }
    bringZIndexToFront(&quot;frame_Browse&quot;);
} &#x2F;&#x2F;imgBrowseClick

&#x2F;**
* 
*
* @method imgArtPrintClick
*&#x2F;
function imgArtPrintClick() {
    if ((oEditDOMRoot.hasChildNodes())) {
        var smdArgs;
        smdArgs = ifrviewdiv.outerHTML + JR + viewCSS.cssText;
        window.showModalDialog(&quot;html&#x2F;artPrint.htm&quot;, smdArgs, &quot;dialogHeight:768px;dialogWidth:1024px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:no;unadorned:no&quot;);
    }
} &#x2F;&#x2F;imgArtPrintClick

&#x2F;**
* 
*
* @method ShowSchema
*&#x2F;
function ShowSchema() {
    window.open(&quot;html&#x2F;schema.htm&quot;, &quot;_blank&quot;, &quot;channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=yes,titlebar=yes,toolbar=yes&quot;);
} &#x2F;&#x2F;ShowSchema

&#x2F;**
* 
*
* @method ShowTipsTricks
*&#x2F;
function ShowTipsTricks() {
    window.open(&quot;help&#x2F;tips.htm&quot;, &quot;_blank&quot;, &quot;channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=yes,titlebar=yes,toolbar=yes&quot;);
} &#x2F;&#x2F;ShowTipsTricks

&#x2F;**
* 
*
* @method ShowDicHelp
*&#x2F;
function ShowDicHelp() {
    if ((appDesc == &quot;EXSA&quot;)) {
        window.open(&quot;help&#x2F;j.htm&quot;, &quot;_blank&quot;, &quot;channelmode=no,directories=no,fullscreen=no,location=yes,menubar=no,resizable=yes,scrollbars=yes,status=yes,titlebar=yes,toolbar=yes&quot;);
    } else {
        window.open(&quot;http:&#x2F;&#x2F;eelex.eki.ee&#x2F;~eelex&#x2F;juhendid&#x2F;eelex_juhend&#x2F;EELex_juhend.htm&quot;, &quot;_blank&quot;, &quot;channelmode=no,directories=no,fullscreen=no,location=yes,menubar=no,resizable=yes,scrollbars=yes,status=yes,titlebar=yes,toolbar=yes&quot;);
    }

} &#x2F;&#x2F;ShowDicHelp

&#x2F;**
* 
*
* @method getAdvQuery
*&#x2F;
function getAdvQuery() {
    &#x2F;&#x2F;var sParms, smdArgs;
    &#x2F;&#x2F;smdArgs = Array(window, oEditDOMRoot);
    &#x2F;&#x2F;sParms = window.showModalDialog(&quot;html&#x2F;qry_adv.htm&quot;,  smdArgs,  &quot;dialogHeight:500px;dialogWidth:800px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:no;unadorned:no&quot;);
    &#x2F;&#x2F;if((sParms == &quot;&quot;)){
    &#x2F;&#x2F; return;
    &#x2F;&#x2F;}
} &#x2F;&#x2F;getAdvQuery

&#x2F;**
* 
*
* @method ShowAdminXsl2
*&#x2F;
function ShowAdminXsl2() {
    window.open(&quot;html&#x2F;gen_xsl2.htm&quot;, &quot;_blank&quot;, &quot;channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=yes,titlebar=yes,toolbar=yes&quot;);
} &#x2F;&#x2F;ShowAdminXsl2


&#x2F;&#x2F;-----------------------------------------------------------------------------------
&#x2F;&#x2F;-------------------------- L I S A D ----------------------------------------------
&#x2F;&#x2F;-----------------------------------------------------------------------------------
&#x2F;**
* 
*
* @method bodyOnKeyUp
*&#x2F;
function bodyOnKeyUp() {
    var oEvent, oSrc, sSrc, rng, i

    if (!(window.event == null)) {
        sSrc = &quot;app&quot;;
        oEvent = window.event;
    } else if (!(frame_Browse.event == null)) {
        sSrc = &quot;browse&quot;;
        oEvent = frame_Browse.event;
    }
    oSrc = oEvent.srcElement

    if (!(oEvent.ctrlKey || oEvent.shiftKey || oEvent.altKey)) {
        if ((oEvent.keyCode == 27)) { &#x2F;&#x2F;ESC;
            document.releaseCapture();
            if ((oSrc.id == &quot;oClickedSelect&quot; || oSrc.id == &quot;oClickedTextArea&quot;)) {
                if ((oSrc.id == &quot;oClickedSelect&quot;)) {
                    oSrc.selectedIndex = -1;
                }
                oSrc.blur();
            }
        } else if ((oEvent.keyCode == 13)) { &#x2F;&#x2F;Enter;
            if ((oSrc.id == &quot;oClickedSelect&quot; || oSrc.id == &quot;oClickedTextArea&quot;)) {
                oSrc.blur();
            } else if ((divFrameEdit.contains(oSrc) &amp;&amp; (oSrc.tagName == &quot;SPAN&quot; || oSrc.tagName == &quot;IMG&quot;))) {
                oSrc.click();
                &#x2F;&#x2F;Ctrl + Enter on IE enda oma ...;
                &#x2F;&#x2F;  }else if((oEvent.ctrlKey)){
                &#x2F;&#x2F;   inp_RunQueryXML.click()
            } else {
                inp_RunQuery.click();
            }
        } else if ((oEvent.keyCode == 113)) { &#x2F;&#x2F;F2;
            if ((divFrameEdit.contains(oSrc))) {
                if (oSrc.tagName == &quot;SPAN&quot; || oSrc.tagName == &quot;IMG&quot;) {
                    oSrc.click();
                } else if (oSrc.id == &quot;oClickedTextArea&quot;) {
                    var retVal, sLinkVols, opt, currTekst, oclid, smdArgs;
                    currTekst = oSrc.value;
                    sLinkVols = &quot;&quot;;
                    var optionid = sel_Vol.options;
                    for (i = 0; i &lt; optionid.length; i++) {
                        opt = optionid[i];
                        if ((opt.id == sAllVolId)) {
                            break;
                        }
                        sLinkVols = sLinkVols + &quot;&lt;option id=&#x27;&quot; + opt.id + &quot;&#x27;&quot;;
                        if ((opt.selected == true)) {
                            sLinkVols = sLinkVols + &quot; selected&quot;;
                        }
                        sLinkVols = sLinkVols + &quot;&gt;&quot; + opt.text + &quot;&lt;&#x2F;option&gt;&quot;;
                    }
                    smdArgs = currTekst + JR + dic_desc + JR + sLinkVols + JR + first_default + JR + oSrc.innerText + JR + sUsrName;
                    retVal = window.showModalDialog(&quot;html&#x2F;listing.htm&quot;, smdArgs, &quot;dialogHeight:200px;dialogWidth:500px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:no;unadorned:no&quot;);
                    if (retVal != null) {
                        var tarr, newVal, guid, vol;
                        tarr = retVal.split(JR);
                        newVal = tarr[2];
                        guid = tarr[1];
                        vol = tarr[0]

                        oclid = oClicked.id

                        clickedNode.text = newVal;
                        &#x2F;&#x2F;märksõna&#x2F;termin;
                        if ((selectedNode.nodeName == qn_ms &amp;&amp; selectedNode.nodeType == NODE_ELEMENT)) {
                            selectedNode.setAttribute(qn_sort_attr, getSortVal(selectedNode, true, true));
                        }

                        if (!(snDecl == null)) {
                            if ((snDecl.type.itemType == SOMITEM_COMPLEXTYPE)) {
                                if ((snDecl.type.attributes.length &gt; 0)) {
                                    var kfFound, gAttr, kfAttr, oParticle, oAttr;
                                    kfFound = false;
                                    gAttr = &quot;&quot;;
                                    kfAttr = &quot;&quot;;
                                    for (i = 0; i &lt; snDecl.type.attributes.length; i++) {
                                        oParticle = snDecl.type.attributes[i];
                                        if ((oParticle.name == &quot;KF&quot; || oParticle.name == &quot;aKF&quot;) &amp;&amp; oParticle.namespaceURI == DICURI) {
                                            kfFound = true;
                                            kfAttr = oParticle.name;
                                        }
                                        if ((oParticle.name == &quot;g&quot; || oParticle.name == &quot;aG&quot;) &amp;&amp; oParticle.namespaceURI == DICURI) {
                                            gAttr = oParticle.name;
                                        }
                                    }
                                    if ((kfFound)) {
                                        oAttr = oEditDOM.createNode(NODE_ATTRIBUTE, DICPR + &quot;:&quot; + kfAttr, DICURI);
                                        oAttr.text = vol;
                                        selectedNode.attributes.setNamedItem(oAttr);
                                    }
                                    if ((gAttr.length &gt; 0)) {
                                        oAttr = oEditDOM.createNode(NODE_ATTRIBUTE, DICPR + &quot;:&quot; + gAttr, DICURI);
                                        oAttr.text = guid;
                                        selectedNode.attributes.setNamedItem(oAttr);
                                    }
                                }
                            }
                        }

                        oEditAll(&quot;ifrdiv&quot;).setAttribute(&quot;xmlChanged&quot;, 2);
                        oClicked = oEditAll(oclid);
                        if ((oViewAll(&quot;_copyDiv&quot;) == null)) {
                            if ((dic_desc == &quot;evs&quot;)) {
                                var domCopy;
                                domCopy = oEditDOM.cloneNode(true);
                                TeisendaDOM(domCopy);
                                oViewAll(&quot;ifrviewdiv&quot;).innerHTML = domCopy.transformNode(oXslView);
                            } else {
                                oViewAll(&quot;ifrviewdiv&quot;).innerHTML = oEditDOM.transformNode(oXslView);
                            }
                        }
                        oClicked.focus()

                    }
                }
            }
        } else if ((oEvent.keyCode == 119)) { &#x2F;&#x2F;F8;
            if ((divFrameEdit.contains(oSrc) &amp;&amp; oSrc.id == &quot;oClickedTextArea&quot;)) {
                if (!(oViewAll(&quot;_copyDiv&quot;) == null)) {
                    rng = document.selection.createRange();
                    rng.text = sTextToCopy;
                }
            }
        }
    } else {
        if ((oEvent.ctrlLeft &amp;&amp; oEvent.shiftLeft) &amp;&amp; !oEvent.altKey) {
            if (oEvent.keyCode == &quot;1&quot;.charCodeAt(0)) {
                switchEdit(xsl1Edit);
            } else if (oEvent.keyCode == &quot;2&quot;.charCodeAt(0)) {
                switchEdit(xsl2Edit);
            } else if (oEvent.keyCode == &quot;3&quot;.charCodeAt(0)) {
                switchEdit(xsl3Edit);
            } else if (oEvent.keyCode == 37) { &#x2F;&#x2F;nool vasakule;
                if (oEvent.srcElement.id != &quot;oClickedTextArea&quot;) {
                    img_readPrev.focus();
                    img_readPrev.click();
                }
            } else if (oEvent.keyCode == 39) { &#x2F;&#x2F;nool paremale;
                if (oEvent.srcElement.id != &quot;oClickedTextArea&quot;) {
                    img_readNext.focus();
                    img_readNext.click();
                }
            } else if (oEvent.keyCode == &quot;V&quot;.charCodeAt(0)) {
                img_ArtValidate.click();
            } else if (oEvent.keyCode == &quot;S&quot;.charCodeAt(0)) {
                img_ArtSave.click();
            } else if (oEvent.keyCode == &quot;K&quot;.charCodeAt(0)) {
                img_ArtDelete.click();
            } else if (oEvent.keyCode == &quot;0&quot;.charCodeAt(0)) {
                if (eeLexAdmin.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1) {
                    &#x2F;&#x2F;                    ShowAdminXsl2();
                    ShowSkeemiGen();
                }
            } else if (oEvent.keyCode == &quot;9&quot;.charCodeAt(0)) {
                if (eeLexAdmin.indexOf(&quot;;&quot; + sUsrName + &quot;;&quot;) &gt; -1) {
                    ShowAdminView();
                }
            } else if (oEvent.keyCode == 123) { &#x2F;&#x2F;F12;
                bringZIndexToFront(&quot;frame_dbgPrint&quot;);
            }
        } else {
            if (oEvent.ctrlLeft &amp;&amp; !(oEvent.altKey || oEvent.shiftKey)) {
                if (oSrc.id == &quot;oClickedTextArea&quot;) {
                    if (oEvent.keyCode == 48) { &#x2F;&#x2F; &#x27;0&#x27; (&#x27;=&#x27;);
                        rng = document.selection.createRange();
                        rng.text = msAsendus;
                    } else if (oEvent.keyCode == 221) { &#x2F;&#x2F; &#x27;-&#x27;, ainult ek klaviatuuri korral !;
                        if (selectedNode.baseName == &quot;xmv&quot;) {
                            var vasteNode, vasteOsa, osaErald;
                            osaErald = &quot;|&quot;;
                            vasteNode = selectedNode.selectSingleNode(&quot;ancestor::&quot; + DICPR + &quot;:xg&#x2F;&quot; + DICPR + &quot;:x&quot;);
                            i = vasteNode.text.indexOf(osaErald);
                            if (i &gt; -1) {
                                vasteOsa = jsMid(vasteNode.text, 0, i);
                            } else {
                                vasteOsa = vasteNode.text;
                            }
                            rng = document.selection.createRange();
                            rng.text = vasteOsa;
                        }
                    } else if (oEvent.keyCode == 222) { &#x2F;&#x2F; &#x27;~&#x27;, tilde;
                        rng = document.selection.createRange();
                        rng.text = String.fromCharCode(0x0303) &#x2F;&#x2F;kombineeriv tilde;
                    } else if (oEvent.keyCode == 49) { &#x2F;&#x2F; &#x27;1&#x27;;
                        rng = document.selection.createRange();
                        rng.text = String.fromCharCode(0x0300) &#x2F;&#x2F;kombineeriv graavis;
                    } else if (oEvent.keyCode == 50) { &#x2F;&#x2F; &#x27;2&#x27;;
                        rng = document.selection.createRange();
                        rng.text = String.fromCharCode(0x0301) &#x2F;&#x2F;kombineeriv akuut;
                    }
                }
            }
        }
    }

} &#x2F;&#x2F;bodyOnKeyUp


&#x2F;**
* 
*
* @method switchEdit
* @param {Object} srcElem
*&#x2F;
function switchEdit(srcElem) {
    if ((srcElem.id == &quot;xsl1Edit&quot; &amp;&amp; !(oXslEdit == oXsl1))) {
        oXslEdit = oXsl1;
        oEditAll(&quot;ifrdiv&quot;).innerHTML = oEditDOM.transformNode(oXslEdit);
    } else if ((srcElem.id == &quot;xsl2Edit&quot; &amp;&amp; !(oXslEdit == oXsl2))) {
        oXslEdit = oXsl2;
        oEditAll(&quot;ifrdiv&quot;).innerHTML = oEditDOM.transformNode(oXslEdit);
    } else if ((srcElem.id == &quot;xsl3Edit&quot; &amp;&amp; !(oXslEdit == oXsl3))) {
        oXslEdit = oXsl3;
        oEditAll(&quot;ifrdiv&quot;).innerHTML = oEditDOM.transformNode(oXslEdit);
    }
} &#x2F;&#x2F;switchEdit


&#x2F;&#x2F;-----------------------------------------------------------------------------------
&#x2F;&#x2F;-----------------------------------------------------------------------------------
&#x2F;&#x2F;-----------------------------------------------------------------------------------
&#x2F;&#x2F;-----------------------------------------------------------------------------------
&#x2F;**
* 
*
* @method ChooseElement
*&#x2F;
function ChooseElement() {
    &#x2F;&#x2F;spn_ElemsMenu click
    var oSrc
    oSrc = window.event.srcElement;
    var nSrcX, nSrcY;
    var nVerGap;
    nVerGap = 4 &#x2F;&#x2F;oSrc border &quot;thin&quot; (2?) ja parent TD padding (2?);
    nSrcX = tbl_Input.offsetLeft + oSrc.offsetLeft;
    nSrcY = window.event.screenY - window.screenTop - window.event.offsetY + oSrc.offsetHeight + nVerGap;
    ShowElemsMenu(nSrcX, nSrcY);
} &#x2F;&#x2F;ChooseElement


&#x2F;**
* 
*
* @method ShowElemsMenu
* @param {Int} nPosX
* @param {Int} nPosY
*&#x2F;
function ShowElemsMenu(nPosX, nPosY) {
    div_ElemsMenu.style.pixelLeft = nPosX;
    div_ElemsMenu.style.pixelTop = nPosY;
    div_ElemsMenu.style.display = &quot;&quot;;
    div_ElemsMenu.style.cursor = &quot;default&quot;;
    div_ElemsMenu.setCapture();
} &#x2F;&#x2F;ShowElemsMenu

&#x2F;**
* 
*
* @method SwitchElemsMenu
*&#x2F;
function SwitchElemsMenu() {
    &#x2F;&#x2F;SwitchElemsMenu on div_ElemsMenu, div_ElemEnumsMenu, div_AttrEnumsMenu, div_ArtHistoryMenu div-idel
    &#x2F;&#x2F;div_ImportDicts
    &#x2F;&#x2F;onmouseover-ks ja onmouseout-ks

    var oSrc;
    var tarr;
    var oParticle;
    var sAttrsMenu;
    var oAttr;
    var sAttrURI, sAttrQN, sAttrReq;
    var sXsdXPath, oXsdNode, sKirjeldav;
    var sAttId, sAttClass;

    oSrc = window.event.srcElement;
    &#x2F;&#x2F;spn_ElemsMenu: span otsitud elemendi infoga; klikates avaneb otsitava elemendi menüü
    &#x2F;&#x2F;img_AttrEnumsMenu: kohe järgmine; img-ile klikates avaneb atribuudi väärtuste valik
    &#x2F;&#x2F;img_ElemEnumsMenu: peale atribuudi teksti väärtust; img-ile klikates avaneb elemendi väärtuste valik

    &#x2F;&#x2F;järgnev if(on vajalik nende stiilide muutmiseks, kui capture on div_ElemsMenu-l
    if ((oSrc.id == &quot;spn_ElemsMenu&quot; || oSrc.id == &quot;img_AttrEnumsMenu&quot; || oSrc.id == &quot;img_ElemEnumsMenu&quot; || oSrc.id == &quot;img_ArtTools&quot; || oSrc.id == &quot;img_SrTools&quot; || oSrc.id == &quot;img_artHistory&quot;)) {
        SwitchTD(window.event);
    }

    if (oSrc.tagName == &quot;TD&quot;) {
        if (div_ElemsMenu.contains(oSrc)) { &#x2F;&#x2F; otsitava elemendi peamenüü
            if (window.event.type == &quot;mouseover&quot;) { &#x2F;&#x2F;&#x27;&quot;sisse&quot;;
                if ((oSrc.parentElement.className == &quot;mi&quot; || oSrc.parentElement.className == &quot;si&quot;)) {
                    oSrc.parentElement.className = &quot;hi&quot;

                    &#x2F;&#x2F;div_ElemsMenu ja div_AttrsMenu &lt;tr&gt;: class = &#x27;mi&#x27;; id = &#x27;sFullPath&#x27;;
                    &#x2F;&#x2F;value: &#x27;qname|name|URI|IsElement|sKirjeldav&#x27;;

                    &#x2F;&#x2F; mySql ühiste korral: &quot;mySqlYhisedMs&quot;
                    sCurrElemId = oSrc.parentElement.id;
                    &#x2F;&#x2F; mySql ühiste korral: &#x27;${sqlSqnastik}|||1|${sqlSqnastikKirjeldav}&#x27;
                    tarr = oSrc.parentElement.value.split(&quot;|&quot;);

                    sAttrsMenu = &quot;&quot;;
                    if (tarr[1]) { &#x2F;&#x2F; &#x27;name&#x27;
                        oParticle = oSchRootElems.itemByQName(tarr[1], tarr[2]);
                        if ((oParticle.itemType == SOMITEM_ELEMENT)) {
                            if ((oParticle.type.itemType == SOMITEM_COMPLEXTYPE)) {
                                if ((oParticle.type.attributes.length &gt; 0)) {
                                    sAttId = sCurrElemId + &quot;&#x2F;@*&quot;;
                                    if ((sAttId == sSeldItemId)) {
                                        sAttClass = &quot;si&quot;;
                                    } else {
                                        sAttClass = &quot;mi&quot;;
                                    }
                                    sAttrsMenu = sAttrsMenu + &quot;&lt;tr class=&#x27;&quot; + sAttClass + &quot;&#x27; &quot; + &quot;id=&#x27;&quot; + sAttId + &quot;&#x27; &quot; + &quot;value=&#x27;@*|||1|ükskõik milline atribuut&#x27; &quot; + &quot;title=&#x27;ükskõik milline atribuut&#x27;&gt;&quot; + &quot;&lt;td colspan=&#x27;2&#x27;&gt;@*&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
                                    var atribuudid = oParticle.type.attributes;
                                    for (i = 0; i &lt; atribuudid.length; i++) {
                                        oAttr = atribuudid[i];
                                        if (!(oAttr.namespaceURI == &quot;&quot;)) {
                                            sAttrURI = oAttr.namespaceURI;
                                            sAttrQN = oXmlNsm.getPrefixes(sAttrURI)[0] + &quot;:&quot; + oAttr.name;
                                        } else {
                                            sAttrURI = &quot;&quot;;
                                            sAttrQN = oAttr.name;
                                        }
                                        sXsdXPath = &quot;.&#x2F;&#x2F;&quot; + NS_XS_PR + &quot;:attribute[@name=&#x27;&quot; + oAttr.name + &quot;&#x27;]&#x2F;&quot; + NS_XS_PR + &quot;:annotation&#x2F;&quot; + NS_XS_PR + &quot;:documentation[@xml:lang=&#x27;&quot; + sAppLang + &quot;&#x27;]&quot;;
                                        oXsdNode = oXsdDOM.documentElement.selectSingleNode(sXsdXPath);
                                        if (!(oXsdNode == null)) {
                                            sKirjeldav = oXsdNode.text;
                                        } else {
                                            sKirjeldav = sAttrQN;
                                        }
                                        sAttId = oSrc.parentElement.id + &quot;&#x2F;@&quot; + sAttrQN;
                                        if ((sAttId == sSeldItemId)) {
                                            sAttClass = &quot;si&quot;;
                                        } else {
                                            sAttClass = &quot;mi&quot;;
                                        }
                                        if ((oAttr.use == SCHEMAUSE_REQUIRED)) {
                                            sAttrReq = &quot; - [obl]&quot;;
                                        } else {
                                            sAttrReq = &quot;&quot;;
                                        }
                                        sAttrsMenu = sAttrsMenu + &quot;&lt;tr class=&#x27;&quot; + sAttClass + &quot;&#x27; &quot; + &quot;id=&#x27;&quot; + sAttId + &quot;&#x27; &quot; + &quot;value=&#x27;&quot; + sAttrQN + &quot;|&quot; + oAttr.name + &quot;|&quot; + sAttrURI + &quot;|1|&quot; + sKirjeldav + &quot;&#x27;&gt;&quot; + &quot;&lt;td&gt;&quot; + sKirjeldav + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;td&gt;@&quot; + sAttrQN + sAttrReq + &quot;&lt;&#x2F;td&gt;&quot; + &quot;&lt;&#x2F;tr&gt;&quot;;
                                    }
                                }
                            }
                        }
                    } else {
                        if (sCurrElemId == &quot;mySqlYhisedMs&quot;) {
                            var ridad = document.getElementById(&quot;divMySqlYhisedMs&quot;).getElementsByTagName(&quot;TR&quot;);
                            for (var ix = 0; ix &lt; ridad.length; ix++) {
                                if (ridad[ix].id == sSeldItemId) {
                                    ridad[ix].className = &quot;si&quot;;
                                } else {
                                    ridad[ix].className = &quot;mi&quot;;
                                }
                            }
                            sAttrsMenu = document.getElementById(&quot;divMySqlYhisedMs&quot;).innerHTML;
                        }
                    }
                    if (sAttrsMenu) {
                        div_AttrsMenu.innerHTML = &quot;&lt;table id=&#x27;tbl_AttrsMenu&#x27; width=&#x27;100%&#x27; border=&#x27;0&#x27; cellSpacing=&#x27;0&#x27;&gt;&quot; + sAttrsMenu + &quot;&lt;&#x2F;table&gt;&quot;;
                        div_AttrsMenu.style.pixelLeft = div_ElemsMenu.style.pixelLeft + div_ElemsMenu.offsetWidth;
                        div_AttrsMenu.style.pixelTop = div_ElemsMenu.style.pixelTop + oSrc.offsetTop - div_ElemsMenu.scrollTop;
                        div_AttrsMenu.style.display = &quot;&quot;;
                    } else {
                        div_AttrsMenu.style.display = &quot;none&quot;;
                        div_AttrsMenu.innerHTML = &quot;&quot;;
                    }
                }
            } else if ((window.event.type == &quot;mouseout&quot;)) { &#x2F;&#x2F;&#x27;&quot;välja&quot;;
                if (oSrc.parentElement.className == &quot;hi&quot;) {
                    if (sSeldAttrValue == &quot;&quot;) {
                        if (oSrc.parentElement.id == sSeldItemId) {
                            oSrc.parentElement.className = &quot;si&quot;;
                        } else {
                            oSrc.parentElement.className = &quot;mi&quot;;
                        }
                    } else {
                        if (oSrc.parentElement.id == sSeldItemId.substr(0, sSeldItemId.lastIndexOf(&quot;&#x2F;&quot;))) {
                            oSrc.parentElement.className = &quot;si&quot;;
                        } else {
                            oSrc.parentElement.className = &quot;mi&quot;;
                        }
                    }
                }
            }
        } else { &#x2F;&#x2F; otsitava elemendi peamenüü atribuutide kõrvalmenüü
            if (oSrc.parentElement.className == &quot;mi&quot;) {
                oSrc.parentElement.className = &quot;hi&quot;;
            } else if (oSrc.parentElement.className == &quot;hi&quot;) {
                oSrc.parentElement.className = &quot;mi&quot;;
&#x2F;&#x2F;            } else if (oSrc.parentElement.className == &quot;si&quot;) {
&#x2F;&#x2F;                oSrc.parentElement.className = &quot;mi&quot;;
            }
        }
    }
} &#x2F;&#x2F;SwitchElemsMenu


&#x2F;**
* 
*
* @method ClickElemsMenu
*&#x2F;
function ClickElemsMenu() {
    var oSrc, sCFP
    oSrc = window.event.srcElement;
    sCFP = div_ElemsMenu.componentFromPoint(window.event.clientX, window.event.clientY);
    if (sCFP.substr(0, 6) == &quot;scroll&quot;) {
        div_ElemsMenu.doScroll(sCFP);
    } else if (div_ElemsMenu.contains(oSrc) || div_AttrsMenu.contains(oSrc)) {
        if (div_AttrsMenu.contains(oSrc)) {
            SetSelectedInfo(oSrc.parentElement.id, oSrc.parentElement.value);
        } else {
            SetSelectedInfo(oSrc.parentElement.id, &quot;&quot;);
        }
        document.releaseCapture();
    } else {
        document.releaseCapture();
    }
} &#x2F;&#x2F;ClickElemsMenu


&#x2F;**
* 
*
* @method ShowElemEnums
*&#x2F;
function ShowElemEnums() {
    if (!(div_ElemEnumsMenu.innerHTML == &quot;&quot;)) {
        var oSrc, nX, nY, nVerGap;
        oSrc = window.event.srcElement;
        nVerGap = 4 &#x2F;&#x2F;oSrc border &quot;thin&quot; (2?) ja parent TD padding (2?);
        nX = window.event.clientX + 2 * oSrc.offsetWidth;
        nY = window.event.screenY - window.screenTop - window.event.offsetY - oSrc.offsetTop - nVerGap;
        div_ElemEnumsMenu.style.pixelLeft = nX;
        div_ElemEnumsMenu.style.pixelTop = nY;
        div_ElemEnumsMenu.style.display = &quot;&quot;;
        div_ElemEnumsMenu.style.cursor = &quot;default&quot;;
        div_ElemEnumsMenu.setCapture();
    }
} &#x2F;&#x2F;ShowElemEnums


&#x2F;**
* 
*
* @method ClickElemEnums
*&#x2F;
function ClickElemEnums() {
    var sCFP;
    sCFP = div_ElemEnumsMenu.componentFromPoint(window.event.clientX, window.event.clientY);
    if ((jsLeft(sCFP, 6) == &quot;scroll&quot;)) {
        div_ElemEnumsMenu.doScroll(sCFP);
    } else if ((sCFP == &quot;&quot;)) {
        inp_ElemText.value = window.event.srcElement.parentElement.value;
        document.releaseCapture();
    } else if ((sCFP == &quot;outside&quot;)) {
        document.releaseCapture();
    }
} &#x2F;&#x2F;ClickElemEnums


&#x2F;**
* 
*
* @method ShowAttribEnums
*&#x2F;
function ShowAttribEnums() {
    if (!(div_AttrEnumsMenu.innerHTML == &quot;&quot;)) {
        var oSrc, nX, nY, nVerGap;
        oSrc = window.event.srcElement;
        nVerGap = 4 &#x2F;&#x2F;oSrc border &quot;thin&quot; (2?) ja parent TD padding (2?);
        nX = window.event.clientX + 2 * oSrc.offsetWidth;
        nY = window.event.screenY - window.screenTop - window.event.offsetY - oSrc.offsetTop - nVerGap;
        div_AttrEnumsMenu.style.pixelLeft = nX;
        div_AttrEnumsMenu.style.pixelTop = nY;
        div_AttrEnumsMenu.style.display = &quot;&quot;;
        div_AttrEnumsMenu.style.cursor = &quot;default&quot;;
        div_AttrEnumsMenu.setCapture();
    }
} &#x2F;&#x2F;ShowAttribEnums


&#x2F;**
* 
*
* @method ClickAttribEnums
*&#x2F;
function ClickAttribEnums() {
    var sCFP;
    sCFP = div_AttrEnumsMenu.componentFromPoint(window.event.clientX, window.event.clientY);
    if ((jsLeft(sCFP, 6) == &quot;scroll&quot;)) {
        div_AttrEnumsMenu.doScroll(sCFP);
    } else if ((sCFP == &quot;&quot;)) {
        inp_AttrText.value = window.event.srcElement.parentElement.value;
        document.releaseCapture();
    } else if ((sCFP == &quot;outside&quot;)) {
        document.releaseCapture();
    }
} &#x2F;&#x2F;ClickAttribEnums


&#x2F;**
* 
*
* @method validateSR
*&#x2F;
function validateSR() {
    if ((oEditDOMRoot.hasChildNodes())) {
        if ((ValidateXML(oEditDOM, oXsdSc))) {
            alert(&quot;Artikli kontroll\n\nArtikkel &#x27;&quot; + sMSortVal + &quot;&#x27; on korras!&quot;);
        }
    }
} &#x2F;&#x2F;validateSR


&#x2F;**
* 
*
* @method SetIfrViewLeftAlign
*&#x2F;
function SetIfrViewLeftAlign() {
    ifrviewdiv.style.textAlign = &quot;left&quot;
} &#x2F;&#x2F;SetIfrViewLeftAlign

&#x2F;**
* 
*
* @method SetIfrViewCenterAlign
*&#x2F;
function SetIfrViewCenterAlign() {
    ifrviewdiv.style.textAlign = &quot;center&quot;
} &#x2F;&#x2F;SetIfrViewCenterAlign

&#x2F;**
* 
*
* @method SetIfrViewRightAlign
*&#x2F;
function SetIfrViewRightAlign() {
    ifrviewdiv.style.textAlign = &quot;right&quot;
} &#x2F;&#x2F;SetIfrViewRightAlign

&#x2F;**
* 
*
* @method SetIfrViewLeftAlign
*&#x2F;
function SetIfrViewLeftAlign() {
    ifrviewdiv.style.textAlign = &quot;justify&quot;
} &#x2F;&#x2F;SetIfrViewJustifyAlign


&#x2F;**
* 
*
* @method showArtXML
*&#x2F;
function showArtXML() {
    if ((window.event.ctrlLeft)) {
        var artXMLStr;
        artXMLStr = jsReplace(oEditDOM.xml, &#x27;\r\n&#x27;, &quot;¶&quot; + &#x27;\r\n&#x27;);
        artXMLStr = jsReplace(artXMLStr, &#x27;\t&#x27;, &quot;-&gt;&quot; + &#x27;\t&#x27;);
        alert(&quot;XML:\n\n&quot; + artXMLStr);
    }
} &#x2F;&#x2F;showArtXML


&#x2F;**
* 
*
* @method spnMsgDelete
*&#x2F;
function spnMsgDelete() {
    spn_msg.innerHTML = &#x27;&#x27;;
} &#x2F;&#x2F;spnMsgDelete


&#x2F;**
* 
*
* @method updMuudatused
* @param {String} op
* @param {String} tekst
*&#x2F;
function updMuudatused(op, tekst) {
    var n2idatav = tekst;
    if (n2idatav.length &gt; 30) {
        n2idatav = n2idatav.substr(0, 30) + &quot; {...}&quot;;
    }
    var muudetav;
    if (op == &quot;S&quot; || op == &quot;K&quot;) { &#x2F;&#x2F;&#x27;U ja R korral ei pruugi &#x27;selectedNode&#x27;-i olla
        if (selectedNode) {
            muudetav = selectedNode.nodeName;
            if (clType == &quot;at&quot;) {
                muudetav = &quot;@&quot; + muudetav;
            }
            muudetav = fatherNode.nodeName + &quot;&#x2F;&quot; + muudetav;
        } else {
            muudetav = &quot;Op.:&quot;;
        }
    }
    if (op == &quot;S&quot;) {
        artMuudatused = artMuudatused + &quot;|&quot; + muudetav + &quot; = &#x27;&quot; + n2idatav + &quot;&#x27;&quot;;
    } else if (op == &quot;K&quot;) {
        &#x2F;&#x2F;siin on miinusmärk, mitte sidekriips, ära uisa-päisa kustuta! :);
        artMuudatused = artMuudatused + &quot;|&quot; + muudetav + &quot;[&#x27;&quot; + n2idatav + &quot;&#x27;] − &quot;;
    } else if (op == &quot;U&quot; || op == &quot;R&quot;) {
        artMuudatused = artMuudatused + &quot;|&quot; + n2idatav;
    }
} &#x2F;&#x2F;updMuudatused



&#x2F;**
* 
*
* @method UndoArticle
*&#x2F;
function UndoArticle() {
    if ((urindex &gt; 0)) {
        urindex = urindex - 1;
        oEditDOMRoot.replaceChild(urfragment.childNodes(urindex).cloneNode(true), oEditDOMRoot.firstChild);
        oEditAll(&quot;ifrdiv&quot;).innerHTML = oEditDOM.transformNode(oXslEdit);
        updMuudatused(&quot;U&quot;, &quot;U&quot;);
        if ((oViewAll(&quot;_copyDiv&quot;) == null)) {
            if ((dic_desc == &quot;evs&quot;)) {
                var domCopy;
                domCopy = oEditDOM.cloneNode(true);
                TeisendaDOM(domCopy);
                oViewAll(&quot;ifrviewdiv&quot;).innerHTML = domCopy.transformNode(oXslView);
            } else {
                oViewAll(&quot;ifrviewdiv&quot;).innerHTML = oEditDOM.transformNode(oXslView);
            }
        }
    }
} &#x2F;&#x2F;UndoArticle


&#x2F;**
* 
*
* @method RedoArticle
*&#x2F;
function RedoArticle() {
    if ((urindex &lt; urlast)) {
        urindex = urindex + 1;
        oEditDOMRoot.replaceChild(urfragment.childNodes(urindex).cloneNode(true), oEditDOMRoot.firstChild);
        oEditAll(&quot;ifrdiv&quot;).innerHTML = oEditDOM.transformNode(oXslEdit);
        updMuudatused(&quot;R&quot;, &quot;R&quot;);
        if ((oViewAll(&quot;_copyDiv&quot;) == null)) {
            if ((dic_desc == &quot;evs&quot;)) {
                var domCopy;
                domCopy = oEditDOM.cloneNode(true);
                TeisendaDOM(domCopy);
                oViewAll(&quot;ifrviewdiv&quot;).innerHTML = domCopy.transformNode(oXslView);
            } else {
                oViewAll(&quot;ifrviewdiv&quot;).innerHTML = oEditDOM.transformNode(oXslView);
            }
        }
    }
} &#x2F;&#x2F;RedoArticle



&#x2F;**
* 
*
* @method volSelected
*&#x2F;
function volSelected() {
    if ((inp_AttrText.disabled == false)) {
        inp_AttrText.setActive();
        inp_AttrText.focus();
        inp_AttrText.select();
    } else {
        inp_ElemText.setActive();
        inp_ElemText.focus();
        inp_ElemText.select();
    }
} &#x2F;&#x2F;volSelected


var largePicId;

&#x2F;**
* 
*
* @method showLargePicture
*&#x2F;
function showLargePicture() {
    var oSrc
    oSrc = frame_Images.event.srcElement;
    if ((oSrc.tagName != &quot;IMG&quot;)) {
        return;
    }

    largePicId = oSrc.parentElement.id

    window.open(&quot;html&#x2F;show_pic_large.htm&quot;, &quot;_blank&quot;, &quot;channelmode=yes,directories=no,fullscreen=no,location=no,menubar=no,resizable=no,scrollbars=no,status=no,titlebar=no,toolbar=no&quot;)

} &#x2F;&#x2F;showLargePicture



&#x2F;**
* 
*
* @method fiOnClick
*&#x2F;
function fiOnClick() {

    var oSrc
    oSrc = frame_Images.event.srcElement;
    if ((oSrc.tagName != &quot;SPAN&quot;)) {
        return;
    }

    var currId;
    currId = oSrc.parentElement.id

    var pltElem, pfElem, sParms, newFile, smdArgs

    if ((oSrc.id == &quot;chPic&quot;)) {
        &#x2F;&#x2F;valitud ID, &#x27;od_: &#x27;011&#x27;;
        smdArgs = currId + JR + dic_desc + JR + sAppLang + JR + &#x27;blahh&#x27; + JR + sUsrName;
        sParms = window.showModalDialog(&quot;html&#x2F;setimage.htm&quot;, smdArgs, &quot;dialogHeight:576px;dialogWidth:1024px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:yes;unadorned:no&quot;);
        if (sParms == null) {
            return;
        }

        if ((sParms != currId)) {
            newFile = sParms + &quot;_med.jpg&quot;;
            pfElem = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + DICPR + &quot;:P&#x2F;&quot; + DICPR + &quot;:plt&#x2F;&quot; + DICPR + &quot;:pf[. = &#x27;&quot; + currId + &quot;_med.jpg&#x27;]&quot;);
            pfElem.text = newFile;
            fillImgFrame();
            oEditAll(&quot;ifrdiv&quot;).setAttribute(&quot;xmlChanged&quot;, 1); &#x2F;&#x2F;&#x27;2: teha edit ala uuendus (transformNode), 1: mitte;
        }
    } else if ((oSrc.id == &quot;rmvPic&quot;)) {
        pltElem = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + DICPR + &quot;:P&#x2F;&quot; + DICPR + &quot;:plt[&quot; + DICPR + &quot;:pf =&#x27;&quot; + currId + &quot;_med.jpg&#x27;]&quot;);
        pltElem.parentNode.removeChild(pltElem);
        fillImgFrame();
        oEditAll(&quot;ifrdiv&quot;).setAttribute(&quot;xmlChanged&quot;, 1); &#x2F;&#x2F;&#x27;2: teha edit ala uuendus (transformNode), 1: mitte;
    } else if ((oSrc.id == &quot;addPic&quot;)) {
        &#x2F;&#x2F;valitud ID;
        &#x2F;&#x2F;currId on praegu &quot;&quot;, &lt;p&gt; on span sisaldaja;
        smdArgs = currId + JR + dic_desc + JR + sAppLang + JR + &#x27;blahh&#x27; + JR + sUsrName;
        sParms = window.showModalDialog(&quot;html&#x2F;setimage.htm&quot;, smdArgs, &quot;dialogHeight:576px;dialogWidth:1024px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:yes;unadorned:no&quot;);
        if (sParms == null) {
            return;
        }

        if ((sParms != currId)) {
            newFile = sParms + &quot;_med.jpg&quot;;
            var pxis;
            pxis = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + DICPR + &quot;:P&quot;);
            pltElem = pxis.appendChild(GetAddElement(DICPR + &quot;:plt&quot;, DICURI));
            pfElem = pltElem.selectSingleNode(DICPR + &quot;:pf&quot;);
            pfElem.text = newFile;
            fillImgFrame();
            oEditAll(&quot;ifrdiv&quot;).setAttribute(&quot;xmlChanged&quot;, 1); &#x2F;&#x2F;&#x27;2: teha edit ala uuendus (transformNode), 1: mitte;
        }
    }

} &#x2F;&#x2F;fiOnClick


&#x2F;**
* 
*
* @method showSrToolsMenu
*&#x2F;
function showSrToolsMenu() {
    if (!(div_SrToolsMenu.innerHTML == &quot;&quot;)) {
        var oSrc, nX, nY, nVerGap;
        oSrc = window.event.srcElement;
        nVerGap = 4;  &#x2F;&#x2F;oSrc border &quot;thin&quot; (2?) ja parent TD padding (2?);
        nX = window.event.clientX + 2 * oSrc.offsetWidth;
        nY = window.event.screenY - window.screenTop - window.event.offsetY - oSrc.offsetTop - nVerGap;
        div_SrToolsMenu.style.pixelLeft = nX;
        div_SrToolsMenu.style.pixelTop = nY;
        div_SrToolsMenu.style.display = &quot;&quot;;
        div_SrToolsMenu.style.cursor = &quot;default&quot;;
        div_SrToolsMenu.setCapture();
    }
} &#x2F;&#x2F;showSrToolsMenu


&#x2F;**
* 
*
* @method ClickSrToolsMenu
*&#x2F;
function ClickSrToolsMenu() {
    var sCFP;
    var tarr;
    var retVal;
    var smdArgs;
    retVal = &quot;&quot;;
    sCFP = div_SrToolsMenu.componentFromPoint(window.event.clientX, window.event.clientY);
    if ((jsLeft(sCFP, 6) == &quot;scroll&quot;)) {
        div_SrToolsMenu.doScroll(sCFP);
    } else if ((sCFP == &quot;&quot;)) {
        &#x2F;&#x2F;tr value
        var parConfFile, parConfField, parText;
        if (window.event.srcElement.parentElement.value == &quot;idArtImport&quot;) {
            var sParms, impDicDesc, pathBase;
            if (oEditDOMRoot.hasChildNodes()) {
                smdArgs = &quot;Eesti-Vene sõnaraamat,evs;Eesti-X sõnastikupõhi,ex_;ÕS 2006,qs_&quot; + JR + &quot;imporditav sõnastik&quot;;
                sParms = window.showModalDialog(&quot;html&#x2F;mychoice.htm&quot;, smdArgs, &quot;dialogHeight:300px;dialogWidth:375px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:no;unadorned:no&quot;);
                if (sParms != null) {
                    tarr = sParms.split(JR);
                    impDicDesc = tarr[0];
                    pathBase = tarr[1];
                    smdArgs = impDicDesc + JR + sAppLang + JR + &#x27;blahh&#x27; + JR + sUsrName + JR + pathBase;
                    sParms = window.showModalDialog(&quot;html&#x2F;gethwds.htm&quot;, smdArgs, &quot;dialogHeight:608px;dialogWidth:1024px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:yes;unadorned:no&quot;);
                    if (sParms != null) {
                        &#x2F;&#x2F;impVolNr, impMs, g, pathBase;
                        tarr = sParms.split(JR);

                        sCmdId = &quot;ImportRead&quot;;
                        sQryInfo = tarr[1];

                        var sPrmDomXml, oPrmDom;
                        sPrmDomXml = &quot;&lt;prm&gt;&quot; + &quot;&lt;cmd&gt;&quot; + sCmdId + &quot;&lt;&#x2F;cmd&gt;&quot; + &quot;&lt;vol&gt;&quot; + impDicDesc + tarr[0] + &quot;&lt;&#x2F;vol&gt;&quot; + &quot;&lt;nfo&gt;&quot; + sQryInfo + &quot;&lt;&#x2F;nfo&gt;&quot; + &quot;&lt;axp&gt;&quot; + pathBase + &quot;&lt;&#x2F;axp&gt;&quot; + &quot;&lt;G&gt;&quot; + tarr[2] + &quot;&lt;&#x2F;G&gt;&quot; + &quot;&lt;&#x2F;prm&gt;&quot;;

                        oPrmDom = IDD(&quot;String&quot;, sPrmDomXml, false, false, null);
                        if ((oPrmDom.parseError.errorCode != 0)) {
                            ShowXMLParseError(oPrmDom);
                            return;
                        }
                        StartOperation(oPrmDom);
                    }
                }
            }
        } else if ((window.event.srcElement.parentElement.value == &quot;idOxfordDudenSisukord&quot;)) {
            showOxfordDudenSisukord();
        } else if ((window.event.srcElement.parentElement.value == &quot;idOxfordDudenIndeksEng&quot;)) {
            showOxfordDudenIndeksEng();
        } else if ((window.event.srcElement.parentElement.value == &quot;idOxfordDudenIndeksEst&quot;)) {
            showOxfordDudenIndeksEst();
        } else if ((window.event.srcElement.parentElement.value == &quot;idEELexSetup&quot;)) {
            showEELexSetup();
        } else if ((window.event.srcElement.parentElement.value == &quot;idBulkUpdate&quot;)) {
            var hulgiNimi;
            if (dic_desc == &quot;sp_&quot;) {
                &#x2F;&#x2F;                hulgiNimi = &quot;openFindReplace&quot;; &#x2F;&#x2F;&#x27;openFindReplace;
                hulgiNimi = &quot;hulgiParandused&quot;;
            } else {
                hulgiNimi = &quot;hulgiParandused&quot;;
            }
            window.open(&quot;html&#x2F;&quot; + hulgiNimi + &quot;.htm&quot;, &quot;_blank&quot;, &quot;width=1024,height=700,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=yes,titlebar=yes,toolbar=no&quot;);
        } else if ((window.event.srcElement.parentElement.value == &quot;idViewLogs&quot;)) {
            showDicLogs();
        } else if ((window.event.srcElement.parentElement.value == &quot;idVaateGen&quot;)) {
            ShowAdminView();
        } else if ((window.event.srcElement.parentElement.value == &quot;idSkeemiGen&quot;)) {
            ShowSkeemiGen();
        } else if ((window.event.srcElement.parentElement.value == &quot;idSrvXmlValidate&quot;)) {
            srvXmlValidate();
        } else if ((window.event.srcElement.parentElement.value == &quot;idGetXMLCopy&quot;)) {
            smdArgs = dic_desc + JR + sAppLang + JR + &#x27;&#x27; + JR + sUsrName + JR + sel_Vol.options(sel_Vol.selectedIndex).id;
            window.showModalDialog(&quot;html&#x2F;xmlCopy.htm&quot;, smdArgs, &quot;dialogHeight:152px;dialogWidth:384px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:yes;unadorned:no&quot;);
        } else if ((window.event.srcElement.parentElement.value == &quot;idGetXMLImport&quot;)) {
            smdArgs = dic_desc + JR + sAppLang + JR + &#x27;&#x27; + JR + sUsrName + JR + sel_Vol.options(sel_Vol.selectedIndex).id;
            window.showModalDialog(&quot;html&#x2F;xmlImport.htm&quot;, smdArgs, &quot;dialogHeight:152px;dialogWidth:384px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:yes;unadorned:no&quot;);
        } else if ((window.event.srcElement.parentElement.value == &quot;idMsSarnased&quot;)) {
            showMsSarnased();
        } else if ((window.event.srcElement.parentElement.value == &quot;idTyhjadViited&quot;)) {
            showTyhjadViited();
        } else if (window.event.srcElement.parentElement.value == &quot;morfonolHulgi&quot;) {
        } else if ((window.event.srcElement.parentElement.value == &quot;idExsaManPtd&quot;)) {
            parConfFile = window.event.srcElement.parentElement.getAttribute(&quot;confFile&quot;);
            parConfField = window.event.srcElement.parentElement.id;
            parText = window.event.srcElement.innerText;
            &#x2F;&#x2F;parameetrid: sõn. kood [0]; kasutaja [1]; töökeel [2]; op. nimetus [3]; faili nimi [4]; välja nimi [5];
            smdArgs = dic_desc + JR + sUsrName + JR + sAppLang + JR + parText + JR + parConfFile + JR + parConfField;
            retVal = window.showModalDialog(&quot;html&#x2F;getList.htm&quot;, smdArgs, &quot;dialogHeight:608px;dialogWidth:1024px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:yes;unadorned:no&quot;);
            if (retVal == &quot;updated&quot;) {
                document.execCommand(&quot;Refresh&quot;, false);
            } &#x2F;&#x2F;if((retVal == &quot;updated&quot;)){
        } else if ((window.event.srcElement.parentElement.value == &quot;idExsaManUsr&quot;)) {
            parConfFile = window.event.srcElement.parentElement.getAttribute(&quot;confFile&quot;);
            parConfField = window.event.srcElement.parentElement.id;
            parText = window.event.srcElement.innerText;
            &#x2F;&#x2F;parameetrid: sõn. kood [0]; kasutaja [1]; töökeel [2]; op. nimetus [3]; faili nimi [4]; välja nimi [5];
            smdArgs = dic_desc + JR + sUsrName + JR + sAppLang + JR + parText + JR + parConfFile + JR + parConfField;
            retVal = window.showModalDialog(&quot;html&#x2F;getList.htm&quot;, smdArgs, &quot;dialogHeight:608px;dialogWidth:1024px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:yes;unadorned:no&quot;);
            if (retVal == &quot;updated&quot;) {
                document.execCommand(&quot;Refresh&quot;, false);
            } &#x2F;&#x2F;if((retVal == &quot;updated&quot;)){
        } else if ((window.event.srcElement.parentElement.value == &quot;idExsaRemoveDict&quot;)) {
            kustutaSqnastik();
        } else if ((jsLeft(window.event.srcElement.parentElement.value, 5) == &quot;delim&quot;)) {
            return;
        } else if ((jsRight(window.event.srcElement.parentElement.id, 5) == &quot;_tyyp&quot;)) {

            &#x2F;&#x2F;par: 0 ... 4-xsd faili nimi, 5-tüübi nimi, 6-kasutaja

            &#x2F;&#x2F;        sSrToolsMenu = sSrToolsMenu +  &#x2F;&#x2F;            &quot;&lt;tr class=&#x27;mi&#x27; id=&#x27;k_tyyp&#x27; value=&#x27;xsd&#x2F;ety&#x2F;ety_tyybid.xsd&#x27;&gt;&quot; +  &#x2F;&#x2F;                 &quot;&lt;td&gt;Keel&lt;&#x2F;td&gt;&quot; +  &#x2F;&#x2F;            &quot;&lt;&#x2F;tr&gt;&quot;

            smdArgs = dic_desc + JR + sAppLang + JR + &#x27;blahh&#x27; + JR + window.event.srcElement.innerText + JR + window.event.srcElement.parentElement.value + JR + window.event.srcElement.parentElement.id + JR + sUsrName;
            retVal = window.showModalDialog(&quot;html&#x2F;getsimpletype.htm&quot;, smdArgs, &quot;dialogHeight:608px;dialogWidth:1024px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:yes;unadorned:no&quot;);
            if (retVal == &quot;updated&quot;) {

                var sXSDFile = &quot;xsd&#x2F;schema_&quot; + dic_desc + &quot;.xsd&quot;;
                oXsdDOM = IDD(&quot;File&quot;, sXSDFile, false, false, null);
                oXsdDOM.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
                oXsdDOM.setProperty(&quot;SelectionNamespaces&quot;, jsTrim(sXsdNsList));

                oXsdSc = new ActiveXObject(&quot;Msxml2.XMLSchemaCache.6.0&quot;);
                oXsdSc.validateOnLoad = true;
                oXsdSc.add(DICURI, sXSDFile);

                oEditDOM = IDD(&quot;String&quot;, oEditDOM.xml, false, false, oXsdSc);
                oEditDOM.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
                oEditDOM.setProperty(&quot;SelectionNamespaces&quot;, sXmlNsList);
                oEditDOMRoot = oEditDOM.documentElement;

                oXmlSc = oEditDOM.namespaces;

                oSchRootElems = oXmlSc.getSchema(DICURI).elements;
                oSchRootAttrs = oXmlSc.getSchema(DICURI).attributes;

                if (window.event.srcElement.parentElement.id == &#x27;xmllang_tyyp&#x27;) {
                    var locnKeys = (new VBArray(impSchemaLocations.Keys())).toArray();
                    for (var itm in locnKeys) {
                        if ((jsLeft(impSchemaLocations.Item(locnKeys[itm]), 4) == dic_desc + &quot;&#x2F;&quot;)) { &#x2F;&#x2F;&#x27;asub tüüpide DOM-is;
                            updKeelteValik(impSchemaLocations.Item(locnKeys[itm]));
                        }
                    }
                }

                if ((img_ElemEnumsMenu.disabled == false)) {
                    updElemEnumsMenu();
                }
                if ((img_AttrEnumsMenu.disabled == false)) {
                    updAttrEnumsMenu();
                }

            } &#x2F;&#x2F;if((retVal == &quot;updated&quot;)){
        }

        document.releaseCapture();

    } else if ((sCFP == &quot;outside&quot;)) {
        document.releaseCapture();
    }
} &#x2F;&#x2F;ClickSrToolsMenu


&#x2F;**
* 
*
* @method kustutaSqnastik
*&#x2F;
function kustutaSqnastik() {

    var xh, creator;
    var oRespDom, sta
    xh = exCGISync(&quot;tools.cgi&quot;, &quot;exsaGetField&quot; + JR + dic_desc + JR + sUsrName + JR + &quot;&quot; + JR + &quot;items&#x2F;item[@code = &#x27;&quot; + dic_desc + &quot;&#x27;]&#x2F;creator&quot;);
    if ((xh.statusText == &quot;OK&quot;)) {
        oRespDom = xh.responseXML &#x2F;&#x2F;responseXML: TypeName = DomDocument;
        sta = oRespDom.selectSingleNode(&quot;rsp&#x2F;sta&quot;).text;
        if ((sta == &quot;Success&quot;)) {
            creator = oRespDom.selectSingleNode(&quot;rsp&#x2F;answer&quot;).text;
        } else {
            alert(&quot;Väärtuste leidmine ei õnnestunud!&quot;, jsvbCritical, document.title);
            return;
        }
    } else {
        alert(xh.status + &quot;: &quot; + xh.statusText + &#x27;\r\n\r\n&#x27; + xh.responseText, jsvbCritical);
        return;
    }

    if ((creator != sUsrName)) {
        alert(&quot;Sõnastikku saab kustutada ainult selle loonud kasutaja!&quot;, vbExclamation, &quot;Sõnastiku kustutamine&quot;);
        return;
    }

    var nRetBtn;
    nRetBtn = confirm(&quot;Kas soovid kustutada terve sõnastiku&quot; + &#x27;\r\n&#x27; + &quot;&#x27;&quot; + sDicName + &quot;&#x27;?&quot;);
    if ((nRetBtn != 6)) {
        return;
    }

    xh = exCGISync(&quot;tools.cgi&quot;, &quot;exsaKustutaSqnastik&quot; + JR + dic_desc + JR + sUsrName);
    if ((xh.statusText == &quot;OK&quot;)) {
        oRespDom = xh.responseXML &#x2F;&#x2F;responseXML: TypeName = DomDocument;
        sta = oRespDom.selectSingleNode(&quot;rsp&#x2F;sta&quot;).text;
        if ((sta == &quot;Success&quot;)) {
            alert(&quot;Sõnastik &#x27;&quot; + sDicName + &quot;&#x27; kustutatud.&quot;, vbInformation, &quot;Sõnastiku kustutamine&quot;);
            window.navigate(&quot;http:&#x2F;&#x2F;exsa.eki.ee&#x2F;&quot;);
        } else {
            alert(&quot;Sõnastiku kustutamine ei õnnestunud!&quot;, jsvbCritical, document.title);
            return;
        }
    } else {
        alert(xh.status + &quot;: &quot; + xh.statusText + &#x27;\r\n\r\n&#x27; + xh.responseText, jsvbCritical);
        return;
    }

} &#x2F;&#x2F;kustutaSqnastik


&#x2F;**
* 
*
* @method showArtToolsMenu
*&#x2F;
function showArtToolsMenu() {
    &#x2F;&#x2F;div_ArtToolsMenu - art.cgi-s defineeritud,
    if (!(div_ArtToolsMenu.innerHTML == &quot;&quot;)) {
        var oSrc, nX, nY, nVerGap;
        oSrc = window.event.srcElement;
        nVerGap = 4 &#x2F;&#x2F;oSrc border &quot;thin&quot; (2?) ja parent TD padding (2?);
        nX = window.event.clientX + 2 * oSrc.offsetWidth;
        nY = window.event.screenY - window.screenTop - window.event.offsetY - oSrc.offsetTop - nVerGap;
        div_ArtToolsMenu.style.pixelLeft = nX;
        div_ArtToolsMenu.style.pixelTop = nY;
        div_ArtToolsMenu.style.display = &quot;&quot;;
        div_ArtToolsMenu.style.cursor = &quot;default&quot;;
        div_ArtToolsMenu.setCapture();
    }
} &#x2F;&#x2F;showArtToolsMenu


&#x2F;**
* 
*
* @method ClickArtToolsMenu
*&#x2F;
function ClickArtToolsMenu() {
    var sCFP;
    sCFP = div_ArtToolsMenu.componentFromPoint(window.event.clientX, window.event.clientY);
    if ((jsLeft(sCFP, 6) == &quot;scroll&quot;)) {
        div_ArtToolsMenu.doScroll(sCFP);
    } else if ((sCFP == &quot;&quot;)) {
        &#x2F;&#x2F;tr value
        if ((window.event.srcElement.parentElement.value == &quot;idSignEntry&quot;)) { &#x2F;&#x2F;&#x27;peatoimetaja märge;
            signEntry();
        } else if ((window.event.srcElement.parentElement.value == &quot;idRemSignEntry&quot;)) { &#x2F;&#x2F;&#x27;eemalda &#x27;peatoimetaja märge;
            remSignEntry();
        } else if ((window.event.srcElement.parentElement.value == &quot;idKoostamiseLopp&quot;)) { &#x2F;&#x2F;&#x27;koostamise lõpp;
            koostamiseLopp();
        } else if ((window.event.srcElement.parentElement.value == &quot;idRemKoostamiseLopp&quot;)) { &#x2F;&#x2F;&#x27;eemalda &#x27;koostamise lõpp;
            remKoostamiseLopp();
        } else if ((window.event.srcElement.parentElement.value == &quot;idAddEmptyEquiv&quot;)) { &#x2F;&#x2F;&#x27;Oxford-Duden: lisa tühjad vasted;
            addEmptyEquiv();
        } else if ((window.event.srcElement.parentElement.value == &quot;idImportFromWord&quot;)) { &#x2F;&#x2F;&#x27;Oxford-Duden: import Word-ist;
            importFromWord();
        } else if ((window.event.srcElement.parentElement.value == &quot;idCompleteEntry&quot;)) { &#x2F;&#x2F;&#x27;toimetamise lõpp;
            completeEntry();
        } else if ((window.event.srcElement.parentElement.value == &quot;idRemCompleteEntry&quot;)) { &#x2F;&#x2F;&#x27;eemalda &#x27;toimetamise lõpp;
            remCompleteEntry();
        } else if ((window.event.srcElement.parentElement.value == &quot;idCompleteEntryLatvian&quot;)) { &#x2F;&#x2F;&#x27;toimetamise lõpp;
            completeEntryLatvian();
        } else if ((window.event.srcElement.parentElement.value == &quot;idRemCompleteEntryLatvian&quot;)) { &#x2F;&#x2F;&#x27;eemalda &#x27;toimetamise lõpp;
            remCompleteEntryLatvian();
        } else if ((window.event.srcElement.parentElement.value == &quot;idCompleteEntryEstonian&quot;)) { &#x2F;&#x2F;&#x27;toimetamise lõpp;
            completeEntryEstonian();
        } else if ((window.event.srcElement.parentElement.value == &quot;idRemCompleteEntryEstonian&quot;)) { &#x2F;&#x2F;&#x27;eemalda &#x27;toimetamise lõpp;
            remCompleteEntryEstonian();
        } else if ((window.event.srcElement.parentElement.value == &quot;idDictionaryEntry&quot;)) { &#x2F;&#x2F;&#x27;Haridus;
            artikliStaatus(&quot;HS&quot;);
        } else if ((window.event.srcElement.parentElement.value == &quot;idDatabaseEntry&quot;)) { &#x2F;&#x2F;&#x27;Haridus;
            artikliStaatus(&quot;AB&quot;);
        } else if ((window.event.srcElement.parentElement.value == &quot;idDictionaryEntryUkr&quot;)) {
            artikliStaatus(&quot;UKR&quot;);
        } else if ((window.event.srcElement.parentElement.value == &quot;idDatabaseEntryUkr&quot;)) {
            artikliStaatus(&quot;AB&quot;);
            &#x2F;&#x2F;--------------------------------------------------------------------------------
        } else if ((window.event.srcElement.parentElement.value == &quot;idDictionaryEntryVsl&quot;)) {
            artikliStaatus(&quot;VL&quot;);
        } else if ((window.event.srcElement.parentElement.value == &quot;idDatabaseEntryVsl&quot;)) {
            artikliStaatus(&quot;AB&quot;);
            &#x2F;&#x2F;--------------------------------------------------------------------------------
        } else if ((window.event.srcElement.parentElement.value == &quot;idDictionaryEntryFin&quot;)) {
            artikliStaatus(&quot;FIN&quot;);
        } else if ((window.event.srcElement.parentElement.value == &quot;idDatabaseEntryFin&quot;)) {
            artikliStaatus(&quot;AB&quot;);
            &#x2F;&#x2F;--------------------------------------------------------------------------------
        } else if ((window.event.srcElement.parentElement.value == &quot;idDictionaryEntrySS1&quot;)) {
            artikliStaatus(&quot;SS1&quot;);
        } else if ((window.event.srcElement.parentElement.value == &quot;idDatabaseEntrySS1&quot;)) {
            artikliStaatus(&quot;AB&quot;);
            &#x2F;&#x2F;--------------------------------------------------------------------------------
        } else if ((window.event.srcElement.parentElement.value == &quot;idDictionaryEntryKNR&quot;)) {
            artikliStaatus(&quot;EKNR&quot;);
        } else if ((window.event.srcElement.parentElement.value == &quot;idDatabaseEntryKNR&quot;)) {
            artikliStaatus(&quot;AB&quot;);
            &#x2F;&#x2F;--------------------------------------------------------------------------------
        } else if ((window.event.srcElement.parentElement.value == &quot;idDictionaryEntryPSV&quot;)) {
            artikliStaatus(&quot;PSV&quot;);
        } else if ((window.event.srcElement.parentElement.value == &quot;idDatabaseEntryPSV&quot;)) {
            artikliStaatus(&quot;AB&quot;);
            &#x2F;&#x2F;--------------------------------------------------------------------------------
        } else if ((window.event.srcElement.parentElement.value == &quot;idDictionaryEntryMAR&quot;)) {
            artikliStaatus(&quot;MAR&quot;);
        } else if ((window.event.srcElement.parentElement.value == &quot;idDatabaseEntryMAR&quot;)) {
            artikliStaatus(&quot;AB&quot;);
            &#x2F;&#x2F;--------------------------------------------------------------------------------
        } else if ((window.event.srcElement.parentElement.value == &quot;idDictionaryEntryEX&quot;)) {
            ABartikkelYesNo();
            &#x2F;&#x2F;--------------------------------------------------------------------------------
        } else if ((window.event.srcElement.parentElement.value == &quot;idMainEntry&quot;)) { &#x2F;&#x2F;&#x27;EKSS;
            assignMainEntry();
        } else if ((window.event.srcElement.parentElement.value == &quot;idSubEntry&quot;)) { &#x2F;&#x2F;&#x27;EKSS;
            assignSubEntry();
        } else if (window.event.srcElement.parentElement.value == &quot;idMoveToVolume&quot;) { &#x2F;&#x2F;&#x27;PSV &quot;vii AB köitesse&quot;;
            moveToVolume();
        }

        document.releaseCapture();
    } else if ((sCFP == &quot;outside&quot;)) {
        document.releaseCapture();
    }
} &#x2F;&#x2F;ClickArtToolsMenu



&#x2F;**
* 
*
* @method moveToVolume
*&#x2F;
function moveToVolume() {

    var sLinkVols = &#x27;&#x27;;
    var volId = &#x27;&#x27;;
    for (var ix = 0; ix &lt; sel_Vol.options.length; ix++) {
        var opt = sel_Vol.options[ix];
        if (opt.id == sAllVolId) {
            break;
        }
        sLinkVols = sLinkVols + &quot;&lt;option id=&#x27;&quot; + opt.id + &quot;&#x27;&quot;;
        if (opt.selected) {
            sLinkVols = sLinkVols + &quot; selected&quot;;
            volId = opt.id;
        }
        sLinkVols = sLinkVols + &quot;&gt;&quot; + opt.innerText + &quot;&lt;&#x2F;option&gt;&quot;;
    }

    var smdArgs = new Array(dic_desc, sUsrName, sAppLang, sLinkVols);
    var retVal = window.showModalDialog(&quot;html&#x2F;moveToVolume.htm&quot;, smdArgs, &quot;dialogHeight:128px;dialogWidth:384px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:no;unadorned:no&quot;);

    if (!retVal) {
        return;
    }
    if (volId == retVal) {
        return;
    }

    var vnr = retVal.substr(3, 1);
    var oConfigDOM = IDD(&quot;File&quot;, &quot;shsconfig_&quot; + dic_desc + &quot;.xml&quot;, false, false, null);
    var vahemik = oConfigDOM.documentElement.selectSingleNode(&quot;vols&#x2F;vol[@nr = &#x27;&quot; + vnr + &quot;&#x27;]&quot;).text;
    &#x2F;&#x2F; PSV teine köide &#x27;AB&#x27; artiklid: &lt;vol nr=&quot;2&quot;&gt;AB: A - Y&lt;&#x2F;vol&gt;
    if (vahemik.indexOf(&quot; - &quot;) &gt; -1) {
        vahemik = jsTrim(vahemik.substr(vahemik.indexOf(&quot;:&quot;) + 1));
        otsad = vahemik.split(&quot; - &quot;);
        var v6rreldav = sMSortVal;
        var puhas = RemoveSymbols(v6rreldav, &quot;&quot;); &#x2F;&#x2F;&#x27;2. parm VÕIB OLLA;
        if (!((jsStrComp(jsLeft(puhas, otsad[0].length), otsad[0], 1) &gt;= 0) &amp;&amp; (jsStrComp(jsLeft(puhas, otsad[1].length), otsad[1], 1) &lt;= 0))) {
            alert(CHK_VOL_ERR, jsvbCritical, CHK_VOL);
            return;
        }
    }

    sCmdId = &quot;ClientDelete&quot;;
    sQryInfo = sMSortVal;

    var destVol = retVal;
    var sqlVol = sFromVolume;

    var artGuid = oEditDOMRoot.selectSingleNode(DICPR + &quot;:A&#x2F;&quot; + qn_guid).text;
    var qM = &quot;MySql&quot;;
    var seldQn = qn_ms;  &#x2F;&#x2F;pärast otsitakse nn homonüümseid märksõnu, st millised veel sama märksõnaga on;
    var srchPtrn = &quot;^&quot; + sMSortVal + &quot;$&quot;;
    var homonyymsed = &#x27;&#x27;;
    var art_xpath = &#x27;&#x27;, elm_xpath = &#x27;&#x27;, sql = &#x27;&#x27;, sPrmDomXml, oPrmDom;
    sPrmDomXml = &quot;&lt;prm&gt;&quot; +
                        &quot;&lt;cmd&gt;&quot; + sCmdId + &quot;&lt;&#x2F;cmd&gt;&quot; +
                        &quot;&lt;vol&gt;&quot; + sFromVolume + &quot;&lt;&#x2F;vol&gt;&quot; +
                        &quot;&lt;nfo&gt;&quot; + sQryInfo + &quot;&lt;&#x2F;nfo&gt;&quot; +
                        &quot;&lt;axp&gt;&quot; + art_xpath + &quot;&lt;&#x2F;axp&gt;&quot; +
                        &quot;&lt;exp&gt;&quot; + elm_xpath + &quot;&lt;&#x2F;exp&gt;&quot; +
                        &quot;&lt;wC&gt;0&lt;&#x2F;wC&gt;&quot; +
                        &quot;&lt;wS&gt;1&lt;&#x2F;wS&gt;&quot; +
                        &quot;&lt;fSrP&gt;&quot; + srchPtrn + &quot;&lt;&#x2F;fSrP&gt;&quot; +
                        &quot;&lt;G&gt;&quot; + artGuid + &quot;&lt;&#x2F;G&gt;&quot; +
                        &quot;&lt;sql&gt;&quot; + sql + &quot;&lt;&#x2F;sql&gt;&quot; +
                        &quot;&lt;dV&gt;&quot; + destVol + &quot;&lt;&#x2F;dV&gt;&quot; +
                        &quot;&lt;qn&gt;&quot; + seldQn + &quot;&lt;&#x2F;qn&gt;&quot; +
                        &quot;&lt;qM&gt;&quot; + qM + &quot;&lt;&#x2F;qM&gt;&quot; +
                    &quot;&lt;&#x2F;prm&gt;&quot;;

    oPrmDom = IDD(&quot;String&quot;, sPrmDomXml, false, false, null);
    if (oPrmDom.parseError.errorCode != 0) {
        ShowXMLParseError(oPrmDom);
        return;
    }

    StartOperation(oPrmDom);

} &#x2F;&#x2F;moveToVolume


&#x2F;**
* 
*
* @method HandleViewSelectionChange
*&#x2F;
function HandleViewSelectionChange() {
    if (!(oViewAll(&quot;_copyDiv&quot;) == null)) {
        var rng;
        rng = document.selection.createRange();
        sTextToCopy = rng.text;
    }
} &#x2F;&#x2F;HandleViewSelectionChange


&#x2F;**
* 
*
* @method checkRpmUpdates
* @returns {Boolean} 
*&#x2F;
function checkRpmUpdates() {
    var checkRpmUpdates = true;
    if ((useMorfo)) {
        var updateRpmWeb, rpmWebVersion, curMorfVer;  &#x2F;&#x2F;rpm - reeglipõhine morfoloogia;
        var oConfigDOM, cfgElem;
        oConfigDOM = IDD(&quot;File&quot;, &quot;shsConfig.xml&quot;, false, false, null);
        &#x2F;&#x2F;&quot;4.1.8&quot; oli 24. aprill 2009;
        &#x2F;&#x2F;&quot;4.1.9&quot; oli 10. oktoober 2010;
        cfgElem = oConfigDOM.documentElement.selectSingleNode(&quot;rpmWebVersion&quot;);
        if (!(cfgElem == null)) {
            rpmWebVersion = cfgElem.text;
        } else {
            rpmWebVersion = &quot;&quot;;
            return false; &#x2F;&#x2F; kas jätkata?
        }
        try {
            updateRpmWeb = eelexSWCtl.needsRpmUpdate(rpmWebVersion);
            curMorfVer = eelexSWCtl.propMorfVer;
            if ((updateRpmWeb)) {
                var infoStr, smdArgs;
                infoStr = &quot;Lokaalse morfoloogia versioon on &#x27;&quot; + curMorfVer + &quot;&#x27;,&lt;br &#x2F;&gt;serveris on olemas uuem versioon: &#x27;&quot; + rpmWebVersion + &quot;&#x27;.&quot;;
                smdArgs = &quot;..&#x2F;install&#x2F;rpmWebMSI.msi&quot; + JR + infoStr;
                window.showModalDialog(&quot;html&#x2F;myinstall.htm&quot;, smdArgs, &quot;dialogHeight:300px;dialogWidth:375px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:no;unadorned:no&quot;);
                checkRpmUpdates = false &#x2F;&#x2F;kas jätkata?;
            }
        }
        catch (e) {
            checkRpmUpdates = false &#x2F;&#x2F;kas jätkata?;
        }
    }
    return checkRpmUpdates;
} &#x2F;&#x2F;checkRpmUpdates


&#x2F;**
* 
*
* @method showEELexSetup
*&#x2F;
function showEELexSetup() {
    if (!checkRpmUpdates()) {
        return;
    }
    var retVal, smdArgs;
    smdArgs = dic_desc + JR + sAppLang + JR + &#x27;trääs&#x27; + JR + sUsrName + JR + &#x27;trääs&#x27;;
    retVal = window.showModalDialog(&quot;html&#x2F;eelex_setup.htm&quot;, smdArgs, &quot;dialogHeight:480px;dialogWidth:640px;center:yes;edge:sunken;help:no;resizable:yes;scroll:yes;status:no;unadorned:no&quot;);
    if (retVal) {
        var tarr;
        tarr = retVal.split(JR);
        switch (tarr[0]) {
            case &quot;colorsFonts&quot;:
                &#x2F;&#x2F;retVal: colorsFonts
                setFontsSizes();
                window.status = &quot;Fontide sätted edukalt salvestatud!&quot;;
                break;
            case &quot;morf_ana&quot;:
                &#x2F;&#x2F;retVal: morf_ana JR tul JR ls JR sqn JR vkkuju;
                ma_tul = parseInt(tarr[1]);
                ma_ls = parseInt(tarr[2]);
                ma_sqn = parseInt(tarr[3]);
                ma_vkkuju = parseInt(tarr[4]);
                window.status = MORF_ANA_SUCCESS;
                break;
            case &quot;morf_syn&quot;:
                &#x2F;&#x2F;retVal: morf_syn JR valtega JR vkkuju;
                ms_valtega = parseInt(tarr[1]);
                &#x2F;&#x2F;sünteesi korral on parameeter teise jrk-ga, shsconfig-is on mõlemad analüüsi moodi;
                ms_vkkuju = (parseInt(tarr[2]) + 2) % 3;
                window.status = MORF_SYN_SUCCESS;
                break;
            case &quot;eelex_setup&quot;:
                &#x2F;&#x2F;retVal: eelex_setup JR setKeyboard JR doSpellCheck JR useMorfo;
                setKeyboard = jsStringToBoolean(tarr[1]);
                doSpellCheck = jsStringToBoolean(tarr[2]);
                useMorfo = jsStringToBoolean(tarr[3]);
                window.status = EELEX_SETUP_SUCCESS;
                break;
            case &quot;morfoloogia&#x2F;syntees&quot;:
                &#x2F;&#x2F;retVal: &quot;morfoloogia&#x2F;syntees&quot;
                window.status = &quot;&#x27;morfoloogia&#x2F;syntees&#x27; sätted edukalt salvestatud!&quot;; ;
                break;
        }
    }
} &#x2F;&#x2F;showEELexSetup;


&#x2F;**
* 
*
* @method setFontsSizes
*&#x2F;
function setFontsSizes() {
    var obj, tekst, cfgElem;
    var dicConfDom = IDD(&quot;File&quot;, &quot;shsconfig_&quot; + dic_desc + &quot;.xml&quot;, false, false, null);
    cfgElem = dicConfDom.documentElement.selectSingleNode(&quot;colorsFonts&#x2F;editArea&#x2F;editFont&quot;);
    if (cfgElem) {
        tekst = cfgElem.text;
        textEditFont = tekst;
        if (tekst == &#x27;&#x27;) {
            tekst = &quot;Times New Roman&quot;;
        }
        obj = document.getElementById(&quot;ifrdiv&quot;);
        obj.style.fontFamily = tekst;
    }
    cfgElem = dicConfDom.documentElement.selectSingleNode(&quot;colorsFonts&#x2F;viewArea&#x2F;viewFont&quot;);
    if (cfgElem) {
        tekst = cfgElem.text;
        if (tekst == &#x27;&#x27;) {
            tekst = &quot;Times New Roman&quot;;
        }
        obj = document.getElementById(&quot;ifrviewdiv&quot;);
        obj.style.fontFamily = tekst;
    }
    cfgElem = dicConfDom.documentElement.selectSingleNode(&quot;colorsFonts&#x2F;editArea&#x2F;editFontSize&quot;);
    if (cfgElem) {
        tekst = cfgElem.text;
        if (tekst != &#x27;&#x27;) {
            tekst += &quot;pt&quot;;
        }
        obj = document.getElementById(&quot;ifrdiv&quot;);
        obj.style.fontSize = tekst;
    }
    cfgElem = dicConfDom.documentElement.selectSingleNode(&quot;colorsFonts&#x2F;viewArea&#x2F;viewFontSize&quot;);
    if (cfgElem) {
        tekst = cfgElem.text;
        if (tekst != &#x27;&#x27;) {
            tekst += &quot;pt&quot;;
        }
        obj = document.getElementById(&quot;ifrviewdiv&quot;);
        obj.style.fontSize = tekst;
    }
} &#x2F;&#x2F; setFontsSizes


&#x2F;**
* 
*
* @method updKeelteValik
* @param {String} schLocation
*&#x2F;
function updKeelteValik(schLocation) {
    var tyybidDom = IDD(&quot;File&quot;, &quot;xsd&#x2F;&quot; + schLocation, false, false, null);
    tyybidDom.setProperty(&quot;SelectionLanguage&quot;, &quot;XPath&quot;);
    tyybidDom.setProperty(&quot;SelectionNamespaces&quot;, jsTrim(sXsdNsList));

    var valikuid = 0, xmlLangType, xmlLangEnums;
    var i, keel, enKeel, nativeKeel, appLangKeel;

    xmlLangType = tyybidDom.documentElement.selectSingleNode(NS_XS_PR + &quot;:simpleType[@name = &#x27;xmllang_tyyp&#x27;]&quot;);
    if (xmlLangType != null) {
        xmlLangEnums = xmlLangType.selectNodes(NS_XS_PR + &quot;:restriction&#x2F;&quot; + NS_XS_PR + &quot;:enumeration&quot;);
        valikuid = xmlLangEnums.length;
        keelteValik = new Array();
    }
    if (valikuid &gt; 0) {
        for (i = 0; i &lt; valikuid; i++) {
            keel = xmlLangEnums[i];
            var sXsdXPath = NS_XS_PR + &quot;:annotation&#x2F;&quot; + NS_XS_PR + &quot;:documentation[@xml:lang=&#x27;&quot; + sAppLang + &quot;&#x27;]&quot;;
            var oXsdNode = keel.selectSingleNode(sXsdXPath);
            if (oXsdNode != null)
                appLangKeel = oXsdNode.text;
            else
                appLangKeel = &#x27;&#x27;;
            keelteValik.push(keel.getAttribute(&quot;value&quot;) + JR + appLangKeel);
        }
    }
    else {
        if (keelteValik.length == 0) {
            var keeledDom, keeled;
            keeledDom = IDD(&quot;File&quot;, &quot;iso639_1.xml&quot;, false, false, null);
            if (appDesc == &quot;EXSA&quot;) { &#x2F;&#x2F;&#x27;EXSA
                keeled = keeledDom.documentElement.selectNodes(&quot;record[not(@technical = &#x27;1&#x27;)]&quot;);
            } else {
                keeled = keeledDom.documentElement.selectNodes(&quot;record&quot;);
            }
            for (i = 0; i &lt; keeled.length; i++) {
                keel = keeled[i];
                enKeel = keel.selectSingleNode(&quot;name[lang(&#x27;en&#x27;)]&quot;).text;
                nativeKeel = keel.selectSingleNode(&quot;native&quot;).text;
                if (nativeKeel == null)
                    nativeKeel = enKeel;
                appLangKeel = keel.selectSingleNode(&quot;name[lang(&#x27;&quot; + sAppLang + &quot;&#x27;)]&quot;);
                if (appLangKeel != null)
                    appLangKeel = &#x27; = &#x27; + appLangKeel.text;
                else
                    appLangKeel = &#x27;&#x27;;

                keelteValik.push(keel.getAttribute(&quot;code&quot;) + JR + nativeKeel + &#x27; (&#x27; + enKeel + appLangKeel + &#x27;)&#x27;);
            }
        }
    }
}


&#x2F;**
* 
*
* @method getKeeledOptString
* @param {String} kVal
* @returns {String}
*&#x2F;
function getKeeledOptString(kVal) {
    var opts = &#x27;&#x27;;
    for (var i = 0; i &lt; keelteValik.length; i++) {
        var keel = keelteValik[i].split(JR);
        opts += &quot;&lt;option id=&#x27;&quot; + keel[0] + &quot;&#x27;&quot;;
        if (keel[0] == kVal) {
            opts += &quot; selected&quot;;
        }
        opts += &quot;&gt;&quot; + keel[0] + &quot; - &quot; + keel[1] + &quot;&lt;&#x2F;option&gt;&quot;;
    }
    return opts;
}


&#x2F;**
* 
*
* @method getEnumRows
* @returns {String} 
*&#x2F;
function getEnumRows() {
    var trRows = &#x27;&#x27;;
    for (var i = 0; i &lt; keelteValik.length; i++) {
        var keel = keelteValik[i].split(JR);
        trRows += &quot;&lt;tr class=&#x27;mi&#x27; &quot; +
			&quot;id=&#x27;&quot; + keel[0] + &quot;&#x27; &quot; +
			&quot;value=&#x27;&quot; + keel[0] + &quot;&#x27;&quot; +
			&quot;title=&#x27;&#x27;&gt;&quot; +
				&quot;&lt;td&gt;&quot; + keel[0] + &quot;&lt;&#x2F;td&gt;&quot; +
				&quot;&lt;td&gt;&quot; + keel[1] + &quot;&lt;&#x2F;td&gt;&quot; +
			&quot;&lt;&#x2F;tr&gt;&quot;;
    }
    return trRows;
}

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
